{"file_contents":{"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","path":null,"size_bytes":4050,"size_tokens":null},"client/src/hooks/use-auth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport type { User } from \"@shared/models/auth\";\n\nasync function fetchUser(): Promise<User | null> {\n  const response = await fetch(\"/api/auth/user\", {\n    credentials: \"include\",\n  });\n\n  if (response.status === 401) {\n    return null;\n  }\n\n  if (!response.ok) {\n    throw new Error(`${response.status}: ${response.statusText}`);\n  }\n\n  return response.json();\n}\n\nexport function useAuth() {\n  const { data: user, isLoading } = useQuery<User | null>({\n    queryKey: [\"/api/auth/user\"],\n    queryFn: fetchUser,\n    retry: false,\n    staleTime: 1000 * 60 * 5, // 5 minutes\n  });\n\n  return {\n    user,\n    isLoading,\n    isAuthenticated: !!user,\n  };\n}\n","path":null,"size_bytes":701,"size_tokens":null},"client/src/pages/scanner.tsx":{"content":"import { useState, useEffect, useCallback } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  QrCode,\n  Camera,\n  Check,\n  X,\n  User,\n  Clock,\n  CreditCard,\n  Star,\n  AlertTriangle,\n  Droplets,\n  AlertCircle,\n  Smartphone,\n} from \"lucide-react\";\nimport type { Booking, Customer, Court } from \"@shared/schema\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { getPaymentStatusColor } from \"@/lib/constants\";\nimport { Html5Qrcode } from \"html5-qrcode\";\n\ntype ScanResult = {\n  bookingId: string;\n  booking: Booking | null;\n  customer: Customer | null;\n  court: Court | null;\n  status: \"valid\" | \"invalid\" | \"not_found\";\n};\n\nfunction ScannerView({ onScan }: { onScan: (data: string) => void }) {\n  const [scanning, setScanning] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    let html5QrCode: Html5Qrcode | null = null;\n\n    const startScanner = async () => {\n      try {\n        html5QrCode = new Html5Qrcode(\"qr-reader\");\n        await html5QrCode.start(\n          { facingMode: \"environment\" },\n          {\n            fps: 10,\n            qrbox: { width: 250, height: 250 },\n          },\n          (decodedText) => {\n            onScan(decodedText);\n            html5QrCode?.stop();\n            setScanning(false);\n          },\n          () => {}\n        );\n        setScanning(true);\n        setError(null);\n      } catch (err) {\n        setError(\"Unable to access camera. Please ensure camera permissions are granted.\");\n        console.error(\"Scanner error:\", err);\n      }\n    };\n\n    startScanner();\n\n    return () => {\n      if (html5QrCode && scanning) {\n        html5QrCode.stop().catch(console.error);\n      }\n    };\n  }, [onScan, scanning]);\n\n  return (\n    <div className=\"relative w-full max-w-md mx-auto\">\n      <div\n        id=\"qr-reader\"\n        className=\"w-full aspect-square bg-black rounded-lg overflow-hidden\"\n      />\n      {error && (\n        <div className=\"absolute inset-0 flex items-center justify-center bg-black/80 rounded-lg p-6\">\n          <div className=\"text-center text-white\">\n            <Camera className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n            <p className=\"text-sm\">{error}</p>\n          </div>\n        </div>\n      )}\n      <div className=\"absolute inset-0 pointer-events-none\">\n        <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 border-2 border-white/50 rounded-lg\">\n          <div className=\"absolute -top-1 -left-1 w-8 h-8 border-t-4 border-l-4 border-primary rounded-tl-lg\" />\n          <div className=\"absolute -top-1 -right-1 w-8 h-8 border-t-4 border-r-4 border-primary rounded-tr-lg\" />\n          <div className=\"absolute -bottom-1 -left-1 w-8 h-8 border-b-4 border-l-4 border-primary rounded-bl-lg\" />\n          <div className=\"absolute -bottom-1 -right-1 w-8 h-8 border-b-4 border-r-4 border-primary rounded-br-lg\" />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction ScanResultCard({\n  result,\n  onCheckIn,\n  onCollectPayment,\n  onAddUpsell,\n  onReportIssue,\n  onClose,\n  isLoading,\n}: {\n  result: ScanResult;\n  onCheckIn: () => void;\n  onCollectPayment: () => void;\n  onAddUpsell: () => void;\n  onReportIssue: () => void;\n  onClose: () => void;\n  isLoading: boolean;\n}) {\n  const { booking, customer, court, status } = result;\n\n  if (status === \"not_found\") {\n    return (\n      <Card className=\"border-red-500\">\n        <CardContent className=\"p-6 text-center\">\n          <X className=\"h-16 w-16 mx-auto text-red-500 mb-4\" />\n          <h3 className=\"text-lg font-semibold mb-2\">Booking Not Found</h3>\n          <p className=\"text-muted-foreground text-sm mb-4\">\n            The scanned QR code doesn't match any booking\n          </p>\n          <Button onClick={onClose} data-testid=\"button-scan-again\">\n            Scan Again\n          </Button>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (!booking || !customer || !court) {\n    return null;\n  }\n\n  const isPaid = booking.paymentStatus === \"paid\";\n  const isCheckedIn = booking.status === \"checked_in\";\n\n  return (\n    <Card className={isPaid ? \"border-green-500\" : \"border-orange-500\"}>\n      <CardContent className=\"p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className=\"flex items-center gap-2\">\n            {isPaid ? (\n              <Check className=\"h-6 w-6 text-green-500\" />\n            ) : (\n              <AlertCircle className=\"h-6 w-6 text-orange-500\" />\n            )}\n            <span\n              className={`font-semibold ${\n                isPaid ? \"text-green-500\" : \"text-orange-500\"\n              }`}\n            >\n              {isPaid ? \"Booking Valid\" : \"Payment Pending\"}\n            </span>\n          </div>\n          <Badge variant=\"outline\">{court.name}</Badge>\n        </div>\n\n        <div className=\"flex items-center gap-4 mb-6\">\n          <div className=\"w-14 h-14 rounded-full bg-primary/20 flex items-center justify-center text-xl\">\n            {customer.name.charAt(0)}\n          </div>\n          <div>\n            <h3 className=\"font-semibold text-lg\">{customer.name}</h3>\n            <p className=\"text-sm text-muted-foreground\">{customer.phone}</p>\n            <div className=\"flex gap-1 mt-1\">\n              {customer.tags.includes(\"VIP\") && (\n                <Badge className=\"bg-amber-500 text-white text-xs\">\n                  <Star className=\"h-3 w-3 mr-1\" />\n                  VIP\n                </Badge>\n              )}\n              {customer.tags.includes(\"HIGH_RISK\") && (\n                <Badge className=\"bg-red-500 text-white text-xs\">\n                  <AlertTriangle className=\"h-3 w-3 mr-1\" />\n                  High Risk\n                </Badge>\n              )}\n            </div>\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-2 gap-3 mb-6\">\n          <div className=\"p-3 bg-muted rounded-md\">\n            <div className=\"flex items-center gap-2 text-muted-foreground text-xs mb-1\">\n              <Clock className=\"h-3 w-3\" />\n              Time Slot\n            </div>\n            <p className=\"font-medium\">\n              {booking.startTime} - {booking.endTime}\n            </p>\n          </div>\n          <div className=\"p-3 bg-muted rounded-md\">\n            <div className=\"flex items-center gap-2 text-muted-foreground text-xs mb-1\">\n              <CreditCard className=\"h-3 w-3\" />\n              Payment\n            </div>\n            <p className=\"font-medium\">\n              ₹{booking.paidAmount} / ₹{booking.totalAmount}\n            </p>\n            <Badge\n              variant=\"outline\"\n              className={`mt-1 text-xs ${getPaymentStatusColor(\n                booking.paymentStatus\n              )}`}\n            >\n              {booking.paymentStatus}\n            </Badge>\n          </div>\n        </div>\n\n        {!isPaid && (\n          <div className=\"p-3 bg-red-50 dark:bg-red-900/20 rounded-md mb-4\">\n            <p className=\"text-sm font-medium text-red-600 dark:text-red-400\">\n              Collect ₹{Number(booking.totalAmount) - Number(booking.paidAmount)} Balance\n            </p>\n          </div>\n        )}\n\n        <div className=\"space-y-2\">\n          {!isCheckedIn && (\n            <Button\n              className=\"w-full\"\n              size=\"lg\"\n              onClick={onCheckIn}\n              disabled={isLoading}\n              data-testid=\"button-check-in\"\n            >\n              <Check className=\"h-5 w-5 mr-2\" />\n              {isLoading ? \"Processing...\" : \"Check In\"}\n            </Button>\n          )}\n\n          {!isPaid && (\n            <Button\n              variant=\"outline\"\n              className=\"w-full\"\n              size=\"lg\"\n              onClick={onCollectPayment}\n              data-testid=\"button-collect-payment\"\n            >\n              <CreditCard className=\"h-5 w-5 mr-2\" />\n              Collect UPI Payment\n            </Button>\n          )}\n\n          <div className=\"grid grid-cols-2 gap-2\">\n            <Button variant=\"outline\" onClick={onAddUpsell} data-testid=\"button-add-upsell\">\n              <Droplets className=\"h-4 w-4 mr-2\" />\n              Add Water\n            </Button>\n            <Button variant=\"outline\" onClick={onReportIssue} data-testid=\"button-report-issue\">\n              <AlertCircle className=\"h-4 w-4 mr-2\" />\n              Report Issue\n            </Button>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nexport default function Scanner() {\n  const { toast } = useToast();\n  const [scanResult, setScanResult] = useState<ScanResult | null>(null);\n  const [showScanner, setShowScanner] = useState(true);\n\n  const { data: bookings } = useQuery<Booking[]>({\n    queryKey: [\"/api/bookings\"],\n  });\n\n  const { data: customers } = useQuery<Customer[]>({\n    queryKey: [\"/api/customers\"],\n  });\n\n  const { data: courts } = useQuery<Court[]>({\n    queryKey: [\"/api/courts\"],\n  });\n\n  const checkInMutation = useMutation({\n    mutationFn: async (bookingId: string) => {\n      return apiRequest(\"PATCH\", `/api/bookings/${bookingId}`, {\n        status: \"checked_in\",\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/bookings\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/stats/dashboard\"] });\n      toast({ title: \"Check-in successful!\" });\n      setScanResult(null);\n      setShowScanner(true);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Check-in failed\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleScan = useCallback(\n    (data: string) => {\n      const bookingIdMatch = data.match(/BOOKING:(.+)/);\n      if (!bookingIdMatch) {\n        setScanResult({\n          bookingId: \"\",\n          booking: null,\n          customer: null,\n          court: null,\n          status: \"not_found\",\n        });\n        setShowScanner(false);\n        return;\n      }\n\n      const bookingId = bookingIdMatch[1];\n      const booking = bookings?.find((b) => b.id === bookingId || b.qrCode === data);\n\n      if (!booking) {\n        setScanResult({\n          bookingId,\n          booking: null,\n          customer: null,\n          court: null,\n          status: \"not_found\",\n        });\n      } else {\n        const customer = customers?.find((c) => c.id === booking.customerId);\n        const court = courts?.find((c) => c.id === booking.courtId);\n\n        setScanResult({\n          bookingId: booking.id,\n          booking,\n          customer: customer || null,\n          court: court || null,\n          status: \"valid\",\n        });\n      }\n      setShowScanner(false);\n    },\n    [bookings, customers, courts]\n  );\n\n  const handleCheckIn = () => {\n    if (scanResult?.booking) {\n      checkInMutation.mutate(scanResult.booking.id);\n    }\n  };\n\n  const handleCollectPayment = () => {\n    toast({ title: \"Opening UPI payment...\" });\n  };\n\n  const handleAddUpsell = () => {\n    toast({ title: \"Water bottle added to bill\" });\n  };\n\n  const handleReportIssue = () => {\n    toast({ title: \"Opening issue reporter...\" });\n  };\n\n  const handleScanAgain = () => {\n    setScanResult(null);\n    setShowScanner(true);\n  };\n\n  return (\n    <div className=\"min-h-screen p-4 md:p-6\">\n      <div className=\"max-w-lg mx-auto space-y-6\">\n        <div className=\"text-center\">\n          <div className=\"inline-flex items-center gap-2 px-3 py-1 bg-primary/10 rounded-full mb-4\">\n            <Smartphone className=\"h-4 w-4 text-primary\" />\n            <span className=\"text-sm font-medium text-primary\">Mobile Mode</span>\n          </div>\n          <h1 className=\"text-2xl font-semibold\">QR Scanner</h1>\n          <p className=\"text-muted-foreground text-sm mt-1\">\n            Scan customer tickets for quick check-in\n          </p>\n        </div>\n\n        {showScanner ? (\n          <Card>\n            <CardContent className=\"p-4\">\n              <ScannerView onScan={handleScan} />\n              <p className=\"text-center text-sm text-muted-foreground mt-4\">\n                Point camera at the booking QR code\n              </p>\n            </CardContent>\n          </Card>\n        ) : scanResult ? (\n          <ScanResultCard\n            result={scanResult}\n            onCheckIn={handleCheckIn}\n            onCollectPayment={handleCollectPayment}\n            onAddUpsell={handleAddUpsell}\n            onReportIssue={handleReportIssue}\n            onClose={handleScanAgain}\n            isLoading={checkInMutation.isPending}\n          />\n        ) : null}\n\n        {!showScanner && (\n          <Button\n            variant=\"outline\"\n            className=\"w-full\"\n            onClick={handleScanAgain}\n            data-testid=\"button-new-scan\"\n          >\n            <QrCode className=\"h-4 w-4 mr-2\" />\n            New Scan\n          </Button>\n        )}\n\n        <div className=\"fixed bottom-0 left-0 right-0 p-4 bg-background border-t md:hidden\">\n          <Button\n            size=\"lg\"\n            className=\"w-full\"\n            onClick={() => {\n              setScanResult(null);\n              setShowScanner(true);\n            }}\n            data-testid=\"button-floating-scan\"\n          >\n            <QrCode className=\"h-5 w-5 mr-2\" />\n            Scan QR Code\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":13602,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1202,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1883,"size_tokens":null},"script/build.ts":{"content":"import { build as esbuild } from \"esbuild\";\nimport { build as viteBuild } from \"vite\";\nimport { rm, readFile } from \"fs/promises\";\n\n// server deps to bundle to reduce openat(2) syscalls\n// which helps cold start times\nconst allowlist = [\n  \"@google/generative-ai\",\n  \"axios\",\n  \"connect-pg-simple\",\n  \"cors\",\n  \"date-fns\",\n  \"drizzle-orm\",\n  \"drizzle-zod\",\n  \"express\",\n  \"express-rate-limit\",\n  \"express-session\",\n  \"jsonwebtoken\",\n  \"memorystore\",\n  \"multer\",\n  \"nanoid\",\n  \"nodemailer\",\n  \"openai\",\n  \"passport\",\n  \"passport-local\",\n  \"pg\",\n  \"stripe\",\n  \"uuid\",\n  \"ws\",\n  \"xlsx\",\n  \"zod\",\n  \"zod-validation-error\",\n];\n\nasync function buildAll() {\n  await rm(\"dist\", { recursive: true, force: true });\n\n  console.log(\"building client...\");\n  await viteBuild();\n\n  console.log(\"building server...\");\n  const pkg = JSON.parse(await readFile(\"package.json\", \"utf-8\"));\n  const allDeps = [\n    ...Object.keys(pkg.dependencies || {}),\n    ...Object.keys(pkg.devDependencies || {}),\n  ];\n  const externals = allDeps.filter((dep) => !allowlist.includes(dep));\n\n  await esbuild({\n    entryPoints: [\"server/index.ts\"],\n    platform: \"node\",\n    bundle: true,\n    format: \"cjs\",\n    outfile: \"dist/index.cjs\",\n    define: {\n      \"process.env.NODE_ENV\": '\"production\"',\n    },\n    minify: true,\n    external: externals,\n    logLevel: \"info\",\n  });\n}\n\nbuildAll().catch((err) => {\n  console.error(err);\n  process.exit(1);\n});\n","path":null,"size_bytes":1417,"size_tokens":null},"client/src/components/app-sidebar.tsx":{"content":"import { Link, useLocation } from \"wouter\";\nimport {\n  LayoutDashboard,\n  Calendar,\n  Users,\n  Wallet,\n  Trophy,\n  Settings,\n  QrCode,\n  Clock,\n  AlertCircle,\n  BarChart3,\n  UserCog,\n  LogOut,\n  Crown,\n} from \"lucide-react\";\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarFooter,\n  SidebarSeparator,\n} from \"@/components/ui/sidebar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport type { DashboardStats, User } from \"@shared/schema\";\n\nconst mainNavItems = [\n  {\n    title: \"Dashboard\",\n    url: \"/\",\n    icon: LayoutDashboard,\n  },\n  {\n    title: \"Bookings\",\n    url: \"/bookings\",\n    icon: Calendar,\n  },\n  {\n    title: \"Customers\",\n    url: \"/customers\",\n    icon: Users,\n  },\n  {\n    title: \"Financials\",\n    url: \"/financials\",\n    icon: Wallet,\n  },\n  {\n    title: \"Tournaments\",\n    url: \"/tournaments\",\n    icon: Trophy,\n  },\n  {\n    title: \"Memberships\",\n    url: \"/memberships\",\n    icon: Crown,\n  },\n];\n\nconst quickActions = [\n  {\n    title: \"Walk-in Booking\",\n    url: \"/walkin\",\n    icon: Clock,\n  },\n  {\n    title: \"Scanner Mode\",\n    url: \"/scanner\",\n    icon: QrCode,\n  },\n  {\n    title: \"Waitlist\",\n    url: \"/waitlist\",\n    icon: AlertCircle,\n  },\n];\n\nconst settingsItems = [\n  {\n    title: \"Analytics\",\n    url: \"/analytics\",\n    icon: BarChart3,\n  },\n  {\n    title: \"Staff\",\n    url: \"/staff\",\n    icon: UserCog,\n    ownerOnly: true,\n  },\n  {\n    title: \"Settings\",\n    url: \"/settings\",\n    icon: Settings,\n  },\n];\n\ninterface AppSidebarProps {\n  user?: User | null;\n}\n\nexport function AppSidebar({ user }: AppSidebarProps) {\n  const [location] = useLocation();\n\n  const { data: stats } = useQuery<DashboardStats>({\n    queryKey: [\"/api/stats/dashboard\"],\n    refetchInterval: 30000,\n  });\n\n  const userRole = user?.role || \"receptionist\";\n  const isOwner = userRole === \"owner\";\n  const isManager = userRole === \"manager\" || isOwner;\n\n  const getInitials = () => {\n    const first = user?.firstName?.[0] || \"\";\n    const last = user?.lastName?.[0] || \"\";\n    return (first + last).toUpperCase() || \"U\";\n  };\n\n  return (\n    <Sidebar>\n      <SidebarHeader className=\"p-4\">\n        <Link href=\"/\">\n          <div className=\"flex items-center gap-2 cursor-pointer\" data-testid=\"link-logo\">\n            <div className=\"w-8 h-8 rounded-md bg-primary flex items-center justify-center\">\n              <span className=\"text-primary-foreground font-bold text-lg\">V</span>\n            </div>\n            <div className=\"flex flex-col\">\n              <span className=\"font-semibold text-sm\">VenueHub</span>\n              <span className=\"text-xs text-muted-foreground\">Venue Management</span>\n            </div>\n          </div>\n        </Link>\n      </SidebarHeader>\n\n      <SidebarSeparator />\n\n      <SidebarContent>\n        <SidebarGroup>\n          <SidebarGroupLabel>Navigation</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {mainNavItems.map((item) => (\n                <SidebarMenuItem key={item.title}>\n                  <SidebarMenuButton\n                    asChild\n                    isActive={location === item.url}\n                    tooltip={item.title}\n                  >\n                    <Link href={item.url} data-testid={`nav-${item.title.toLowerCase()}`}>\n                      <item.icon className=\"h-4 w-4\" />\n                      <span>{item.title}</span>\n                      {item.title === \"Bookings\" && stats?.pendingCheckIns ? (\n                        <Badge variant=\"secondary\" className=\"ml-auto text-xs\">\n                          {stats.pendingCheckIns}\n                        </Badge>\n                      ) : null}\n                    </Link>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n\n        <SidebarSeparator />\n\n        <SidebarGroup>\n          <SidebarGroupLabel>Quick Actions</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {quickActions.map((item) => (\n                <SidebarMenuItem key={item.title}>\n                  <SidebarMenuButton\n                    asChild\n                    isActive={location === item.url}\n                    tooltip={item.title}\n                  >\n                    <Link href={item.url} data-testid={`nav-${item.title.toLowerCase().replace(/\\s/g, '-')}`}>\n                      <item.icon className=\"h-4 w-4\" />\n                      <span>{item.title}</span>\n                    </Link>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n\n        <SidebarSeparator />\n\n        <SidebarGroup>\n          <SidebarGroupLabel>System</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {settingsItems\n                .filter((item) => !item.ownerOnly || isOwner)\n                .map((item) => (\n                  <SidebarMenuItem key={item.title}>\n                    <SidebarMenuButton\n                      asChild\n                      isActive={location === item.url}\n                      tooltip={item.title}\n                    >\n                      <Link href={item.url} data-testid={`nav-${item.title.toLowerCase()}`}>\n                        <item.icon className=\"h-4 w-4\" />\n                        <span>{item.title}</span>\n                      </Link>\n                    </SidebarMenuButton>\n                  </SidebarMenuItem>\n                ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n      </SidebarContent>\n\n      <SidebarFooter className=\"p-4\">\n        <div className=\"flex items-center gap-3 p-2 rounded-md bg-sidebar-accent\">\n          <Avatar className=\"w-8 h-8\">\n            <AvatarImage src={user?.profileImageUrl || undefined} />\n            <AvatarFallback>{getInitials()}</AvatarFallback>\n          </Avatar>\n          <div className=\"flex flex-col flex-1 min-w-0\">\n            <span className=\"text-sm font-medium truncate\">\n              {user?.firstName || \"User\"} {user?.lastName || \"\"}\n            </span>\n            <span className=\"text-xs text-muted-foreground capitalize\">{userRole}</span>\n          </div>\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={() => window.location.href = \"/api/logout\"}\n            data-testid=\"button-logout\"\n          >\n            <LogOut className=\"w-4 h-4\" />\n          </Button>\n        </div>\n      </SidebarFooter>\n    </Sidebar>\n  );\n}\n","path":null,"size_bytes":6901,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7428,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4885,"size_tokens":null},"server/replit_integrations/auth/replitAuth.ts":{"content":"import * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\n\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\nimport { authStorage } from \"./storage\";\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!\n    );\n  },\n  { maxAge: 3600 * 1000 }\n);\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: true,\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nasync function upsertUser(claims: any) {\n  await authStorage.upsertUser({\n    id: claims[\"sub\"],\n    email: claims[\"email\"],\n    firstName: claims[\"first_name\"],\n    lastName: claims[\"last_name\"],\n    profileImageUrl: claims[\"profile_image_url\"],\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified: passport.AuthenticateCallback\n  ) => {\n    const user = {};\n    updateUserSession(user, tokens);\n    await upsertUser(tokens.claims());\n    verified(null, user);\n  };\n\n  // Keep track of registered strategies\n  const registeredStrategies = new Set<string>();\n\n  // Helper function to ensure strategy exists for a domain\n  const ensureStrategy = (domain: string) => {\n    const strategyName = `replitauth:${domain}`;\n    if (!registeredStrategies.has(strategyName)) {\n      const strategy = new Strategy(\n        {\n          name: strategyName,\n          config,\n          scope: \"openid email profile offline_access\",\n          callbackURL: `https://${domain}/api/callback`,\n        },\n        verify\n      );\n      passport.use(strategy);\n      registeredStrategies.add(strategyName);\n    }\n  };\n\n  passport.serializeUser((user: Express.User, cb) => cb(null, user));\n  passport.deserializeUser((user: Express.User, cb) => cb(null, user));\n\n  app.get(\"/api/login\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      successReturnToOrRedirect: \"/\",\n      failureRedirect: \"/api/login\",\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(config, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}`,\n        }).href\n      );\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n};\n","path":null,"size_bytes":4474,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","path":null,"size_bytes":2695,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3021,"size_tokens":null},"client/src/pages/bookings.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\nimport {\n  Calendar,\n  ChevronLeft,\n  ChevronRight,\n  Plus,\n  Ban,\n  Clock,\n  User,\n  CreditCard,\n  AlertTriangle,\n  UserX,\n} from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { format, addDays, subDays, startOfWeek, addWeeks, subWeeks } from \"date-fns\";\nimport type { Court, Booking, Customer, BlockedSlot } from \"@shared/schema\";\nimport { getCalendarSlotColor, getPaymentStatusColor, TIME_SLOTS, BOOKING_COLOR_LEGEND } from \"@/lib/constants\";\nimport { QRCodeSVG } from \"qrcode.react\";\nimport { useRealtime } from \"@/hooks/use-realtime\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ntype CalendarView = \"day\" | \"week\" | \"month\";\n\nfunction TimeSlotBlock({\n  booking,\n  customer,\n  onClick,\n}: {\n  booking: Booking;\n  customer?: Customer;\n  onClick: () => void;\n}) {\n  const colorClass = getCalendarSlotColor(booking.paymentStatus, booking.status);\n  const isNoShow = booking.status === \"no_show\";\n\n  return (\n    <div\n      className={`p-2 rounded-md border cursor-pointer transition-all hover:scale-[1.02] ${colorClass} ${isNoShow ? 'opacity-60' : ''}`}\n      onClick={onClick}\n      data-testid={`booking-slot-${booking.id}`}\n    >\n      <div className=\"flex items-center gap-1 text-xs font-medium truncate\">\n        {isNoShow && <UserX className=\"w-3 h-3 text-orange-600\" />}\n        {customer?.name || \"Customer\"}\n      </div>\n      <div className=\"text-xs text-muted-foreground\">\n        {booking.startTime} - {booking.endTime}\n      </div>\n      <div className=\"flex items-center gap-1 mt-1 flex-wrap\">\n        {isNoShow ? (\n          <Badge variant=\"outline\" className=\"text-[10px] px-1 bg-orange-500/20 text-orange-700 dark:text-orange-400 border-orange-500/30\">\n            No-Show\n          </Badge>\n        ) : (\n          <Badge variant=\"outline\" className={`text-[10px] px-1 ${getPaymentStatusColor(booking.paymentStatus)}`}>\n            {booking.paymentStatus === \"paid\" ? \"Paid\" : booking.paymentStatus === \"partial\" ? \"Partial\" : \"Pending\"}\n          </Badge>\n        )}\n        {customer?.tags.includes(\"HIGH_RISK\") && (\n          <Badge variant=\"outline\" className=\"text-[10px] px-1 bg-red-500/20 text-red-700 dark:text-red-400 border-red-500/30\">\n            Risk\n          </Badge>\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction BlockedSlotBlock({\n  reason,\n  startTime,\n  endTime,\n}: {\n  reason: string;\n  startTime: string;\n  endTime: string;\n}) {\n  return (\n    <div className=\"p-2 rounded-md border bg-slate-200 dark:bg-slate-700 border-slate-400 dark:border-slate-500\">\n      <div className=\"text-xs font-medium text-slate-600 dark:text-slate-300\">Blocked</div>\n      <div className=\"text-xs text-slate-500 dark:text-slate-400\">\n        {startTime} - {endTime}\n      </div>\n      <div className=\"text-xs mt-1 truncate text-slate-600 dark:text-slate-300\">{reason}</div>\n    </div>\n  );\n}\n\nfunction BookingDetailDialog({\n  booking,\n  customer,\n  court,\n  open,\n  onClose,\n}: {\n  booking: Booking | null;\n  customer?: Customer;\n  court?: Court;\n  open: boolean;\n  onClose: () => void;\n}) {\n  const { toast } = useToast();\n  \n  const markNoShowMutation = useMutation({\n    mutationFn: async (bookingId: string) => {\n      const response = await apiRequest(\"POST\", `/api/bookings/${bookingId}/no-show`);\n      return response.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/bookings\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/customers\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/analytics/no-shows\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/stats/dashboard\"] });\n      \n      let message = \"Booking marked as no-show.\";\n      if (data?.isBlacklisted) {\n        message += \" Customer has been blacklisted due to repeated no-shows.\";\n      } else if (data?.isHighRisk) {\n        message += ` Customer flagged as high-risk (${data?.noShowCount} no-shows).`;\n      }\n      \n      toast({\n        title: \"No-Show Recorded\",\n        description: message,\n        variant: data?.isBlacklisted ? \"destructive\" : \"default\",\n      });\n      onClose();\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: error instanceof Error ? error.message : \"Failed to mark no-show\",\n        variant: \"destructive\",\n      });\n    },\n  });\n  \n  if (!booking) return null;\n\n  const isNoShow = booking.status === \"no_show\";\n  const canMarkNoShow = !isNoShow && booking.status !== \"completed\" && booking.status !== \"cancelled\";\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-md\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            Booking Details\n            {isNoShow && (\n              <Badge variant=\"destructive\" className=\"text-xs\">\n                <UserX className=\"w-3 h-3 mr-1\" />\n                No-Show\n              </Badge>\n            )}\n          </DialogTitle>\n          <DialogDescription>\n            {court?.name} - {booking.date}\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4\">\n          <div className=\"flex items-center gap-3 p-3 bg-muted rounded-md\">\n            <div className=\"w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center\">\n              <User className=\"h-5 w-5 text-primary\" />\n            </div>\n            <div>\n              <p className=\"font-medium\">{customer?.name || \"Walk-in Customer\"}</p>\n              <p className=\"text-sm text-muted-foreground\">{customer?.phone}</p>\n              <div className=\"flex flex-wrap gap-1 mt-1\">\n                {customer?.tags.includes(\"VIP\") && (\n                  <Badge className=\"bg-amber-500 text-white text-xs\">VIP</Badge>\n                )}\n                {customer?.tags.includes(\"HIGH_RISK\") && (\n                  <Badge className=\"bg-red-500 text-white text-xs\">High Risk</Badge>\n                )}\n                {customer && customer.noShowCount > 0 && (\n                  <Badge variant=\"outline\" className=\"text-xs text-orange-600 border-orange-300\">\n                    <AlertTriangle className=\"w-3 h-3 mr-1\" />\n                    {customer.noShowCount} no-show{customer.noShowCount > 1 ? \"s\" : \"\"}\n                  </Badge>\n                )}\n                {customer?.isBlacklisted && (\n                  <Badge variant=\"destructive\" className=\"text-xs\">Blacklisted</Badge>\n                )}\n              </div>\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-3\">\n            <div className=\"p-3 bg-muted rounded-md\">\n              <div className=\"flex items-center gap-2 text-muted-foreground text-xs mb-1\">\n                <Clock className=\"h-3 w-3\" />\n                Time\n              </div>\n              <p className=\"font-medium\">\n                {booking.startTime} - {booking.endTime}\n              </p>\n            </div>\n            <div className=\"p-3 bg-muted rounded-md\">\n              <div className=\"flex items-center gap-2 text-muted-foreground text-xs mb-1\">\n                <CreditCard className=\"h-3 w-3\" />\n                Payment\n              </div>\n              <p className=\"font-medium\">\n                ₹{booking.paidAmount} / ₹{booking.totalAmount}\n              </p>\n              <Badge\n                variant=\"outline\"\n                className={`mt-1 text-xs ${getPaymentStatusColor(booking.paymentStatus)}`}\n              >\n                {booking.paymentStatus}\n              </Badge>\n            </div>\n          </div>\n\n          {booking.qrCode && (\n            <div className=\"flex flex-col items-center p-4 bg-white dark:bg-slate-900 rounded-md\">\n              <QRCodeSVG value={booking.qrCode} size={120} />\n              <p className=\"text-xs text-muted-foreground mt-2\">Scan to verify</p>\n            </div>\n          )}\n\n          <div className=\"flex gap-2\">\n            <Button className=\"flex-1\" data-testid=\"button-check-in\" disabled={isNoShow}>\n              Check In\n            </Button>\n            <Button variant=\"outline\" className=\"flex-1\" data-testid=\"button-collect-payment\">\n              Collect Payment\n            </Button>\n          </div>\n\n          <div className=\"flex gap-2\">\n            <Button variant=\"ghost\" className=\"flex-1\" data-testid=\"button-reschedule\" disabled={isNoShow}>\n              Reschedule\n            </Button>\n            <Button variant=\"ghost\" className=\"flex-1 text-destructive\" data-testid=\"button-cancel\" disabled={isNoShow}>\n              Cancel\n            </Button>\n          </div>\n\n          {canMarkNoShow && (\n            <AlertDialog>\n              <AlertDialogTrigger asChild>\n                <Button \n                  variant=\"outline\" \n                  className=\"w-full border-orange-300 text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-950\"\n                  data-testid=\"button-mark-no-show\"\n                >\n                  <UserX className=\"w-4 h-4 mr-2\" />\n                  Mark as No-Show\n                </Button>\n              </AlertDialogTrigger>\n              <AlertDialogContent>\n                <AlertDialogHeader>\n                  <AlertDialogTitle className=\"flex items-center gap-2\">\n                    <AlertTriangle className=\"w-5 h-5 text-orange-500\" />\n                    Confirm No-Show\n                  </AlertDialogTitle>\n                  <AlertDialogDescription>\n                    This will record a no-show for {customer?.name || \"this customer\"}. \n                    {customer && customer.noShowCount >= 2 && (\n                      <span className=\"block mt-2 text-red-500 font-medium\">\n                        Warning: This customer already has {customer.noShowCount} no-show(s). \n                        {customer.noShowCount >= 4 \n                          ? \" They will be blacklisted after this.\" \n                          : customer.noShowCount >= 2 \n                          ? \" They will be marked as high-risk.\" \n                          : \"\"}\n                      </span>\n                    )}\n                  </AlertDialogDescription>\n                </AlertDialogHeader>\n                <AlertDialogFooter>\n                  <AlertDialogCancel data-testid=\"button-cancel-no-show\">Cancel</AlertDialogCancel>\n                  <AlertDialogAction\n                    onClick={() => markNoShowMutation.mutate(booking.id)}\n                    className=\"bg-orange-600 hover:bg-orange-700\"\n                    data-testid=\"button-confirm-no-show\"\n                  >\n                    {markNoShowMutation.isPending ? \"Marking...\" : \"Confirm No-Show\"}\n                  </AlertDialogAction>\n                </AlertDialogFooter>\n              </AlertDialogContent>\n            </AlertDialog>\n          )}\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nexport default function Bookings() {\n  // Real-time updates\n  useRealtime();\n  \n  const [currentDate, setCurrentDate] = useState(new Date());\n  const [view, setView] = useState<CalendarView>(\"day\");\n  const [selectedCourt, setSelectedCourt] = useState<string>(\"all\");\n  const [selectedBooking, setSelectedBooking] = useState<Booking | null>(null);\n\n  const { data: courts, isLoading: courtsLoading } = useQuery<Court[]>({\n    queryKey: [\"/api/courts\"],\n  });\n\n  const { data: bookings, isLoading: bookingsLoading } = useQuery<Booking[]>({\n    queryKey: [\"/api/bookings\"],\n  });\n\n  const { data: customers } = useQuery<Customer[]>({\n    queryKey: [\"/api/customers\"],\n  });\n\n  const { data: blockedSlots } = useQuery<BlockedSlot[]>({\n    queryKey: [\"/api/blocked-slots\"],\n  });\n\n  const filteredCourts =\n    selectedCourt === \"all\"\n      ? courts?.filter((c) => c.isActive)\n      : courts?.filter((c) => c.id === selectedCourt && c.isActive);\n\n  const dateStr = format(currentDate, \"yyyy-MM-dd\");\n  \n  const dateBlockedSlots = blockedSlots?.filter((bs) => bs.date === dateStr) || [];\n  \n  const isBookingBlockedBySlot = (booking: Booking) => {\n    return dateBlockedSlots.some(\n      (bs) =>\n        bs.courtId === booking.courtId &&\n        booking.startTime < bs.endTime &&\n        booking.endTime > bs.startTime\n    );\n  };\n  \n  const filteredBookings = bookings?.filter(\n    (b) => b.date === dateStr && !isBookingBlockedBySlot(b)\n  ) || [];\n\n  const getCustomer = (id: string) => customers?.find((c) => c.id === id);\n  const getCourt = (id: string) => courts?.find((c) => c.id === id);\n\n  const navigateDate = (direction: \"prev\" | \"next\") => {\n    if (view === \"day\") {\n      setCurrentDate(direction === \"prev\" ? subDays(currentDate, 1) : addDays(currentDate, 1));\n    } else if (view === \"week\") {\n      setCurrentDate(direction === \"prev\" ? subWeeks(currentDate, 1) : addWeeks(currentDate, 1));\n    }\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n        <div>\n          <h1 className=\"text-2xl font-semibold\">Booking Calendar</h1>\n          <p className=\"text-muted-foreground text-sm\">\n            Manage and view all court bookings\n          </p>\n        </div>\n        <div className=\"flex items-center gap-2 flex-wrap\">\n          <Link href=\"/walkin\">\n            <Button data-testid=\"button-new-booking\">\n              <Plus className=\"h-4 w-4 mr-2\" />\n              New Booking\n            </Button>\n          </Link>\n          <Button variant=\"outline\" data-testid=\"button-block-slot\">\n            <Ban className=\"h-4 w-4 mr-2\" />\n            Block Slot\n          </Button>\n        </div>\n      </div>\n\n      <Card>\n        <CardHeader className=\"flex flex-row items-center justify-between gap-4 flex-wrap\">\n          <div className=\"flex items-center gap-2\">\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={() => navigateDate(\"prev\")}\n              data-testid=\"button-prev-date\"\n            >\n              <ChevronLeft className=\"h-4 w-4\" />\n            </Button>\n            <div className=\"flex items-center gap-2\">\n              <Calendar className=\"h-4 w-4 text-muted-foreground\" />\n              <span className=\"font-medium\">\n                {view === \"day\"\n                  ? format(currentDate, \"EEEE, MMMM d, yyyy\")\n                  : `Week of ${format(startOfWeek(currentDate), \"MMM d\")}`}\n              </span>\n            </div>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={() => navigateDate(\"next\")}\n              data-testid=\"button-next-date\"\n            >\n              <ChevronRight className=\"h-4 w-4\" />\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setCurrentDate(new Date())}\n              data-testid=\"button-today\"\n            >\n              Today\n            </Button>\n          </div>\n\n          <div className=\"flex items-center gap-2\">\n            <Select value={selectedCourt} onValueChange={setSelectedCourt}>\n              <SelectTrigger className=\"w-40\" data-testid=\"select-court-filter\">\n                <SelectValue placeholder=\"All Courts\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Courts</SelectItem>\n                {courts?.map((court) => (\n                  <SelectItem key={court.id} value={court.id}>\n                    {court.name}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n\n            <Tabs value={view} onValueChange={(v) => setView(v as CalendarView)}>\n              <TabsList>\n                <TabsTrigger value=\"day\" data-testid=\"view-day\">Day</TabsTrigger>\n                <TabsTrigger value=\"week\" data-testid=\"view-week\">Week</TabsTrigger>\n              </TabsList>\n            </Tabs>\n          </div>\n        </CardHeader>\n\n        <div className=\"px-6 pb-4 flex items-center gap-4 flex-wrap\">\n          <span className=\"text-xs text-muted-foreground\">Payment Status:</span>\n          {BOOKING_COLOR_LEGEND.map((item) => (\n            <div key={item.label} className=\"flex items-center gap-1.5\">\n              <div className={`w-3 h-3 rounded ${item.color}`} />\n              <span className=\"text-xs\">{item.label}</span>\n            </div>\n          ))}\n        </div>\n\n        <CardContent>\n          {courtsLoading || bookingsLoading ? (\n            <div className=\"space-y-4\">\n              {[1, 2, 3].map((i) => (\n                <Skeleton key={i} className=\"h-32 w-full\" />\n              ))}\n            </div>\n          ) : (\n            <div className=\"overflow-x-auto\">\n              {view === \"day\" && (\n                <div className=\"min-w-[600px]\">\n                  <div className=\"grid gap-4\" style={{ gridTemplateColumns: `80px repeat(${filteredCourts?.length || 1}, 1fr)` }}>\n                    <div className=\"text-xs font-medium text-muted-foreground p-2\">Time</div>\n                    {filteredCourts?.map((court) => (\n                      <div key={court.id} className=\"text-sm font-medium p-2 text-center bg-muted rounded-t-md\">\n                        {court.name}\n                        <span className=\"block text-xs text-muted-foreground\">{court.sport}</span>\n                      </div>\n                    ))}\n                  </div>\n\n                  {TIME_SLOTS.slice(0, 28).map((slot) => (\n                    <div\n                      key={slot.value}\n                      className=\"grid gap-4 border-t border-border py-1\"\n                      style={{ gridTemplateColumns: `80px repeat(${filteredCourts?.length || 1}, 1fr)` }}\n                    >\n                      <div className=\"text-xs text-muted-foreground p-2\">{slot.label}</div>\n                      {filteredCourts?.map((court) => {\n                        const slotBlocked = dateBlockedSlots.filter(\n                          (bs) =>\n                            bs.courtId === court.id &&\n                            bs.startTime <= slot.value &&\n                            bs.endTime > slot.value\n                        );\n                        \n                        const slotBookings = filteredBookings.filter(\n                          (b) =>\n                            b.courtId === court.id &&\n                            b.startTime <= slot.value &&\n                            b.endTime > slot.value\n                        );\n\n                        return (\n                          <div key={court.id} className=\"min-h-[60px] p-1\">\n                            {slotBlocked.map((blocked) => (\n                              <BlockedSlotBlock\n                                key={blocked.id}\n                                reason={blocked.reason}\n                                startTime={blocked.startTime}\n                                endTime={blocked.endTime}\n                              />\n                            ))}\n                            {slotBookings.map((booking) => (\n                              <TimeSlotBlock\n                                key={booking.id}\n                                booking={booking}\n                                customer={getCustomer(booking.customerId)}\n                                onClick={() => setSelectedBooking(booking)}\n                              />\n                            ))}\n                          </div>\n                        );\n                      })}\n                    </div>\n                  ))}\n                </div>\n              )}\n\n              {view === \"week\" && (\n                <div className=\"text-center py-12 text-muted-foreground\">\n                  <Calendar className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                  <p>Week view coming soon</p>\n                  <p className=\"text-sm\">Use day view for now</p>\n                </div>\n              )}\n            </div>\n          )}\n\n          {(!filteredCourts || filteredCourts.length === 0) && !courtsLoading && (\n            <div className=\"text-center py-12 text-muted-foreground\">\n              <Calendar className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n              <p>No courts available</p>\n              <Link href=\"/settings\">\n                <Button variant=\"ghost\" className=\"mt-2\" data-testid=\"link-add-courts\">\n                  Add Courts in Settings\n                </Button>\n              </Link>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      <BookingDetailDialog\n        booking={selectedBooking}\n        customer={selectedBooking ? getCustomer(selectedBooking.customerId) : undefined}\n        court={selectedBooking ? getCourt(selectedBooking.courtId) : undefined}\n        open={!!selectedBooking}\n        onClose={() => setSelectedBooking(null)}\n      />\n    </div>\n  );\n}\n","path":null,"size_bytes":21636,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5128,"size_tokens":null},"client/src/pages/staff.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Plus, Shield, UserCog, Users, Loader2, ShieldAlert } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useLocation } from \"wouter\";\nimport type { User } from \"@shared/schema\";\nimport { rolePermissions } from \"@shared/models/auth\";\n\nexport default function StaffManagement() {\n  const { toast } = useToast();\n  const [isAddDialogOpen, setIsAddDialogOpen] = useState(false);\n  const { user: currentUser, isLoading: authLoading } = useAuth();\n  const [, setLocation] = useLocation();\n\n  // Redirect non-owners to dashboard\n  useEffect(() => {\n    if (!authLoading && currentUser && currentUser.role !== \"owner\") {\n      toast({\n        title: \"Access Denied\",\n        description: \"Only owners can access staff management.\",\n        variant: \"destructive\",\n      });\n      setLocation(\"/\");\n    }\n  }, [authLoading, currentUser, setLocation, toast]);\n\n  const { data: staffList, isLoading, error } = useQuery<User[]>({\n    queryKey: [\"/api/staff\"],\n    enabled: currentUser?.role === \"owner\",\n  });\n\n  // Show loading while checking auth\n  if (authLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  // Show access denied if not owner\n  if (currentUser?.role !== \"owner\") {\n    return (\n      <div className=\"flex flex-col items-center justify-center h-64 gap-4\">\n        <ShieldAlert className=\"w-12 h-12 text-destructive\" />\n        <h2 className=\"text-lg font-semibold\">Access Denied</h2>\n        <p className=\"text-muted-foreground\">Only owners can manage staff.</p>\n      </div>\n    );\n  }\n\n  const updateRoleMutation = useMutation({\n    mutationFn: async ({ userId, role }: { userId: string; role: string }) => {\n      return apiRequest(\"PATCH\", `/api/staff/${userId}/role`, { role });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/staff\"] });\n      toast({ title: \"Role updated\", description: \"Staff role has been updated.\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to update role.\", variant: \"destructive\" });\n    },\n  });\n\n  const getRoleBadgeVariant = (role: string) => {\n    switch (role) {\n      case \"owner\":\n        return \"default\";\n      case \"manager\":\n        return \"secondary\";\n      default:\n        return \"outline\";\n    }\n  };\n\n  const getRoleIcon = (role: string) => {\n    switch (role) {\n      case \"owner\":\n        return <Shield className=\"w-3 h-3\" />;\n      case \"manager\":\n        return <UserCog className=\"w-3 h-3\" />;\n      default:\n        return <Users className=\"w-3 h-3\" />;\n    }\n  };\n\n  const getInitials = (firstName?: string | null, lastName?: string | null) => {\n    const first = firstName?.[0] || \"\";\n    const last = lastName?.[0] || \"\";\n    return (first + last).toUpperCase() || \"?\";\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold\" data-testid=\"text-page-title\">\n            Staff Management\n          </h1>\n          <p className=\"text-muted-foreground\">\n            Manage staff accounts and permissions\n          </p>\n        </div>\n        <Dialog open={isAddDialogOpen} onOpenChange={setIsAddDialogOpen}>\n          <DialogTrigger asChild>\n            <Button data-testid=\"button-add-staff\">\n              <Plus className=\"w-4 h-4 mr-2\" />\n              Invite Staff\n            </Button>\n          </DialogTrigger>\n          <DialogContent>\n            <DialogHeader>\n              <DialogTitle>Invite Staff Member</DialogTitle>\n              <DialogDescription>\n                Staff members can sign up using their email. Once they log in, you can assign them a role.\n              </DialogDescription>\n            </DialogHeader>\n            <div className=\"space-y-4 py-4\">\n              <p className=\"text-sm text-muted-foreground\">\n                Share the venue login link with your staff. Once they sign in, their account will appear here and you can assign their role.\n              </p>\n              <div className=\"p-4 bg-muted rounded-md\">\n                <code className=\"text-sm break-all\">{window.location.origin}/api/login</code>\n              </div>\n            </div>\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Total Staff</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-total-staff\">\n              {staffList?.length || 0}\n            </div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Owners</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-owners-count\">\n              {staffList?.filter((s) => s.role === \"owner\").length || 0}\n            </div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Receptionists</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-receptionists-count\">\n              {staffList?.filter((s) => s.role === \"receptionist\").length || 0}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Staff Members</CardTitle>\n          <CardDescription>\n            View and manage staff accounts and their permissions\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          {isLoading ? (\n            <div className=\"flex items-center justify-center h-32\">\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\" />\n            </div>\n          ) : !staffList?.length ? (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              <Users className=\"w-12 h-12 mx-auto mb-4 opacity-50\" />\n              <p>No staff members yet</p>\n              <p className=\"text-sm\">Staff will appear here after they sign in</p>\n            </div>\n          ) : (\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Staff Member</TableHead>\n                  <TableHead>Email</TableHead>\n                  <TableHead>Role</TableHead>\n                  <TableHead>Joined</TableHead>\n                  <TableHead>Actions</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {staffList.map((staff) => (\n                  <TableRow key={staff.id} data-testid={`row-staff-${staff.id}`}>\n                    <TableCell>\n                      <div className=\"flex items-center gap-3\">\n                        <Avatar className=\"w-8 h-8\">\n                          <AvatarImage src={staff.profileImageUrl || undefined} />\n                          <AvatarFallback>\n                            {getInitials(staff.firstName, staff.lastName)}\n                          </AvatarFallback>\n                        </Avatar>\n                        <div>\n                          <div className=\"font-medium\">\n                            {staff.firstName} {staff.lastName}\n                          </div>\n                        </div>\n                      </div>\n                    </TableCell>\n                    <TableCell>{staff.email || \"-\"}</TableCell>\n                    <TableCell>\n                      <Badge variant={getRoleBadgeVariant(staff.role || \"receptionist\")}>\n                        <span className=\"flex items-center gap-1\">\n                          {getRoleIcon(staff.role || \"receptionist\")}\n                          {staff.role || \"receptionist\"}\n                        </span>\n                      </Badge>\n                    </TableCell>\n                    <TableCell>\n                      {staff.createdAt\n                        ? new Date(staff.createdAt).toLocaleDateString()\n                        : \"-\"}\n                    </TableCell>\n                    <TableCell>\n                      <Select\n                        defaultValue={staff.role || \"receptionist\"}\n                        onValueChange={(value) =>\n                          updateRoleMutation.mutate({ userId: staff.id, role: value })\n                        }\n                      >\n                        <SelectTrigger\n                          className=\"w-32\"\n                          data-testid={`select-role-${staff.id}`}\n                        >\n                          <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"owner\">Owner</SelectItem>\n                          <SelectItem value=\"manager\">Manager</SelectItem>\n                          <SelectItem value=\"receptionist\">Receptionist</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          )}\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Role Permissions</CardTitle>\n          <CardDescription>\n            Overview of what each role can do\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n            {Object.entries(rolePermissions).map(([role, permissions]) => (\n              <div key={role} className=\"space-y-2\">\n                <div className=\"flex items-center gap-2\">\n                  {getRoleIcon(role)}\n                  <h3 className=\"font-medium capitalize\">{role}</h3>\n                </div>\n                <ul className=\"space-y-1\">\n                  {permissions.map((permission) => (\n                    <li\n                      key={permission}\n                      className=\"text-sm text-muted-foreground flex items-center gap-2\"\n                    >\n                      <span className=\"w-1.5 h-1.5 rounded-full bg-primary\" />\n                      {permission.replace(/_/g, \" \")}\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":11452,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2765,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1584,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7609,"size_tokens":null},"client/src/lib/constants.ts":{"content":"export const SPORTS = [\n  { value: \"cricket\", label: \"Cricket\" },\n  { value: \"football\", label: \"Football\" },\n  { value: \"badminton\", label: \"Badminton\" },\n  { value: \"tennis\", label: \"Tennis\" },\n  { value: \"basketball\", label: \"Basketball\" },\n  { value: \"volleyball\", label: \"Volleyball\" },\n] as const;\n\nexport const PAYMENT_METHODS = [\n  { value: \"cash\", label: \"Cash\" },\n  { value: \"upi\", label: \"UPI\" },\n  { value: \"card\", label: \"Card\" },\n  { value: \"online\", label: \"Online\" },\n] as const;\n\nexport const BOOKING_STATUSES = [\n  { value: \"confirmed\", label: \"Confirmed\", color: \"bg-blue-500\" },\n  { value: \"checked_in\", label: \"Checked In\", color: \"bg-green-500\" },\n  { value: \"completed\", label: \"Completed\", color: \"bg-gray-500\" },\n  { value: \"cancelled\", label: \"Cancelled\", color: \"bg-red-500\" },\n  { value: \"no_show\", label: \"No Show\", color: \"bg-orange-500\" },\n] as const;\n\nexport const PAYMENT_STATUSES = [\n  { value: \"pending\", label: \"Pending\", color: \"text-red-500 dark:text-red-400\" },\n  { value: \"partial\", label: \"Partial\", color: \"text-orange-500 dark:text-orange-400\" },\n  { value: \"paid\", label: \"Paid\", color: \"text-green-500 dark:text-green-400\" },\n] as const;\n\nexport const CUSTOMER_TAGS = [\n  { value: \"VIP\", label: \"VIP\", color: \"bg-amber-500 text-white\" },\n  { value: \"HIGH_RISK\", label: \"High Risk\", color: \"bg-red-500 text-white\" },\n  { value: \"REGULAR\", label: \"Regular\", color: \"bg-blue-500 text-white\" },\n  { value: \"NEW\", label: \"New\", color: \"bg-green-500 text-white\" },\n] as const;\n\nexport const EXPENSE_CATEGORIES = [\n  { value: \"electricity\", label: \"Electricity\" },\n  { value: \"staff\", label: \"Staff Salaries\" },\n  { value: \"maintenance\", label: \"Maintenance\" },\n  { value: \"equipment\", label: \"Equipment\" },\n  { value: \"rent\", label: \"Rent\" },\n  { value: \"other\", label: \"Other\" },\n] as const;\n\nexport const TIME_SLOTS = Array.from({ length: 32 }, (_, i) => {\n  const hour = Math.floor(i / 2) + 6;\n  const minute = i % 2 === 0 ? \"00\" : \"30\";\n  const time = `${hour.toString().padStart(2, \"0\")}:${minute}`;\n  const label = `${hour > 12 ? hour - 12 : hour}:${minute} ${hour >= 12 ? \"PM\" : \"AM\"}`;\n  return { value: time, label };\n});\n\nexport const DURATIONS = [\n  { value: 30, label: \"30 minutes\" },\n  { value: 60, label: \"1 hour\" },\n  { value: 90, label: \"1.5 hours\" },\n  { value: 120, label: \"2 hours\" },\n] as const;\n\nexport const getPaymentStatusColor = (status: string) => {\n  switch (status) {\n    case \"paid\":\n      return \"bg-green-500/20 text-green-700 dark:text-green-400 border-green-500/30\";\n    case \"partial\":\n      return \"bg-orange-500/20 text-orange-700 dark:text-orange-400 border-orange-500/30\";\n    case \"pending\":\n      return \"bg-red-500/20 text-red-700 dark:text-red-400 border-red-500/30\";\n    default:\n      return \"bg-gray-500/20 text-gray-700 dark:text-gray-400 border-gray-500/30\";\n  }\n};\n\nexport const getBookingStatusColor = (status: string) => {\n  switch (status) {\n    case \"confirmed\":\n      return \"bg-blue-500/20 text-blue-700 dark:text-blue-400 border-blue-500/30\";\n    case \"checked_in\":\n      return \"bg-green-500/20 text-green-700 dark:text-green-400 border-green-500/30\";\n    case \"completed\":\n      return \"bg-gray-500/20 text-gray-700 dark:text-gray-400 border-gray-500/30\";\n    case \"cancelled\":\n      return \"bg-red-500/20 text-red-700 dark:text-red-400 border-red-500/30\";\n    case \"no_show\":\n      return \"bg-orange-500/20 text-orange-700 dark:text-orange-400 border-orange-500/30\";\n    default:\n      return \"bg-gray-500/20 text-gray-700 dark:text-gray-400 border-gray-500/30\";\n  }\n};\n\n// 4-state color system per design guidelines:\n// Green = Paid, Orange = Partial, Red = Pending, Grey = Blocked\nexport const getCalendarSlotColor = (paymentStatus: string, status: string, isBlocked?: boolean) => {\n  // Grey for blocked/maintenance slots\n  if (isBlocked || status === \"blocked\") {\n    return \"bg-slate-200 dark:bg-slate-700 border-slate-400 dark:border-slate-500\";\n  }\n  if (status === \"cancelled\" || status === \"no_show\") {\n    return \"bg-gray-200 dark:bg-gray-700 border-gray-300 dark:border-gray-600\";\n  }\n  switch (paymentStatus) {\n    case \"paid\":\n      return \"bg-green-100 dark:bg-green-900/40 border-green-400 dark:border-green-600\";\n    case \"partial\":\n      return \"bg-orange-100 dark:bg-orange-900/40 border-orange-400 dark:border-orange-600\";\n    case \"pending\":\n      return \"bg-red-100 dark:bg-red-900/40 border-red-400 dark:border-red-600\";\n    default:\n      return \"bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-600\";\n  }\n};\n\n// Status legend for calendar\nexport const BOOKING_COLOR_LEGEND = [\n  { label: \"Paid\", color: \"bg-green-500\", bgClass: \"bg-green-100 dark:bg-green-900/40\" },\n  { label: \"Partial\", color: \"bg-orange-500\", bgClass: \"bg-orange-100 dark:bg-orange-900/40\" },\n  { label: \"Pending\", color: \"bg-red-500\", bgClass: \"bg-red-100 dark:bg-red-900/40\" },\n  { label: \"Blocked\", color: \"bg-slate-500\", bgClass: \"bg-slate-200 dark:bg-slate-700\" },\n] as const;\n\n// Returns sport abbreviation for display (no emojis per design guidelines)\nexport const getSportAbbrev = (sport: string) => {\n  switch (sport.toLowerCase()) {\n    case \"cricket\":\n      return \"CRI\";\n    case \"football\":\n      return \"FTB\";\n    case \"badminton\":\n      return \"BAD\";\n    case \"tennis\":\n      return \"TEN\";\n    case \"basketball\":\n      return \"BKB\";\n    case \"volleyball\":\n      return \"VLB\";\n    default:\n      return \"SPT\";\n  }\n};\n","path":null,"size_bytes":5435,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":689,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","path":null,"size_bytes":1280,"size_tokens":null},"server/static.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(__dirname, \"public\");\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":547,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3848,"size_tokens":null},"design_guidelines.md":{"content":"# Sports Venue Management System - Design Guidelines\n\n## Design Approach\n\n**Selected System**: Material Design with custom business application patterns  \n**Rationale**: Information-dense dashboard requiring robust data visualization, real-time updates, and dual-mode interface (desktop command center + mobile companion). Material Design excels in admin panels with clear hierarchy and functional components.\n\n## Core Design Principles\n\n1. **Efficiency Over Aesthetics**: Every pixel serves a business function\n2. **Instant Recognition**: Status-driven visual language (booking states, customer flags, payment status)\n3. **Desktop-First, Mobile-Companion**: Primary workspace on large screens, mobile as action controller\n4. **Real-Time Clarity**: WebSocket updates must be immediately obvious\n\n---\n\n## Typography System\n\n**Font Stack**: Inter (primary) via Google Fonts CDN, system fallback  \n\n**Hierarchy**:\n- Dashboard Headers: text-2xl font-semibold (Command Center, Analytics)\n- Section Titles: text-lg font-semibold (Today's Metrics, Booking Calendar)\n- Data Labels: text-sm font-medium (Court Names, Customer Names)\n- Metadata/Timestamps: text-xs font-normal (Last updated, Booking IDs)\n- Numbers/Metrics: text-3xl font-bold (Revenue figures, Court occupancy counts)\n- Button Text: text-sm font-medium\n\n---\n\n## Layout System\n\n**Spacing Units**: Tailwind units of **2, 4, 6, and 8** (e.g., p-4, gap-6, m-8, space-y-2)\n\n**Desktop Layout Structure**:\n- Fixed sidebar navigation: w-64, left-aligned\n- Main content area: flex-1 with max-w-screen-2xl, p-6\n- Dashboard grid: grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\n- Calendar view: Full-width with horizontal scroll for multi-court display\n\n**Mobile Layout (Companion Mode)**:\n- Bottom navigation: fixed bottom-0, h-16\n- Floating action button: fixed bottom-20 right-4 for \"Scan QR\"\n- Full-screen scanner: w-screen h-screen when camera active\n- Action cards: Single column, p-4 spacing\n\n**Container Constraints**:\n- Dashboard widgets: min-h-32\n- Data tables: Scrollable with fixed header\n- Forms: max-w-2xl for walk-in booking entry\n\n---\n\n## Component Library\n\n### Navigation\n- **Desktop Sidebar**: Persistent, icon + label navigation items, grouped by function (Dashboard, Bookings, Customers, Financials, Settings)\n- **Mobile Bottom Nav**: 4 primary tabs (Dashboard, Scan, Bookings, Quick Actions)\n\n### Dashboard Widgets\n- **Metric Cards**: Prominent number (text-3xl), label below, optional trend indicator (↑↓)\n- **Status Grid**: Courts displayed as cards with status badge, occupancy percentage\n- **Quick Actions**: Large touch targets (min-h-12), icon + text buttons\n\n### Booking Calendar\n- **Multi-Court View**: Horizontal lanes, time slots as columns, 30-min/60-min intervals\n- **Booking Blocks**: Draggable cards with customer name, sport type, payment status badge\n- **Critical Color System** (structural, not visual): 4-state system required:\n  - Fully Paid (primary state)\n  - Partial Payment (warning state)  \n  - Payment Pending (alert state)\n  - Blocked/Maintenance (neutral state)\n\n### Forms & Data Entry\n- **Walk-in Booking**: Vertical form with clear field labels, auto-suggest for customer search\n- **Customer Search**: Autocomplete dropdown with avatar + name + phone display\n- **Payment Input**: Segmented control (Cash/UPI/Card), amount input with ₹ prefix\n\n### Tables & Lists\n- **Customer Database**: Sortable columns, inline badges for tags (VIP, High Risk)\n- **Transaction Log**: Dense rows with alternating backgrounds, sticky header\n- **Row Actions**: Right-aligned icon buttons (View, Edit, Download)\n\n### CRM Features\n- **Customer Tags**: Pill-shaped badges, inline with customer name\n- **VIP Indicator**: Gold/premium badge visible in search results and booking forms\n- **High Risk Warning**: Modal dialog that appears on booking attempt, requires acknowledgment\n- **Customer Profile**: Split layout - left: stats & metrics, right: booking history timeline\n\n### Mobile Scanner Interface\n- **Camera View**: Full-screen with overlay guides for QR positioning\n- **Scan Result Card**: Slides up from bottom, shows booking details\n- **Action Buttons**: Large (min-h-14), full-width, stacked vertically (Check In, Collect Payment, Report Issue)\n- **Success/Error States**: Full-screen takeover with large icon and message\n\n### Modals & Overlays\n- **Confirmation Dialogs**: Centered, max-w-md, clear primary/secondary actions\n- **Reschedule Modal**: Shows old vs new slot, price difference if applicable\n- **Settlement Payment**: Multi-step form with summary review\n\n### Real-Time Updates\n- **WebSocket Indicators**: Subtle pulse animation on affected dashboard widgets\n- **Toast Notifications**: Top-right, auto-dismiss after 4s, stacked if multiple\n\n---\n\n## Responsive Behavior\n\n**Breakpoints**:\n- Mobile: < 768px (Companion mode optimized)\n- Tablet: 768px - 1024px (Simplified dashboard)\n- Desktop: > 1024px (Full command center)\n\n**Adaptive Patterns**:\n- Booking calendar: Horizontal scroll on mobile, full multi-lane on desktop\n- Dashboard metrics: Single column mobile → 2-col tablet → 4-col desktop\n- Customer profile: Stacked mobile → side-by-side desktop\n\n---\n\n## Progressive Web App (Mobile)\n\n**Install Prompt**: Banner at top on mobile browsers suggesting \"Add to Home Screen\"  \n**Camera Permissions**: Request only when \"Scan QR\" tapped, clear explanation modal  \n**Offline State**: Show \"Connection Lost\" banner, queue actions for sync when online  \n**App Icons**: 192x192 and 512x512 for home screen\n\n---\n\n## Images\n\n**Hero Image**: None - This is a business tool, not a marketing site  \n\n**Contextual Images**:\n- Empty state illustrations for \"No Bookings Today\", \"No Customers Found\"\n- Avatar placeholders for customers without profile photos\n- Sport icons for cricket, football, badminton, tennis (use Heroicons or Font Awesome sports icons)\n- QR code placeholder in mobile scanner overlay when inactive\n\n**Icon Library**: Font Awesome via CDN for comprehensive business/sports icons\n\n---\n\n## Animation & Interaction\n\n**Minimal Animations** (functional only):\n- Drag-and-drop calendar blocks: Smooth transform on drag\n- Real-time update: 300ms fade-in for new data\n- Modal entry/exit: 200ms slide-up from bottom\n- Mobile scanner: Camera shutter effect on successful scan\n- Loading states: Spinner for async operations\n\n**No Decorative Animations**: This is a working tool used hundreds of times per day\n\n---\n\n## Accessibility\n\n- WCAG AA compliant contrast ratios (especially critical for status indicators)\n- Keyboard navigation for all calendar and form interactions\n- Screen reader labels for icon-only buttons\n- Focus indicators visible at all times\n- Error messages associated with form fields","path":null,"size_bytes":6708,"size_tokens":null},"replit.md":{"content":"# VenueHub - Sports Venue Management System\n\n## Overview\n\nVenueHub is a complete sports venue booking and management system designed for sports facility owners and receptionists. It provides real-time court/turf booking management, customer relationship management, financial tracking, and a mobile companion mode for QR code scanning during check-ins.\n\nThe system is built as a full-stack TypeScript application with a React frontend and Express backend, using PostgreSQL for data persistence and WebSockets for real-time updates across devices.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n- **Framework**: React 18 with TypeScript\n- **Routing**: Wouter (lightweight React router)\n- **State Management**: TanStack React Query for server state, React hooks for local state\n- **UI Components**: shadcn/ui component library built on Radix UI primitives\n- **Styling**: Tailwind CSS with CSS variables for theming (light/dark mode support)\n- **Build Tool**: Vite with HMR support\n- **Progressive Web App**: Configured with manifest.json for mobile \"Companion Mode\" - allows installation on phone home screens for QR scanning\n\n### Backend Architecture\n- **Runtime**: Node.js with Express\n- **Language**: TypeScript (ESM modules)\n- **API Design**: RESTful JSON API endpoints under `/api/*`\n- **Real-time Communication**: WebSocket server (ws library) on `/ws` path for instant updates across devices\n- **Session Management**: Express sessions with PostgreSQL store (connect-pg-simple)\n\n### Data Layer\n- **Database**: PostgreSQL\n- **ORM**: Drizzle ORM with type-safe schema definitions\n- **Schema Location**: `shared/schema.ts` - shared between frontend and backend\n- **Migrations**: Drizzle Kit for schema migrations (`drizzle-kit push`)\n\n### Key Design Patterns\n1. **Desktop-First, Mobile-Companion**: Primary workspace on large screens with fixed sidebar navigation; mobile view optimized for QR scanning and quick actions\n2. **Real-Time Sync**: WebSocket broadcasts ensure laptop dashboard updates instantly when mobile device scans a QR code\n3. **Shared Types**: Schema defined once in `shared/` directory, used by both client and server\n4. **Storage Interface**: Abstract `IStorage` interface in `server/storage.ts` allows swapping storage implementations\n\n### Application Modules\n- **Dashboard**: Command center with live court status, metrics, and quick actions\n- **Bookings**: Interactive calendar with color-coded booking statuses, slot blocking\n- **Customers**: CRM with customer database, tags (VIP, HIGH_RISK), booking history\n- **Financials**: Transaction logs, expense tracking, settlement management\n- **Scanner**: QR code scanning for check-ins using device camera (html5-qrcode)\n- **Tournaments**: Tournament and team management\n- **Waitlist**: Customer waitlist for fully booked slots\n\n## External Dependencies\n\n### Database\n- **PostgreSQL**: Primary data store, connection via `DATABASE_URL` environment variable\n- **Drizzle ORM**: Type-safe database queries and schema management\n\n### UI Framework\n- **Radix UI**: Headless component primitives (dialogs, dropdowns, tabs, etc.)\n- **shadcn/ui**: Pre-styled components using Radix + Tailwind\n- **Recharts**: Data visualization for analytics dashboards\n- **Lucide React**: Icon library\n\n### File Upload\n- **Uppy**: File upload handling with AWS S3 integration capability\n\n### QR Code\n- **html5-qrcode**: Camera-based QR code scanning for mobile companion mode\n- **qrcode.react**: QR code generation for booking tickets\n\n### Form Handling\n- **React Hook Form**: Form state management\n- **Zod**: Schema validation (integrated with Drizzle via drizzle-zod)\n\n### Date/Time\n- **date-fns**: Date manipulation and formatting\n\n### Notifications (Stubbed)\n- **WhatsApp Business API**: Placeholder for booking confirmations and reminders (integration points defined but requires external API configuration)\n\n### Build & Development\n- **Vite**: Frontend build and dev server\n- **esbuild**: Server bundling for production\n- **tsx**: TypeScript execution for development","path":null,"size_bytes":4104,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4120,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":2359,"size_tokens":null},"client/src/pages/customers.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n  DropdownMenuSeparator,\n} from \"@/components/ui/dropdown-menu\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Search,\n  Plus,\n  MoreHorizontal,\n  Star,\n  AlertTriangle,\n  Phone,\n  Mail,\n  User,\n  History,\n  Ban,\n  Tag,\n  Wallet,\n} from \"lucide-react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport type { Customer, Booking } from \"@shared/schema\";\nimport { insertCustomerSchema } from \"@shared/schema\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { CUSTOMER_TAGS } from \"@/lib/constants\";\n\nconst customerFormSchema = insertCustomerSchema.extend({\n  name: z.string().min(2, \"Name must be at least 2 characters\"),\n  phone: z.string().min(10, \"Phone must be at least 10 digits\"),\n});\n\ntype CustomerFormValues = z.infer<typeof customerFormSchema>;\n\nfunction CustomerTagBadge({ tag }: { tag: string }) {\n  const tagConfig = CUSTOMER_TAGS.find((t) => t.value === tag);\n  if (!tagConfig) return null;\n\n  return (\n    <Badge className={`${tagConfig.color} text-xs`}>\n      {tag === \"VIP\" && <Star className=\"h-3 w-3 mr-1\" />}\n      {tag === \"HIGH_RISK\" && <AlertTriangle className=\"h-3 w-3 mr-1\" />}\n      {tagConfig.label}\n    </Badge>\n  );\n}\n\nfunction CustomerDetailDialog({\n  customer,\n  open,\n  onClose,\n}: {\n  customer: Customer | null;\n  open: boolean;\n  onClose: () => void;\n}) {\n  const { data: bookings } = useQuery<Booking[]>({\n    queryKey: [\"/api/bookings\"],\n    enabled: !!customer,\n  });\n\n  if (!customer) return null;\n\n  const customerBookings = bookings?.filter((b) => b.customerId === customer.id) || [];\n  const reliabilityScore = customer.totalBookings > 0\n    ? Math.round(((customer.totalBookings - customer.noShowCount) / customer.totalBookings) * 100)\n    : 100;\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-2xl\">\n        <DialogHeader>\n          <DialogTitle>Customer Profile</DialogTitle>\n          <DialogDescription>View customer details and booking history</DialogDescription>\n        </DialogHeader>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center gap-4\">\n              <Avatar className=\"h-16 w-16\">\n                <AvatarFallback className=\"text-lg\">\n                  {customer.name.charAt(0).toUpperCase()}\n                </AvatarFallback>\n              </Avatar>\n              <div>\n                <h3 className=\"font-semibold text-lg\">{customer.name}</h3>\n                <div className=\"flex flex-wrap gap-1 mt-1\">\n                  {customer.tags.map((tag) => (\n                    <CustomerTagBadge key={tag} tag={tag} />\n                  ))}\n                </div>\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center gap-2 text-sm\">\n                <Phone className=\"h-4 w-4 text-muted-foreground\" />\n                <span>{customer.phone}</span>\n              </div>\n              {customer.email && (\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <Mail className=\"h-4 w-4 text-muted-foreground\" />\n                  <span>{customer.email}</span>\n                </div>\n              )}\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-3\">\n              <Card className=\"p-3\">\n                <div className=\"text-xs text-muted-foreground mb-1\">Total Spend</div>\n                <div className=\"text-lg font-semibold\">\n                  ₹{Number(customer.totalSpend).toLocaleString()}\n                </div>\n              </Card>\n              <Card className=\"p-3\">\n                <div className=\"text-xs text-muted-foreground mb-1\">Total Bookings</div>\n                <div className=\"text-lg font-semibold\">{customer.totalBookings}</div>\n              </Card>\n              <Card className=\"p-3\">\n                <div className=\"text-xs text-muted-foreground mb-1\">No-Shows</div>\n                <div className=\"text-lg font-semibold text-orange-500\">\n                  {customer.noShowCount}\n                </div>\n              </Card>\n              <Card className=\"p-3\">\n                <div className=\"text-xs text-muted-foreground mb-1\">Reliability</div>\n                <div\n                  className={`text-lg font-semibold ${\n                    reliabilityScore >= 80\n                      ? \"text-green-500\"\n                      : reliabilityScore >= 60\n                      ? \"text-orange-500\"\n                      : \"text-red-500\"\n                  }`}\n                >\n                  {reliabilityScore}%\n                </div>\n              </Card>\n            </div>\n\n            {customer.notes && (\n              <div className=\"p-3 bg-muted rounded-md\">\n                <div className=\"text-xs text-muted-foreground mb-1\">Notes</div>\n                <p className=\"text-sm\">{customer.notes}</p>\n              </div>\n            )}\n          </div>\n\n          <div>\n            <h4 className=\"font-medium mb-3 flex items-center gap-2\">\n              <History className=\"h-4 w-4\" />\n              Recent Bookings\n            </h4>\n            <div className=\"space-y-2 max-h-64 overflow-auto\">\n              {customerBookings.length > 0 ? (\n                customerBookings.slice(0, 10).map((booking) => (\n                  <div\n                    key={booking.id}\n                    className=\"p-3 bg-muted rounded-md text-sm\"\n                  >\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"font-medium\">{booking.date}</span>\n                      <Badge variant=\"outline\" className=\"text-xs\">\n                        {booking.status}\n                      </Badge>\n                    </div>\n                    <div className=\"text-muted-foreground text-xs mt-1\">\n                      {booking.startTime} - {booking.endTime} | ₹{booking.totalAmount}\n                    </div>\n                  </div>\n                ))\n              ) : (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  <History className=\"h-8 w-8 mx-auto mb-2 opacity-50\" />\n                  <p className=\"text-sm\">No booking history</p>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nfunction AddCustomerDialog({\n  open,\n  onClose,\n}: {\n  open: boolean;\n  onClose: () => void;\n}) {\n  const { toast } = useToast();\n\n  const form = useForm<CustomerFormValues>({\n    resolver: zodResolver(customerFormSchema),\n    defaultValues: {\n      name: \"\",\n      phone: \"\",\n      email: \"\",\n      notes: \"\",\n      source: \"walkin\",\n      tags: [],\n      isBlacklisted: false,\n    },\n  });\n\n  const createCustomer = useMutation({\n    mutationFn: async (data: CustomerFormValues) => {\n      const response = await apiRequest(\"POST\", \"/api/customers\", data);\n      return response;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/customers\"] });\n      toast({ title: \"Customer added successfully\" });\n      form.reset();\n      onClose();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to add customer\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: CustomerFormValues) => {\n    createCustomer.mutate(data);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>Add New Customer</DialogTitle>\n          <DialogDescription>Register a new customer in the system</DialogDescription>\n        </DialogHeader>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"name\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Name</FormLabel>\n                  <FormControl>\n                    <Input placeholder=\"Customer name\" {...field} data-testid=\"input-customer-name\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"phone\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Phone</FormLabel>\n                  <FormControl>\n                    <Input placeholder=\"Phone number\" {...field} data-testid=\"input-customer-phone\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"email\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Email (Optional)</FormLabel>\n                  <FormControl>\n                    <Input\n                      type=\"email\"\n                      placeholder=\"Email address\"\n                      {...field}\n                      value={field.value || \"\"}\n                      data-testid=\"input-customer-email\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"notes\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Notes (Optional)</FormLabel>\n                  <FormControl>\n                    <Input\n                      placeholder=\"Any notes about this customer\"\n                      {...field}\n                      value={field.value || \"\"}\n                      data-testid=\"input-customer-notes\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"flex justify-end gap-2\">\n              <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={createCustomer.isPending} data-testid=\"button-save-customer\">\n                {createCustomer.isPending ? \"Saving...\" : \"Add Customer\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nexport default function Customers() {\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedCustomer, setSelectedCustomer] = useState<Customer | null>(null);\n  const [addDialogOpen, setAddDialogOpen] = useState(false);\n\n  const { data: customers, isLoading } = useQuery<Customer[]>({\n    queryKey: [\"/api/customers\"],\n  });\n\n  const filteredCustomers = customers?.filter(\n    (customer) =>\n      customer.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      customer.phone.includes(searchQuery)\n  );\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n        <div>\n          <h1 className=\"text-2xl font-semibold\">Customers</h1>\n          <p className=\"text-muted-foreground text-sm\">\n            Manage your customer database and profiles\n          </p>\n        </div>\n        <Button onClick={() => setAddDialogOpen(true)} data-testid=\"button-add-customer\">\n          <Plus className=\"h-4 w-4 mr-2\" />\n          Add Customer\n        </Button>\n      </div>\n\n      <Card>\n        <CardHeader className=\"flex flex-row items-center justify-between gap-4\">\n          <CardTitle className=\"text-lg\">Customer Database</CardTitle>\n          <div className=\"relative w-64\">\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"Search by name or phone...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"pl-9\"\n              data-testid=\"input-search-customers\"\n            />\n          </div>\n        </CardHeader>\n        <CardContent>\n          {isLoading ? (\n            <div className=\"space-y-3\">\n              {[1, 2, 3, 4, 5].map((i) => (\n                <Skeleton key={i} className=\"h-16 w-full\" />\n              ))}\n            </div>\n          ) : (\n            <div className=\"overflow-x-auto\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Customer</TableHead>\n                    <TableHead>Contact</TableHead>\n                    <TableHead>Tags</TableHead>\n                    <TableHead className=\"text-right\">Total Spend</TableHead>\n                    <TableHead className=\"text-right\">Bookings</TableHead>\n                    <TableHead className=\"text-right\">Reliability</TableHead>\n                    <TableHead></TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {filteredCustomers?.map((customer) => {\n                    const reliabilityScore =\n                      customer.totalBookings > 0\n                        ? Math.round(\n                            ((customer.totalBookings - customer.noShowCount) /\n                              customer.totalBookings) *\n                              100\n                          )\n                        : 100;\n\n                    return (\n                      <TableRow\n                        key={customer.id}\n                        className=\"cursor-pointer\"\n                        onClick={() => setSelectedCustomer(customer)}\n                        data-testid={`row-customer-${customer.id}`}\n                      >\n                        <TableCell>\n                          <div className=\"flex items-center gap-3\">\n                            <Avatar className=\"h-8 w-8\">\n                              <AvatarFallback className=\"text-xs\">\n                                {customer.name.charAt(0).toUpperCase()}\n                              </AvatarFallback>\n                            </Avatar>\n                            <div>\n                              <div className=\"font-medium\">{customer.name}</div>\n                              <div className=\"text-xs text-muted-foreground\">\n                                {customer.source}\n                              </div>\n                            </div>\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"text-sm\">{customer.phone}</div>\n                          {customer.email && (\n                            <div className=\"text-xs text-muted-foreground\">\n                              {customer.email}\n                            </div>\n                          )}\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"flex flex-wrap gap-1\">\n                            {customer.tags.map((tag) => (\n                              <CustomerTagBadge key={tag} tag={tag} />\n                            ))}\n                            {customer.isBlacklisted && (\n                              <Badge variant=\"destructive\" className=\"text-xs\">\n                                <Ban className=\"h-3 w-3 mr-1\" />\n                                Blacklisted\n                              </Badge>\n                            )}\n                          </div>\n                        </TableCell>\n                        <TableCell className=\"text-right font-medium\">\n                          ₹{Number(customer.totalSpend).toLocaleString()}\n                        </TableCell>\n                        <TableCell className=\"text-right\">\n                          {customer.totalBookings}\n                        </TableCell>\n                        <TableCell className=\"text-right\">\n                          <Badge\n                            variant=\"outline\"\n                            className={\n                              reliabilityScore >= 80\n                                ? \"text-green-500 border-green-500/30\"\n                                : reliabilityScore >= 60\n                                ? \"text-orange-500 border-orange-500/30\"\n                                : \"text-red-500 border-red-500/30\"\n                            }\n                          >\n                            {reliabilityScore}%\n                          </Badge>\n                        </TableCell>\n                        <TableCell>\n                          <DropdownMenu>\n                            <DropdownMenuTrigger asChild onClick={(e) => e.stopPropagation()}>\n                              <Button variant=\"ghost\" size=\"icon\" data-testid={`button-customer-actions-${customer.id}`}>\n                                <MoreHorizontal className=\"h-4 w-4\" />\n                              </Button>\n                            </DropdownMenuTrigger>\n                            <DropdownMenuContent align=\"end\">\n                              <DropdownMenuItem onClick={() => setSelectedCustomer(customer)}>\n                                <User className=\"h-4 w-4 mr-2\" />\n                                View Profile\n                              </DropdownMenuItem>\n                              <DropdownMenuItem>\n                                <Tag className=\"h-4 w-4 mr-2\" />\n                                Manage Tags\n                              </DropdownMenuItem>\n                              <DropdownMenuItem>\n                                <Wallet className=\"h-4 w-4 mr-2\" />\n                                View Transactions\n                              </DropdownMenuItem>\n                              <DropdownMenuSeparator />\n                              <DropdownMenuItem className=\"text-destructive\">\n                                <Ban className=\"h-4 w-4 mr-2\" />\n                                Blacklist Customer\n                              </DropdownMenuItem>\n                            </DropdownMenuContent>\n                          </DropdownMenu>\n                        </TableCell>\n                      </TableRow>\n                    );\n                  })}\n                </TableBody>\n              </Table>\n\n              {(!filteredCustomers || filteredCustomers.length === 0) && (\n                <div className=\"text-center py-12 text-muted-foreground\">\n                  <User className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                  <p>No customers found</p>\n                  <Button\n                    variant=\"link\"\n                    className=\"mt-2\"\n                    onClick={() => setAddDialogOpen(true)}\n                    data-testid=\"link-add-first-customer\"\n                  >\n                    Add your first customer\n                  </Button>\n                </div>\n              )}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      <CustomerDetailDialog\n        customer={selectedCustomer}\n        open={!!selectedCustomer}\n        onClose={() => setSelectedCustomer(null)}\n      />\n\n      <AddCustomerDialog\n        open={addDialogOpen}\n        onClose={() => setAddDialogOpen(false)}\n      />\n    </div>\n  );\n}\n","path":null,"size_bytes":20290,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4281,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":844,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1467,"size_tokens":null},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n  --opaque-button-border-intensity: -8;\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n  --background: 0 0% 100%;\n  --foreground: 0 0% 9%;\n  --border: 0 0% 90%;\n  --card: 0 0% 98%;\n  --card-foreground: 0 0% 9%;\n  --card-border: 0 0% 95%;\n  --sidebar: 0 0% 96%;\n  --sidebar-foreground: 0 0% 9%;\n  --sidebar-border: 0 0% 92%;\n  --sidebar-primary: 142 76% 36%;\n  --sidebar-primary-foreground: 0 0% 98%;\n  --sidebar-accent: 0 0% 92%;\n  --sidebar-accent-foreground: 0 0% 9%;\n  --sidebar-ring: 142 76% 36%;\n  --popover: 0 0% 94%;\n  --popover-foreground: 0 0% 9%;\n  --popover-border: 0 0% 90%;\n  --primary: 142 76% 36%;\n  --primary-foreground: 0 0% 98%;\n  --secondary: 0 0% 91%;\n  --secondary-foreground: 0 0% 9%;\n  --muted: 0 0% 93%;\n  --muted-foreground: 0 0% 35%;\n  --accent: 142 18% 94%;\n  --accent-foreground: 142 18% 15%;\n  --destructive: 0 84% 45%;\n  --destructive-foreground: 0 0% 98%;\n  --input: 0 0% 78%;\n  --ring: 142 76% 36%;\n  --chart-1: 142 76% 36%;\n  --chart-2: 173 58% 39%;\n  --chart-3: 197 37% 24%;\n  --chart-4: 43 74% 49%;\n  --chart-5: 27 87% 45%;\n  --font-sans: Inter, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: Menlo, monospace;\n  --radius: .5rem;\n  --shadow-2xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 2px 4px -1px hsl(0 0% 0% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 4px 6px -1px hsl(0 0% 0% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 8px 10px -1px hsl(0 0% 0% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n  --opaque-button-border-intensity: 9;\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n  --background: 0 0% 7%;\n  --foreground: 0 0% 98%;\n  --border: 0 0% 16%;\n  --card: 0 0% 9%;\n  --card-foreground: 0 0% 98%;\n  --card-border: 0 0% 12%;\n  --sidebar: 0 0% 11%;\n  --sidebar-foreground: 0 0% 98%;\n  --sidebar-border: 0 0% 14%;\n  --sidebar-primary: 142 76% 36%;\n  --sidebar-primary-foreground: 0 0% 98%;\n  --sidebar-accent: 0 0% 14%;\n  --sidebar-accent-foreground: 0 0% 98%;\n  --sidebar-ring: 142 76% 36%;\n  --popover: 0 0% 13%;\n  --popover-foreground: 0 0% 98%;\n  --popover-border: 0 0% 16%;\n  --primary: 142 76% 36%;\n  --primary-foreground: 0 0% 98%;\n  --secondary: 0 0% 16%;\n  --secondary-foreground: 0 0% 98%;\n  --muted: 0 0% 15%;\n  --muted-foreground: 0 0% 65%;\n  --accent: 142 18% 14%;\n  --accent-foreground: 142 18% 88%;\n  --destructive: 0 84% 45%;\n  --destructive-foreground: 0 0% 98%;\n  --input: 0 0% 24%;\n  --ring: 142 76% 36%;\n  --chart-1: 142 70% 65%;\n  --chart-2: 173 58% 65%;\n  --chart-3: 197 37% 60%;\n  --chart-4: 43 74% 70%;\n  --chart-5: 27 87% 67%;\n  --shadow-2xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 2px 4px -1px hsl(0 0% 0% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 4px 6px -1px hsl(0 0% 0% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 8px 10px -1px hsl(0 0% 0% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}\n","path":null,"size_bytes":10532,"size_tokens":null},"client/src/pages/financials.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Wallet,\n  ArrowUpRight,\n  ArrowDownRight,\n  Receipt,\n  Plus,\n  CreditCard,\n  DollarSign,\n  FileText,\n  Download,\n  CheckCircle,\n  Clock,\n  TrendingUp,\n} from \"lucide-react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { format } from \"date-fns\";\nimport type { Transaction, Settlement, Expense, SettlementSummary } from \"@shared/schema\";\nimport { insertExpenseSchema } from \"@shared/schema\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { EXPENSE_CATEGORIES } from \"@/lib/constants\";\n\nconst expenseFormSchema = insertExpenseSchema.extend({\n  amount: z.coerce.number().positive(\"Amount must be positive\"),\n  category: z.string().min(1, \"Please select a category\"),\n  date: z.string().min(1, \"Please select a date\"),\n});\n\ntype ExpenseFormValues = z.infer<typeof expenseFormSchema>;\n\nfunction StatCard({\n  title,\n  value,\n  subtitle,\n  icon: Icon,\n  trend,\n  variant = \"default\",\n}: {\n  title: string;\n  value: string;\n  subtitle?: string;\n  icon: React.ElementType;\n  trend?: \"up\" | \"down\";\n  variant?: \"default\" | \"success\" | \"warning\" | \"danger\";\n}) {\n  const variantClasses = {\n    default: \"\",\n    success: \"border-green-500/30\",\n    warning: \"border-orange-500/30\",\n    danger: \"border-red-500/30\",\n  };\n\n  return (\n    <Card className={variantClasses[variant]}>\n      <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n        <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n          {title}\n        </CardTitle>\n        <Icon className=\"h-4 w-4 text-muted-foreground\" />\n      </CardHeader>\n      <CardContent>\n        <div className=\"text-2xl font-bold\" data-testid={`stat-${title.toLowerCase().replace(/\\s/g, '-')}`}>{value}</div>\n        {(subtitle || trend) && (\n          <div className=\"flex items-center gap-1 text-xs text-muted-foreground mt-1\">\n            {trend && (\n              trend === \"up\" ? (\n                <ArrowUpRight className=\"h-3 w-3 text-green-500\" />\n              ) : (\n                <ArrowDownRight className=\"h-3 w-3 text-red-500\" />\n              )\n            )}\n            {subtitle}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction AddExpenseDialog({\n  open,\n  onClose,\n}: {\n  open: boolean;\n  onClose: () => void;\n}) {\n  const { toast } = useToast();\n\n  const form = useForm<ExpenseFormValues>({\n    resolver: zodResolver(expenseFormSchema),\n    defaultValues: {\n      category: \"\",\n      amount: 0,\n      description: \"\",\n      date: format(new Date(), \"yyyy-MM-dd\"),\n    },\n  });\n\n  const createExpense = useMutation({\n    mutationFn: async (data: ExpenseFormValues) => {\n      const response = await apiRequest(\"POST\", \"/api/expenses\", {\n        ...data,\n        amount: data.amount.toString(),\n      });\n      return response;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/expenses\"] });\n      toast({ title: \"Expense added successfully\" });\n      form.reset();\n      onClose();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to add expense\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: ExpenseFormValues) => {\n    createExpense.mutate(data);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>Add Expense</DialogTitle>\n          <DialogDescription>Track your venue operating costs</DialogDescription>\n        </DialogHeader>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"category\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Category</FormLabel>\n                  <Select onValueChange={field.onChange} value={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-expense-category\">\n                        <SelectValue placeholder=\"Select category\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      {EXPENSE_CATEGORIES.map((cat) => (\n                        <SelectItem key={cat.value} value={cat.value}>\n                          {cat.label}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"amount\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Amount (₹)</FormLabel>\n                  <FormControl>\n                    <Input type=\"number\" placeholder=\"0\" {...field} data-testid=\"input-expense-amount\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"date\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Date</FormLabel>\n                  <FormControl>\n                    <Input type=\"date\" {...field} data-testid=\"input-expense-date\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"description\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Description (Optional)</FormLabel>\n                  <FormControl>\n                    <Input\n                      placeholder=\"e.g., Monthly electricity bill\"\n                      {...field}\n                      value={field.value || \"\"}\n                      data-testid=\"input-expense-description\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"flex justify-end gap-2\">\n              <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={createExpense.isPending} data-testid=\"button-save-expense\">\n                {createExpense.isPending ? \"Saving...\" : \"Add Expense\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nfunction SettlementCard({ settlement }: { settlement: SettlementSummary }) {\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle className=\"text-lg flex items-center gap-2\">\n          <Wallet className=\"h-5 w-5\" />\n          Platform Settlement\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-4\">\n          <div className=\"grid grid-cols-3 gap-4\">\n            <div className=\"text-center p-3 bg-muted rounded-md\">\n              <div className=\"text-xs text-muted-foreground\">Total Earnings</div>\n              <div className=\"text-lg font-bold text-green-500\">\n                ₹{settlement.totalEarnings.toLocaleString()}\n              </div>\n            </div>\n            <div className=\"text-center p-3 bg-muted rounded-md\">\n              <div className=\"text-xs text-muted-foreground\">Settled</div>\n              <div className=\"text-lg font-bold\">\n                ₹{settlement.totalSettled.toLocaleString()}\n              </div>\n            </div>\n            <div className=\"text-center p-3 bg-muted rounded-md\">\n              <div className=\"text-xs text-muted-foreground\">Amount Due</div>\n              <div className=\"text-lg font-bold text-orange-500\">\n                ₹{settlement.amountDue.toLocaleString()}\n              </div>\n            </div>\n          </div>\n\n          <div className=\"p-3 bg-amber-50 dark:bg-amber-900/20 rounded-md\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <div className=\"text-sm font-medium\">Commission Rate</div>\n                <div className=\"text-xs text-muted-foreground\">\n                  On cash payments received\n                </div>\n              </div>\n              <Badge variant=\"secondary\">{settlement.commissionRate}%</Badge>\n            </div>\n          </div>\n\n          {settlement.amountDue > 0 && (\n            <Button className=\"w-full\" data-testid=\"button-pay-now\">\n              <CreditCard className=\"h-4 w-4 mr-2\" />\n              Pay ₹{settlement.amountDue.toLocaleString()} Now\n            </Button>\n          )}\n\n          <div className=\"space-y-2\">\n            <div className=\"text-sm font-medium\">Pending Settlements</div>\n            {settlement.pendingSettlements.length > 0 ? (\n              settlement.pendingSettlements.map((s) => (\n                <div\n                  key={s.id}\n                  className=\"flex items-center justify-between p-2 bg-muted rounded-md text-sm\"\n                >\n                  <div>\n                    <span className=\"font-medium\">\n                      {s.periodStart} - {s.periodEnd}\n                    </span>\n                    <span className=\"text-muted-foreground ml-2\">\n                      ({s.totalBookings} bookings)\n                    </span>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"font-medium\">₹{s.amount}</span>\n                    <Badge\n                      variant={s.status === \"paid\" ? \"default\" : \"secondary\"}\n                      className=\"text-xs\"\n                    >\n                      {s.status === \"paid\" ? (\n                        <CheckCircle className=\"h-3 w-3 mr-1\" />\n                      ) : (\n                        <Clock className=\"h-3 w-3 mr-1\" />\n                      )}\n                      {s.status}\n                    </Badge>\n                  </div>\n                </div>\n              ))\n            ) : (\n              <div className=\"text-center py-4 text-muted-foreground text-sm\">\n                No pending settlements\n              </div>\n            )}\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nexport default function Financials() {\n  const [expenseDialogOpen, setExpenseDialogOpen] = useState(false);\n\n  const { data: transactions, isLoading: transactionsLoading } = useQuery<Transaction[]>({\n    queryKey: [\"/api/transactions\"],\n  });\n\n  const { data: expenses, isLoading: expensesLoading } = useQuery<Expense[]>({\n    queryKey: [\"/api/expenses\"],\n  });\n\n  const { data: settlement, isLoading: settlementLoading } = useQuery<SettlementSummary>({\n    queryKey: [\"/api/settlements/summary\"],\n  });\n\n  const totalRevenue = transactions?.reduce(\n    (sum, t) => (t.type === \"booking_payment\" ? sum + Number(t.amount) : sum),\n    0\n  ) || 0;\n\n  const totalExpenses = expenses?.reduce((sum, e) => sum + Number(e.amount), 0) || 0;\n  const netProfit = totalRevenue - totalExpenses;\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n        <div>\n          <h1 className=\"text-2xl font-semibold\">Financials</h1>\n          <p className=\"text-muted-foreground text-sm\">\n            Track revenue, expenses, and platform settlements\n          </p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <Button\n            variant=\"outline\"\n            onClick={() => setExpenseDialogOpen(true)}\n            data-testid=\"button-add-expense\"\n          >\n            <Plus className=\"h-4 w-4 mr-2\" />\n            Add Expense\n          </Button>\n          <Button variant=\"outline\" data-testid=\"button-download-report\">\n            <Download className=\"h-4 w-4 mr-2\" />\n            Export Report\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        <StatCard\n          title=\"Total Revenue\"\n          value={`₹${totalRevenue.toLocaleString()}`}\n          icon={TrendingUp}\n          trend=\"up\"\n          subtitle=\"+15% this month\"\n          variant=\"success\"\n        />\n        <StatCard\n          title=\"Total Expenses\"\n          value={`₹${totalExpenses.toLocaleString()}`}\n          icon={ArrowDownRight}\n          subtitle=\"Operating costs\"\n        />\n        <StatCard\n          title=\"Net Profit\"\n          value={`₹${netProfit.toLocaleString()}`}\n          icon={DollarSign}\n          trend={netProfit > 0 ? \"up\" : \"down\"}\n          variant={netProfit > 0 ? \"success\" : \"danger\"}\n        />\n        <StatCard\n          title=\"Platform Due\"\n          value={`₹${(settlement?.amountDue || 0).toLocaleString()}`}\n          icon={Wallet}\n          subtitle=\"Commission pending\"\n          variant={settlement?.amountDue && settlement.amountDue > 0 ? \"warning\" : \"default\"}\n        />\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        <div className=\"lg:col-span-2\">\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2\">\n              <CardTitle className=\"text-lg\">Financial Records</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <Tabs defaultValue=\"transactions\">\n                <TabsList className=\"mb-4\">\n                  <TabsTrigger value=\"transactions\" data-testid=\"tab-transactions\">\n                    Transactions\n                  </TabsTrigger>\n                  <TabsTrigger value=\"expenses\" data-testid=\"tab-expenses\">\n                    Expenses\n                  </TabsTrigger>\n                </TabsList>\n\n                <TabsContent value=\"transactions\">\n                  {transactionsLoading ? (\n                    <div className=\"space-y-3\">\n                      {[1, 2, 3, 4, 5].map((i) => (\n                        <Skeleton key={i} className=\"h-12 w-full\" />\n                      ))}\n                    </div>\n                  ) : (\n                    <div className=\"overflow-x-auto\">\n                      <Table>\n                        <TableHeader>\n                          <TableRow>\n                            <TableHead>Date</TableHead>\n                            <TableHead>Type</TableHead>\n                            <TableHead>Method</TableHead>\n                            <TableHead className=\"text-right\">Amount</TableHead>\n                            <TableHead>Status</TableHead>\n                          </TableRow>\n                        </TableHeader>\n                        <TableBody>\n                          {transactions?.slice(0, 10).map((transaction) => (\n                            <TableRow key={transaction.id}>\n                              <TableCell className=\"text-sm\">\n                                {format(new Date(transaction.createdAt), \"MMM d, yyyy\")}\n                              </TableCell>\n                              <TableCell>\n                                <Badge variant=\"outline\" className=\"text-xs\">\n                                  {transaction.type.replace(\"_\", \" \")}\n                                </Badge>\n                              </TableCell>\n                              <TableCell className=\"text-sm capitalize\">\n                                {transaction.paymentMethod}\n                              </TableCell>\n                              <TableCell className=\"text-right font-medium\">\n                                <span\n                                  className={\n                                    transaction.type === \"refund\"\n                                      ? \"text-red-500\"\n                                      : \"text-green-500\"\n                                  }\n                                >\n                                  {transaction.type === \"refund\" ? \"-\" : \"+\"}₹\n                                  {Number(transaction.amount).toLocaleString()}\n                                </span>\n                              </TableCell>\n                              <TableCell>\n                                <Badge\n                                  variant={\n                                    transaction.status === \"completed\"\n                                      ? \"default\"\n                                      : \"secondary\"\n                                  }\n                                  className=\"text-xs\"\n                                >\n                                  {transaction.status}\n                                </Badge>\n                              </TableCell>\n                            </TableRow>\n                          ))}\n                        </TableBody>\n                      </Table>\n\n                      {(!transactions || transactions.length === 0) && (\n                        <div className=\"text-center py-12 text-muted-foreground\">\n                          <Receipt className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                          <p>No transactions yet</p>\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </TabsContent>\n\n                <TabsContent value=\"expenses\">\n                  {expensesLoading ? (\n                    <div className=\"space-y-3\">\n                      {[1, 2, 3, 4, 5].map((i) => (\n                        <Skeleton key={i} className=\"h-12 w-full\" />\n                      ))}\n                    </div>\n                  ) : (\n                    <div className=\"overflow-x-auto\">\n                      <Table>\n                        <TableHeader>\n                          <TableRow>\n                            <TableHead>Date</TableHead>\n                            <TableHead>Category</TableHead>\n                            <TableHead>Description</TableHead>\n                            <TableHead className=\"text-right\">Amount</TableHead>\n                          </TableRow>\n                        </TableHeader>\n                        <TableBody>\n                          {expenses?.map((expense) => (\n                            <TableRow key={expense.id}>\n                              <TableCell className=\"text-sm\">\n                                {expense.date}\n                              </TableCell>\n                              <TableCell>\n                                <Badge variant=\"outline\" className=\"text-xs capitalize\">\n                                  {expense.category}\n                                </Badge>\n                              </TableCell>\n                              <TableCell className=\"text-sm text-muted-foreground\">\n                                {expense.description || \"-\"}\n                              </TableCell>\n                              <TableCell className=\"text-right font-medium text-red-500\">\n                                -₹{Number(expense.amount).toLocaleString()}\n                              </TableCell>\n                            </TableRow>\n                          ))}\n                        </TableBody>\n                      </Table>\n\n                      {(!expenses || expenses.length === 0) && (\n                        <div className=\"text-center py-12 text-muted-foreground\">\n                          <FileText className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                          <p>No expenses recorded</p>\n                          <Button\n                            variant=\"link\"\n                            className=\"mt-2\"\n                            onClick={() => setExpenseDialogOpen(true)}\n                            data-testid=\"link-add-first-expense\"\n                          >\n                            Add your first expense\n                          </Button>\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </TabsContent>\n              </Tabs>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div>\n          {settlementLoading ? (\n            <Skeleton className=\"h-96\" />\n          ) : (\n            <SettlementCard\n              settlement={\n                settlement || {\n                  totalEarnings: 0,\n                  totalSettled: 0,\n                  amountDue: 0,\n                  commissionRate: 5,\n                  pendingSettlements: [],\n                }\n              }\n            />\n          )}\n        </div>\n      </div>\n\n      <AddExpenseDialog\n        open={expenseDialogOpen}\n        onClose={() => setExpenseDialogOpen(false)}\n      />\n    </div>\n  );\n}\n","path":null,"size_bytes":21723,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { ThemeProvider } from \"@/components/theme-provider\";\nimport { ThemeToggle } from \"@/components/theme-toggle\";\nimport {\n  SidebarProvider,\n  SidebarTrigger,\n  SidebarInset,\n} from \"@/components/ui/sidebar\";\nimport { AppSidebar } from \"@/components/app-sidebar\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Loader2, Building2 } from \"lucide-react\";\n\nimport Dashboard from \"@/pages/dashboard\";\nimport Bookings from \"@/pages/bookings\";\nimport Customers from \"@/pages/customers\";\nimport WalkinBooking from \"@/pages/walkin\";\nimport Financials from \"@/pages/financials\";\nimport Scanner from \"@/pages/scanner\";\nimport Tournaments from \"@/pages/tournaments\";\nimport WaitlistPage from \"@/pages/waitlist\";\nimport Settings from \"@/pages/settings\";\nimport Analytics from \"@/pages/analytics\";\nimport StaffManagement from \"@/pages/staff\";\nimport Memberships from \"@/pages/memberships\";\nimport NotFound from \"@/pages/not-found\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={Dashboard} />\n      <Route path=\"/bookings\" component={Bookings} />\n      <Route path=\"/customers\" component={Customers} />\n      <Route path=\"/walkin\" component={WalkinBooking} />\n      <Route path=\"/financials\" component={Financials} />\n      <Route path=\"/scanner\" component={Scanner} />\n      <Route path=\"/tournaments\" component={Tournaments} />\n      <Route path=\"/waitlist\" component={WaitlistPage} />\n      <Route path=\"/settings\" component={Settings} />\n      <Route path=\"/analytics\" component={Analytics} />\n      <Route path=\"/staff\" component={StaffManagement} />\n      <Route path=\"/memberships\" component={Memberships} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction LandingPage() {\n  return (\n    <div className=\"min-h-screen flex flex-col items-center justify-center bg-background p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"text-center\">\n          <div className=\"mx-auto w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mb-4\">\n            <Building2 className=\"w-6 h-6 text-primary\" />\n          </div>\n          <CardTitle className=\"text-2xl\">VenueHub</CardTitle>\n          <CardDescription>\n            Sports Venue Management System\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"flex flex-col gap-4\">\n          <p className=\"text-sm text-muted-foreground text-center\">\n            Manage your sports venue bookings, customers, and finances all in one place.\n          </p>\n          <Button \n            data-testid=\"button-login\"\n            onClick={() => window.location.href = \"/api/login\"}\n            className=\"w-full\"\n          >\n            Sign In to Continue\n          </Button>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\nfunction LoadingScreen() {\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-background\">\n      <div className=\"flex flex-col items-center gap-4\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n        <p className=\"text-muted-foreground\">Loading...</p>\n      </div>\n    </div>\n  );\n}\n\nfunction AppLayout({ user }: { user: any }) {\n  const style = {\n    \"--sidebar-width\": \"16rem\",\n    \"--sidebar-width-icon\": \"3rem\",\n  };\n\n  return (\n    <SidebarProvider style={style as React.CSSProperties}>\n      <div className=\"flex h-screen w-full\">\n        <AppSidebar user={user} />\n        <SidebarInset className=\"flex flex-col\">\n          <header className=\"sticky top-0 z-50 flex h-12 items-center justify-between gap-2 border-b bg-background px-4\">\n            <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n            <ThemeToggle />\n          </header>\n          <main className=\"flex-1 overflow-auto\">\n            <Router />\n          </main>\n        </SidebarInset>\n      </div>\n    </SidebarProvider>\n  );\n}\n\nfunction AuthenticatedApp() {\n  const { user, isLoading, isAuthenticated } = useAuth();\n\n  if (isLoading) {\n    return <LoadingScreen />;\n  }\n\n  if (!isAuthenticated) {\n    return <LandingPage />;\n  }\n\n  return <AppLayout user={user} />;\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <ThemeProvider defaultTheme=\"dark\" storageKey=\"venuehub-theme\">\n        <TooltipProvider>\n          <AuthenticatedApp />\n          <Toaster />\n        </TooltipProvider>\n      </ThemeProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","path":null,"size_bytes":4837,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2154,"size_tokens":null},"client/src/hooks/use-realtime.ts":{"content":"import { useEffect, useCallback } from \"react\";\nimport { useWebSocket, WebSocketMessage } from \"@/lib/websocket\";\nimport { queryClient } from \"@/lib/queryClient\";\n\ntype EventHandler = (payload: unknown) => void;\n\nexport function useRealtime(eventHandlers?: Record<string, EventHandler>) {\n  const { isConnected, subscribe, unsubscribe } = useWebSocket();\n\n  useEffect(() => {\n    const handlers: Array<{ type: string; handler: EventHandler }> = [];\n\n    // Default handlers for common events - invalidate relevant queries\n    const defaultHandlers: Record<string, EventHandler> = {\n      booking_created: () => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/bookings\"] });\n        queryClient.invalidateQueries({ queryKey: [\"/api/stats/dashboard\"] });\n      },\n      booking_updated: () => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/bookings\"] });\n        queryClient.invalidateQueries({ queryKey: [\"/api/stats/dashboard\"] });\n      },\n      booking_deleted: () => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/bookings\"] });\n        queryClient.invalidateQueries({ queryKey: [\"/api/stats/dashboard\"] });\n      },\n      customer_created: () => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/customers\"] });\n      },\n      customer_updated: () => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/customers\"] });\n      },\n      court_created: () => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/courts\"] });\n      },\n      court_updated: () => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/courts\"] });\n      },\n      court_deleted: () => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/courts\"] });\n      },\n      transaction_created: () => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/transactions\"] });\n        queryClient.invalidateQueries({ queryKey: [\"/api/stats/dashboard\"] });\n      },\n      waitlist_created: () => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/waitlist\"] });\n      },\n      waitlist_updated: () => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/waitlist\"] });\n      },\n      blocked_slot_created: () => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/blocked-slots\"] });\n        queryClient.invalidateQueries({ queryKey: [\"/api/bookings\"] });\n      },\n      blocked_slot_deleted: () => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/blocked-slots\"] });\n        queryClient.invalidateQueries({ queryKey: [\"/api/bookings\"] });\n      },\n      tournament_created: () => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\"] });\n      },\n      tournament_updated: () => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\"] });\n      },\n      tournament_team_created: () => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\"] });\n      },\n    };\n\n    // Register default handlers\n    Object.entries(defaultHandlers).forEach(([type, handler]) => {\n      handlers.push({ type, handler });\n      subscribe(type, handler);\n    });\n\n    // Register custom handlers\n    if (eventHandlers) {\n      Object.entries(eventHandlers).forEach(([type, handler]) => {\n        handlers.push({ type, handler });\n        subscribe(type, handler);\n      });\n    }\n\n    return () => {\n      handlers.forEach(({ type, handler }) => {\n        unsubscribe(type, handler);\n      });\n    };\n  }, [subscribe, unsubscribe, eventHandlers]);\n\n  return { isConnected };\n}\n","path":null,"size_bytes":3481,"size_tokens":null},"client/src/lib/websocket.ts":{"content":"import { useEffect, useRef, useCallback, useState } from \"react\";\n\nexport type WebSocketMessage = {\n  type: string;\n  payload: unknown;\n};\n\ntype EventHandler = (payload: unknown) => void;\n\nconst eventHandlers = new Map<string, Set<EventHandler>>();\nlet globalSocket: WebSocket | null = null;\nlet connectionPromise: Promise<void> | null = null;\n\nfunction getOrCreateSocket(): Promise<void> {\n  if (globalSocket?.readyState === WebSocket.OPEN) {\n    return Promise.resolve();\n  }\n  \n  if (connectionPromise) {\n    return connectionPromise;\n  }\n  \n  connectionPromise = new Promise((resolve) => {\n    const protocol = window.location.protocol === \"https:\" ? \"wss:\" : \"ws:\";\n    const wsUrl = `${protocol}//${window.location.host}/ws`;\n    \n    try {\n      const socket = new WebSocket(wsUrl);\n      \n      socket.onopen = () => {\n        console.log(\"WebSocket connected\");\n        globalSocket = socket;\n        connectionPromise = null;\n        resolve();\n      };\n      \n      socket.onmessage = (event) => {\n        try {\n          const message = JSON.parse(event.data) as WebSocketMessage;\n          const handlers = eventHandlers.get(message.type);\n          if (handlers) {\n            handlers.forEach(handler => handler(message.payload));\n          }\n        } catch (error) {\n          console.error(\"Failed to parse WebSocket message:\", error);\n        }\n      };\n      \n      socket.onclose = () => {\n        console.log(\"WebSocket disconnected\");\n        globalSocket = null;\n        connectionPromise = null;\n        \n        setTimeout(() => {\n          if (eventHandlers.size > 0) {\n            getOrCreateSocket();\n          }\n        }, 3000);\n      };\n      \n      socket.onerror = (error) => {\n        console.error(\"WebSocket error:\", error);\n        connectionPromise = null;\n        setTimeout(() => {\n          if (eventHandlers.size > 0) {\n            getOrCreateSocket();\n          }\n        }, 3000);\n        resolve();\n      };\n    } catch (error) {\n      connectionPromise = null;\n      setTimeout(() => {\n        if (eventHandlers.size > 0) {\n          getOrCreateSocket();\n        }\n      }, 3000);\n      resolve();\n    }\n  });\n  \n  return connectionPromise;\n}\n\nfunction subscribeToEvent(type: string, handler: EventHandler): void {\n  if (!eventHandlers.has(type)) {\n    eventHandlers.set(type, new Set());\n  }\n  eventHandlers.get(type)!.add(handler);\n  \n  getOrCreateSocket();\n}\n\nfunction unsubscribeFromEvent(type: string, handler: EventHandler): void {\n  const handlers = eventHandlers.get(type);\n  if (handlers) {\n    handlers.delete(handler);\n    if (handlers.size === 0) {\n      eventHandlers.delete(type);\n    }\n  }\n}\n\nfunction sendWebSocketMessage(type: string, payload: unknown): void {\n  if (globalSocket?.readyState === WebSocket.OPEN) {\n    globalSocket.send(JSON.stringify({ type, payload }));\n  }\n}\n\nexport function useWebSocket() {\n  const [isConnected, setIsConnected] = useState(\n    globalSocket?.readyState === WebSocket.OPEN\n  );\n  \n  useEffect(() => {\n    const checkConnection = () => {\n      setIsConnected(globalSocket?.readyState === WebSocket.OPEN);\n    };\n    \n    const interval = setInterval(checkConnection, 1000);\n    \n    getOrCreateSocket().then(() => setIsConnected(true)).catch(() => setIsConnected(false));\n    \n    return () => clearInterval(interval);\n  }, []);\n  \n  const subscribe = useCallback((type: string, handler: EventHandler) => {\n    subscribeToEvent(type, handler);\n  }, []);\n  \n  const unsubscribe = useCallback((type: string, handler: EventHandler) => {\n    unsubscribeFromEvent(type, handler);\n  }, []);\n  \n  const sendMessage = useCallback((type: string, payload: unknown) => {\n    sendWebSocketMessage(type, payload);\n  }, []);\n  \n  const reconnect = useCallback(() => {\n    if (globalSocket) {\n      globalSocket.close();\n      globalSocket = null;\n    }\n    return getOrCreateSocket();\n  }, []);\n  \n  return {\n    isConnected,\n    subscribe,\n    unsubscribe,\n    sendMessage,\n    reconnect,\n  };\n}\n","path":null,"size_bytes":3983,"size_tokens":null},"server/replit_integrations/auth/storage.ts":{"content":"import { users, type User, type UpsertUser } from \"@shared/models/auth\";\nimport { db } from \"../../db\";\nimport { eq } from \"drizzle-orm\";\n\n// Interface for auth storage operations\n// (IMPORTANT) These user operations are mandatory for Replit Auth.\nexport interface IAuthStorage {\n  getUser(id: string): Promise<User | undefined>;\n  upsertUser(user: UpsertUser): Promise<User>;\n}\n\nclass AuthStorage implements IAuthStorage {\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    const [user] = await db\n      .insert(users)\n      .values(userData)\n      .onConflictDoUpdate({\n        target: users.id,\n        set: {\n          ...userData,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return user;\n  }\n}\n\nexport const authStorage = new AuthStorage();\n","path":null,"size_bytes":943,"size_tokens":null},"client/src/pages/dashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  CalendarPlus,\n  Ban,\n  Receipt,\n  TrendingUp,\n  TrendingDown,\n  Users,\n  DollarSign,\n  Clock,\n  AlertCircle,\n  Wifi,\n  WifiOff,\n} from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport type { DashboardStats, Court, Booking } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport {\n  BarChart,\n  Bar,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer,\n  Cell,\n} from \"recharts\";\nimport { getPaymentStatusColor, getBookingStatusColor } from \"@/lib/constants\";\nimport { useRealtime } from \"@/hooks/use-realtime\";\n\nfunction StatCard({\n  title,\n  value,\n  subtitle,\n  icon: Icon,\n  trend,\n  trendValue,\n}: {\n  title: string;\n  value: string | number;\n  subtitle?: string;\n  icon: React.ElementType;\n  trend?: \"up\" | \"down\";\n  trendValue?: string;\n}) {\n  return (\n    <Card>\n      <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n        <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n          {title}\n        </CardTitle>\n        <Icon className=\"h-4 w-4 text-muted-foreground\" />\n      </CardHeader>\n      <CardContent>\n        <div className=\"text-3xl font-bold\" data-testid={`stat-${title.toLowerCase().replace(/\\s/g, '-')}`}>{value}</div>\n        {(subtitle || trend) && (\n          <div className=\"flex items-center gap-1 text-xs text-muted-foreground mt-1\">\n            {trend && (\n              <>\n                {trend === \"up\" ? (\n                  <TrendingUp className=\"h-3 w-3 text-green-500\" />\n                ) : (\n                  <TrendingDown className=\"h-3 w-3 text-red-500\" />\n                )}\n                <span className={trend === \"up\" ? \"text-green-500\" : \"text-red-500\"}>\n                  {trendValue}\n                </span>\n              </>\n            )}\n            {subtitle && <span>{subtitle}</span>}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction CourtStatusCard({ court, bookings }: { court: Court; bookings: Booking[] }) {\n  const now = new Date();\n  const currentTime = format(now, \"HH:mm\");\n  const today = format(now, \"yyyy-MM-dd\");\n\n  const todayBookings = bookings.filter(\n    (b) => b.courtId === court.id && b.date === today\n  );\n\n  const currentBooking = todayBookings.find(\n    (b) => b.startTime <= currentTime && b.endTime > currentTime\n  );\n\n  const nextBooking = todayBookings\n    .filter((b) => b.startTime > currentTime)\n    .sort((a, b) => a.startTime.localeCompare(b.startTime))[0];\n\n  const isOccupied = !!currentBooking;\n\n  return (\n    <Card className={isOccupied ? \"border-green-500/50\" : \"border-muted\"}>\n      <CardContent className=\"p-4\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <h3 className=\"font-semibold text-sm\">{court.name}</h3>\n          <Badge variant={isOccupied ? \"default\" : \"secondary\"} className=\"text-xs\">\n            {isOccupied ? \"Occupied\" : \"Available\"}\n          </Badge>\n        </div>\n        <p className=\"text-xs text-muted-foreground mb-2\">{court.sport}</p>\n        {currentBooking && (\n          <div className=\"text-xs\">\n            <span className=\"text-muted-foreground\">Current: </span>\n            <span>\n              {currentBooking.startTime} - {currentBooking.endTime}\n            </span>\n          </div>\n        )}\n        {nextBooking && (\n          <div className=\"text-xs mt-1\">\n            <span className=\"text-muted-foreground\">Next: </span>\n            <span>\n              {nextBooking.startTime} - {nextBooking.endTime}\n            </span>\n          </div>\n        )}\n        {!currentBooking && !nextBooking && (\n          <div className=\"text-xs text-muted-foreground\">No bookings today</div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction QuickActionButton({\n  icon: Icon,\n  label,\n  href,\n}: {\n  icon: React.ElementType;\n  label: string;\n  href: string;\n}) {\n  return (\n    <Link href={href}>\n      <Button\n        variant=\"outline\"\n        className=\"w-full h-auto py-4 flex flex-col gap-2\"\n        data-testid={`quick-action-${label.toLowerCase().replace(/\\s/g, '-')}`}\n      >\n        <Icon className=\"h-5 w-5\" />\n        <span className=\"text-xs\">{label}</span>\n      </Button>\n    </Link>\n  );\n}\n\nfunction RecentBookingRow({ booking }: { booking: Booking }) {\n  return (\n    <div className=\"flex items-center justify-between py-2 border-b border-border last:border-0\">\n      <div className=\"flex-1 min-w-0\">\n        <p className=\"text-sm font-medium truncate\">{booking.notes || `Booking #${booking.id.slice(0, 8)}`}</p>\n        <p className=\"text-xs text-muted-foreground\">\n          {booking.date} | {booking.startTime} - {booking.endTime}\n        </p>\n      </div>\n      <div className=\"flex items-center gap-2\">\n        <Badge\n          variant=\"outline\"\n          className={`text-xs ${getPaymentStatusColor(booking.paymentStatus)}`}\n        >\n          {booking.paymentStatus}\n        </Badge>\n        <Badge\n          variant=\"outline\"\n          className={`text-xs ${getBookingStatusColor(booking.status)}`}\n        >\n          {booking.status}\n        </Badge>\n      </div>\n    </div>\n  );\n}\n\nexport default function Dashboard() {\n  // Real-time updates via WebSocket\n  const { isConnected } = useRealtime();\n\n  const { data: stats, isLoading: statsLoading } = useQuery<DashboardStats>({\n    queryKey: [\"/api/stats/dashboard\"],\n  });\n\n  const { data: courts, isLoading: courtsLoading } = useQuery<Court[]>({\n    queryKey: [\"/api/courts\"],\n  });\n\n  const { data: bookings, isLoading: bookingsLoading } = useQuery<Booking[]>({\n    queryKey: [\"/api/bookings\"],\n  });\n\n  const today = format(new Date(), \"yyyy-MM-dd\");\n  const todayBookings = bookings?.filter((b) => b.date === today) || [];\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n        <div>\n          <h1 className=\"text-2xl font-semibold\">Command Center</h1>\n          <p className=\"text-muted-foreground text-sm\">\n            {format(new Date(), \"EEEE, MMMM d, yyyy\")}\n          </p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <Badge variant=\"outline\" className=\"text-xs px-2 py-1\" data-testid=\"status-realtime\">\n            {isConnected ? (\n              <>\n                <Wifi className=\"w-3 h-3 mr-1 text-green-500\" />\n                <span className=\"w-2 h-2 rounded-full bg-green-500 mr-2 animate-pulse\" />\n                Live\n              </>\n            ) : (\n              <>\n                <WifiOff className=\"w-3 h-3 mr-1 text-muted-foreground\" />\n                Offline\n              </>\n            )}\n          </Badge>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        {statsLoading ? (\n          <>\n            {[1, 2, 3, 4].map((i) => (\n              <Card key={i}>\n                <CardHeader className=\"pb-2\">\n                  <Skeleton className=\"h-4 w-24\" />\n                </CardHeader>\n                <CardContent>\n                  <Skeleton className=\"h-8 w-16\" />\n                  <Skeleton className=\"h-3 w-32 mt-2\" />\n                </CardContent>\n              </Card>\n            ))}\n          </>\n        ) : (\n          <>\n            <StatCard\n              title=\"Today's Bookings\"\n              value={stats?.totalBookingsToday || 0}\n              icon={CalendarPlus}\n              subtitle=\"bookings today\"\n            />\n            <StatCard\n              title=\"Today's Revenue\"\n              value={`₹${(stats?.totalRevenueToday || 0).toLocaleString()}`}\n              icon={DollarSign}\n              trend=\"up\"\n              trendValue=\"+12%\"\n            />\n            <StatCard\n              title=\"Pending Check-ins\"\n              value={stats?.pendingCheckIns || 0}\n              icon={Clock}\n              subtitle=\"awaiting arrival\"\n            />\n            <StatCard\n              title=\"Pending Payments\"\n              value={stats?.pendingPayments || 0}\n              icon={AlertCircle}\n              subtitle=\"to collect\"\n            />\n          </>\n        )}\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        <Card className=\"lg:col-span-2\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2\">\n            <CardTitle className=\"text-lg\">Court Status</CardTitle>\n            <Badge variant=\"secondary\" className=\"text-xs\">\n              {courts?.filter((c) => c.isActive).length || 0} / {courts?.length || 0} Active\n            </Badge>\n          </CardHeader>\n          <CardContent>\n            {courtsLoading || bookingsLoading ? (\n              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\n                {[1, 2, 3, 4, 5, 6].map((i) => (\n                  <Skeleton key={i} className=\"h-24\" />\n                ))}\n              </div>\n            ) : (\n              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\n                {courts?.filter((c) => c.isActive).map((court) => (\n                  <CourtStatusCard\n                    key={court.id}\n                    court={court}\n                    bookings={bookings || []}\n                  />\n                ))}\n                {(!courts || courts.length === 0) && (\n                  <div className=\"col-span-full text-center py-8 text-muted-foreground\">\n                    <Users className=\"h-8 w-8 mx-auto mb-2 opacity-50\" />\n                    <p className=\"text-sm\">No courts configured</p>\n                    <Link href=\"/settings\">\n                      <Button variant=\"link\" className=\"mt-2\" data-testid=\"link-add-courts\">\n                        Add Courts\n                      </Button>\n                    </Link>\n                  </div>\n                )}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg\">Quick Actions</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <QuickActionButton\n                icon={CalendarPlus}\n                label=\"New Booking\"\n                href=\"/walkin\"\n              />\n              <QuickActionButton icon={Ban} label=\"Block Slot\" href=\"/bookings\" />\n              <QuickActionButton\n                icon={Receipt}\n                label=\"Add Expense\"\n                href=\"/financials\"\n              />\n              <QuickActionButton\n                icon={Users}\n                label=\"Add Customer\"\n                href=\"/customers\"\n              />\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2\">\n            <CardTitle className=\"text-lg\">Weekly Revenue</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {statsLoading ? (\n              <Skeleton className=\"h-48 w-full\" />\n            ) : (\n              <ResponsiveContainer width=\"100%\" height={200}>\n                <BarChart\n                  data={\n                    stats?.weeklyRevenue || [\n                      { day: \"Mon\", revenue: 0 },\n                      { day: \"Tue\", revenue: 0 },\n                      { day: \"Wed\", revenue: 0 },\n                      { day: \"Thu\", revenue: 0 },\n                      { day: \"Fri\", revenue: 0 },\n                      { day: \"Sat\", revenue: 0 },\n                      { day: \"Sun\", revenue: 0 },\n                    ]\n                  }\n                >\n                  <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\n                  <XAxis\n                    dataKey=\"day\"\n                    className=\"text-xs fill-muted-foreground\"\n                    tick={{ fill: \"hsl(var(--muted-foreground))\" }}\n                  />\n                  <YAxis\n                    className=\"text-xs fill-muted-foreground\"\n                    tick={{ fill: \"hsl(var(--muted-foreground))\" }}\n                  />\n                  <Tooltip\n                    contentStyle={{\n                      backgroundColor: \"hsl(var(--popover))\",\n                      border: \"1px solid hsl(var(--border))\",\n                      borderRadius: \"6px\",\n                    }}\n                    labelStyle={{ color: \"hsl(var(--foreground))\" }}\n                  />\n                  <Bar dataKey=\"revenue\" radius={[4, 4, 0, 0]}>\n                    {(stats?.weeklyRevenue || []).map((_, index) => (\n                      <Cell\n                        key={`cell-${index}`}\n                        fill=\"hsl(var(--primary))\"\n                        opacity={0.8 + index * 0.02}\n                      />\n                    ))}\n                  </Bar>\n                </BarChart>\n              </ResponsiveContainer>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2\">\n            <CardTitle className=\"text-lg\">Today's Bookings</CardTitle>\n            <Link href=\"/bookings\">\n              <Button variant=\"ghost\" size=\"sm\" data-testid=\"link-view-all-bookings\">\n                View All\n              </Button>\n            </Link>\n          </CardHeader>\n          <CardContent>\n            {bookingsLoading ? (\n              <div className=\"space-y-3\">\n                {[1, 2, 3, 4].map((i) => (\n                  <div key={i} className=\"flex items-center gap-3\">\n                    <Skeleton className=\"h-10 w-10 rounded\" />\n                    <div className=\"flex-1\">\n                      <Skeleton className=\"h-4 w-32\" />\n                      <Skeleton className=\"h-3 w-24 mt-1\" />\n                    </div>\n                    <Skeleton className=\"h-6 w-16\" />\n                  </div>\n                ))}\n              </div>\n            ) : todayBookings.length > 0 ? (\n              <div className=\"space-y-1\">\n                {todayBookings.slice(0, 5).map((booking) => (\n                  <RecentBookingRow key={booking.id} booking={booking} />\n                ))}\n              </div>\n            ) : (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                <CalendarPlus className=\"h-8 w-8 mx-auto mb-2 opacity-50\" />\n                <p className=\"text-sm\">No bookings today</p>\n                <Link href=\"/walkin\">\n                  <Button variant=\"link\" className=\"mt-2\" data-testid=\"link-create-first-booking\">\n                    Create first booking\n                  </Button>\n                </Link>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":14992,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5741,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1251,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1527,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1383,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"server/db.ts":{"content":"import { drizzle } from \"drizzle-orm/node-postgres\";\nimport pg from \"pg\";\nimport * as schema from \"@shared/schema\";\n\nconst { Pool } = pg;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle(pool, { schema });\n","path":null,"size_bytes":395,"size_tokens":null},"client/src/components/high-risk-warning.tsx":{"content":"import {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { AlertTriangle, Shield } from \"lucide-react\";\nimport type { Customer } from \"@shared/schema\";\n\ninterface HighRiskWarningProps {\n  customer: Customer | null;\n  open: boolean;\n  onConfirm: () => void;\n  onCancel: () => void;\n}\n\nexport function HighRiskWarning({\n  customer,\n  open,\n  onConfirm,\n  onCancel,\n}: HighRiskWarningProps) {\n  if (!customer) return null;\n\n  const isHighRisk = customer.tags?.includes(\"HIGH_RISK\") || customer.isBlacklisted;\n  const noShowRate = customer.totalBookings > 0\n    ? Math.round((customer.noShowCount / customer.totalBookings) * 100)\n    : 0;\n\n  return (\n    <AlertDialog open={open} onOpenChange={(open) => !open && onCancel()}>\n      <AlertDialogContent className=\"max-w-md\">\n        <AlertDialogHeader>\n          <AlertDialogTitle className=\"flex items-center gap-2 text-destructive\">\n            <AlertTriangle className=\"h-5 w-5\" />\n            High Risk Customer Warning\n          </AlertDialogTitle>\n          <AlertDialogDescription className=\"space-y-4\">\n            <div className=\"p-4 bg-destructive/10 rounded-md border border-destructive/30\">\n              <div className=\"flex items-center gap-3 mb-3\">\n                <div className=\"w-10 h-10 rounded-full bg-destructive/20 flex items-center justify-center\">\n                  <Shield className=\"h-5 w-5 text-destructive\" />\n                </div>\n                <div>\n                  <p className=\"font-medium\">{customer.name}</p>\n                  <p className=\"text-sm text-muted-foreground\">{customer.phone}</p>\n                </div>\n              </div>\n\n              <div className=\"space-y-2 text-sm\">\n                <div className=\"flex items-center justify-between\">\n                  <span>Total Bookings</span>\n                  <Badge variant=\"secondary\">{customer.totalBookings}</Badge>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span>No-Shows</span>\n                  <Badge variant=\"destructive\">{customer.noShowCount}</Badge>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span>No-Show Rate</span>\n                  <Badge variant={noShowRate > 20 ? \"destructive\" : \"secondary\"}>\n                    {noShowRate}%\n                  </Badge>\n                </div>\n                {customer.isBlacklisted && (\n                  <div className=\"mt-2 p-2 bg-destructive/20 rounded text-destructive font-medium\">\n                    This customer is BLACKLISTED\n                  </div>\n                )}\n              </div>\n            </div>\n\n            <p className=\"text-sm\">\n              This customer has been flagged as high risk due to previous no-shows or\n              payment issues. Are you sure you want to proceed with this booking?\n            </p>\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel onClick={onCancel} data-testid=\"button-cancel-high-risk\">\n            Cancel Booking\n          </AlertDialogCancel>\n          <AlertDialogAction\n            onClick={onConfirm}\n            className=\"bg-destructive text-destructive-foreground\"\n            data-testid=\"button-confirm-high-risk\"\n          >\n            Proceed Anyway\n          </AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  );\n}\n\ninterface VipBadgeProps {\n  customer: Customer;\n  showLabel?: boolean;\n}\n\nexport function VipBadge({ customer, showLabel = true }: VipBadgeProps) {\n  const isVip = customer.tags?.includes(\"VIP\");\n  \n  if (!isVip) return null;\n\n  return (\n    <Badge className=\"bg-amber-500 text-white text-xs\">\n      {showLabel ? \"VIP Customer\" : \"VIP\"}\n    </Badge>\n  );\n}\n\nexport function CustomerRiskIndicator({ customer }: { customer: Customer }) {\n  const isHighRisk = customer.tags?.includes(\"HIGH_RISK\") || customer.isBlacklisted;\n  const isVip = customer.tags?.includes(\"VIP\");\n\n  if (isHighRisk) {\n    return (\n      <Badge variant=\"destructive\" className=\"text-xs\">\n        <AlertTriangle className=\"h-3 w-3 mr-1\" />\n        High Risk\n      </Badge>\n    );\n  }\n\n  if (isVip) {\n    return (\n      <Badge className=\"bg-amber-500 text-white text-xs\">\n        VIP\n      </Badge>\n    );\n  }\n\n  return null;\n}\n","path":null,"size_bytes":4554,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":710,"size_tokens":null},"client/src/pages/analytics.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  BarChart,\n  Bar,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer,\n  LineChart,\n  Line,\n  PieChart,\n  Pie,\n  Cell,\n} from \"recharts\";\nimport {\n  TrendingUp,\n  Users,\n  Calendar,\n  DollarSign,\n  Clock,\n  Target,\n} from \"lucide-react\";\nimport type { DashboardStats, Court, Booking, Customer } from \"@shared/schema\";\nimport { format, subDays, startOfDay, endOfDay, isWithinInterval } from \"date-fns\";\n\nfunction StatCard({\n  title,\n  value,\n  subtitle,\n  icon: Icon,\n  trend,\n  trendValue,\n}: {\n  title: string;\n  value: string | number;\n  subtitle?: string;\n  icon: React.ElementType;\n  trend?: \"up\" | \"down\";\n  trendValue?: string;\n}) {\n  return (\n    <Card>\n      <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n        <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n          {title}\n        </CardTitle>\n        <Icon className=\"h-4 w-4 text-muted-foreground\" />\n      </CardHeader>\n      <CardContent>\n        <div className=\"text-2xl font-bold\" data-testid={`analytics-${title.toLowerCase().replace(/\\s/g, '-')}`}>\n          {value}\n        </div>\n        {(subtitle || trend) && (\n          <p className={`text-xs mt-1 ${trend === \"up\" ? \"text-green-500\" : trend === \"down\" ? \"text-red-500\" : \"text-muted-foreground\"}`}>\n            {trend && `${trend === \"up\" ? \"+\" : \"-\"}${trendValue} `}\n            {subtitle}\n          </p>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n\nexport default function Analytics() {\n  const { data: stats, isLoading: statsLoading } = useQuery<DashboardStats>({\n    queryKey: [\"/api/stats/dashboard\"],\n  });\n\n  const { data: bookings, isLoading: bookingsLoading } = useQuery<Booking[]>({\n    queryKey: [\"/api/bookings\"],\n  });\n\n  const { data: customers, isLoading: customersLoading } = useQuery<Customer[]>({\n    queryKey: [\"/api/customers\"],\n  });\n\n  const { data: courts } = useQuery<Court[]>({\n    queryKey: [\"/api/courts\"],\n  });\n\n  const totalRevenue = bookings?.reduce(\n    (sum, b) => sum + Number(b.paidAmount),\n    0\n  ) || 0;\n\n  const averageBookingValue = bookings?.length\n    ? Math.round(totalRevenue / bookings.length)\n    : 0;\n\n  const completedBookings = bookings?.filter(\n    (b) => b.status === \"completed\" || b.status === \"checked_in\"\n  ).length || 0;\n\n  const noShowRate = bookings?.length\n    ? Math.round(\n        (bookings.filter((b) => b.status === \"no_show\").length / bookings.length) * 100\n      )\n    : 0;\n\n  const sportBreakdown = courts?.map((court) => ({\n    name: court.sport,\n    bookings: bookings?.filter((b) => b.courtId === court.id).length || 0,\n  })) || [];\n\n  const paymentMethodData = [\n    { name: \"Cash\", value: bookings?.filter((b) => b.paymentMethod === \"cash\").length || 0 },\n    { name: \"UPI\", value: bookings?.filter((b) => b.paymentMethod === \"upi\").length || 0 },\n    { name: \"Card\", value: bookings?.filter((b) => b.paymentMethod === \"card\").length || 0 },\n    { name: \"Online\", value: bookings?.filter((b) => b.paymentMethod === \"online\").length || 0 },\n  ].filter((d) => d.value > 0);\n\n  const COLORS = [\"hsl(var(--primary))\", \"hsl(var(--chart-2))\", \"hsl(var(--chart-3))\", \"hsl(var(--chart-4))\"];\n\n  const last7Days = Array.from({ length: 7 }, (_, i) => {\n    const date = subDays(new Date(), 6 - i);\n    const dateStr = format(date, \"yyyy-MM-dd\");\n    const dayBookings = bookings?.filter((b) => b.date === dateStr) || [];\n    return {\n      day: format(date, \"EEE\"),\n      bookings: dayBookings.length,\n      revenue: dayBookings.reduce((sum, b) => sum + Number(b.paidAmount), 0),\n    };\n  });\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-2xl font-semibold\">Analytics</h1>\n        <p className=\"text-muted-foreground text-sm\">\n          Track performance metrics and business insights\n        </p>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        {statsLoading || bookingsLoading ? (\n          <>\n            {[1, 2, 3, 4].map((i) => (\n              <Card key={i}>\n                <CardHeader className=\"pb-2\">\n                  <Skeleton className=\"h-4 w-24\" />\n                </CardHeader>\n                <CardContent>\n                  <Skeleton className=\"h-8 w-16\" />\n                </CardContent>\n              </Card>\n            ))}\n          </>\n        ) : (\n          <>\n            <StatCard\n              title=\"Total Revenue\"\n              value={`₹${totalRevenue.toLocaleString()}`}\n              icon={DollarSign}\n              trend=\"up\"\n              trendValue=\"12%\"\n              subtitle=\"vs last month\"\n            />\n            <StatCard\n              title=\"Total Bookings\"\n              value={bookings?.length || 0}\n              icon={Calendar}\n              trend=\"up\"\n              trendValue=\"8%\"\n              subtitle=\"vs last month\"\n            />\n            <StatCard\n              title=\"Average Booking\"\n              value={`₹${averageBookingValue}`}\n              icon={Target}\n              subtitle=\"per booking\"\n            />\n            <StatCard\n              title=\"Total Customers\"\n              value={customers?.length || 0}\n              icon={Users}\n              trend=\"up\"\n              trendValue=\"15%\"\n              subtitle=\"vs last month\"\n            />\n          </>\n        )}\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg\">Revenue Trend</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {bookingsLoading ? (\n              <Skeleton className=\"h-64 w-full\" />\n            ) : (\n              <ResponsiveContainer width=\"100%\" height={250}>\n                <LineChart data={last7Days}>\n                  <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\n                  <XAxis\n                    dataKey=\"day\"\n                    tick={{ fill: \"hsl(var(--muted-foreground))\", fontSize: 12 }}\n                  />\n                  <YAxis\n                    tick={{ fill: \"hsl(var(--muted-foreground))\", fontSize: 12 }}\n                  />\n                  <Tooltip\n                    contentStyle={{\n                      backgroundColor: \"hsl(var(--popover))\",\n                      border: \"1px solid hsl(var(--border))\",\n                      borderRadius: \"6px\",\n                    }}\n                  />\n                  <Line\n                    type=\"monotone\"\n                    dataKey=\"revenue\"\n                    stroke=\"hsl(var(--primary))\"\n                    strokeWidth={2}\n                    dot={{ fill: \"hsl(var(--primary))\" }}\n                  />\n                </LineChart>\n              </ResponsiveContainer>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg\">Bookings by Day</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {bookingsLoading ? (\n              <Skeleton className=\"h-64 w-full\" />\n            ) : (\n              <ResponsiveContainer width=\"100%\" height={250}>\n                <BarChart data={last7Days}>\n                  <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\n                  <XAxis\n                    dataKey=\"day\"\n                    tick={{ fill: \"hsl(var(--muted-foreground))\", fontSize: 12 }}\n                  />\n                  <YAxis\n                    tick={{ fill: \"hsl(var(--muted-foreground))\", fontSize: 12 }}\n                  />\n                  <Tooltip\n                    contentStyle={{\n                      backgroundColor: \"hsl(var(--popover))\",\n                      border: \"1px solid hsl(var(--border))\",\n                      borderRadius: \"6px\",\n                    }}\n                  />\n                  <Bar dataKey=\"bookings\" fill=\"hsl(var(--primary))\" radius={[4, 4, 0, 0]} />\n                </BarChart>\n              </ResponsiveContainer>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg\">Payment Methods</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {bookingsLoading ? (\n              <Skeleton className=\"h-48 w-full\" />\n            ) : paymentMethodData.length > 0 ? (\n              <ResponsiveContainer width=\"100%\" height={200}>\n                <PieChart>\n                  <Pie\n                    data={paymentMethodData}\n                    cx=\"50%\"\n                    cy=\"50%\"\n                    innerRadius={50}\n                    outerRadius={80}\n                    paddingAngle={2}\n                    dataKey=\"value\"\n                  >\n                    {paymentMethodData.map((_, index) => (\n                      <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                    ))}\n                  </Pie>\n                  <Tooltip\n                    contentStyle={{\n                      backgroundColor: \"hsl(var(--popover))\",\n                      border: \"1px solid hsl(var(--border))\",\n                      borderRadius: \"6px\",\n                    }}\n                  />\n                </PieChart>\n              </ResponsiveContainer>\n            ) : (\n              <div className=\"h-48 flex items-center justify-center text-muted-foreground\">\n                No payment data\n              </div>\n            )}\n            <div className=\"flex justify-center gap-4 mt-4\">\n              {paymentMethodData.map((method, i) => (\n                <div key={method.name} className=\"flex items-center gap-2 text-xs\">\n                  <div\n                    className=\"w-3 h-3 rounded\"\n                    style={{ backgroundColor: COLORS[i % COLORS.length] }}\n                  />\n                  <span>{method.name}</span>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg\">Performance Metrics</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"flex items-center justify-between p-3 bg-muted rounded-md\">\n              <div className=\"flex items-center gap-2\">\n                <TrendingUp className=\"h-4 w-4 text-green-500\" />\n                <span className=\"text-sm\">Completion Rate</span>\n              </div>\n              <Badge variant=\"secondary\">\n                {bookings?.length\n                  ? Math.round((completedBookings / bookings.length) * 100)\n                  : 0}\n                %\n              </Badge>\n            </div>\n            <div className=\"flex items-center justify-between p-3 bg-muted rounded-md\">\n              <div className=\"flex items-center gap-2\">\n                <Clock className=\"h-4 w-4 text-orange-500\" />\n                <span className=\"text-sm\">No-Show Rate</span>\n              </div>\n              <Badge variant=\"secondary\">{noShowRate}%</Badge>\n            </div>\n            <div className=\"flex items-center justify-between p-3 bg-muted rounded-md\">\n              <div className=\"flex items-center gap-2\">\n                <Users className=\"h-4 w-4 text-blue-500\" />\n                <span className=\"text-sm\">Repeat Customers</span>\n              </div>\n              <Badge variant=\"secondary\">\n                {customers?.filter((c) => c.totalBookings > 1).length || 0}\n              </Badge>\n            </div>\n            <div className=\"flex items-center justify-between p-3 bg-muted rounded-md\">\n              <div className=\"flex items-center gap-2\">\n                <DollarSign className=\"h-4 w-4 text-green-500\" />\n                <span className=\"text-sm\">Paid Rate</span>\n              </div>\n              <Badge variant=\"secondary\">\n                {bookings?.length\n                  ? Math.round(\n                      (bookings.filter((b) => b.paymentStatus === \"paid\").length /\n                        bookings.length) *\n                        100\n                    )\n                  : 0}\n                %\n              </Badge>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg\">Top Customers</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {customersLoading ? (\n              <div className=\"space-y-3\">\n                {[1, 2, 3, 4].map((i) => (\n                  <Skeleton key={i} className=\"h-12 w-full\" />\n                ))}\n              </div>\n            ) : (\n              <div className=\"space-y-3\">\n                {customers\n                  ?.sort((a, b) => Number(b.totalSpend) - Number(a.totalSpend))\n                  .slice(0, 5)\n                  .map((customer, i) => (\n                    <div\n                      key={customer.id}\n                      className=\"flex items-center gap-3 p-2 rounded-md bg-muted\"\n                    >\n                      <div className=\"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center text-xs font-medium\">\n                        {i + 1}\n                      </div>\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"text-sm font-medium truncate\">\n                          {customer.name}\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {customer.totalBookings} bookings\n                        </p>\n                      </div>\n                      <div className=\"text-sm font-medium\">\n                        ₹{Number(customer.totalSpend).toLocaleString()}\n                      </div>\n                    </div>\n                  )) || (\n                  <div className=\"text-center py-8 text-muted-foreground text-sm\">\n                    No customer data\n                  </div>\n                )}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":14308,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","path":null,"size_bytes":1904,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1077,"size_tokens":null},"client/src/lib/auth-utils.ts":{"content":"export function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}\n\n// Redirect to login with a toast notification\nexport function redirectToLogin(toast?: (options: { title: string; description: string; variant: string }) => void) {\n  if (toast) {\n    toast({\n      title: \"Unauthorized\",\n      description: \"You are logged out. Logging in again...\",\n      variant: \"destructive\",\n    });\n  }\n  setTimeout(() => {\n    window.location.href = \"/api/login\";\n  }, 500);\n}\n","path":null,"size_bytes":517,"size_tokens":null},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { WebSocketServer, WebSocket } from \"ws\";\nimport { storage } from \"./storage\";\nimport {\n  insertCourtSchema, insertCustomerSchema, insertBookingSchema,\n  insertTransactionSchema, insertWaitlistSchema, insertBlockedSlotSchema,\n  insertTournamentSchema, insertTournamentTeamSchema, insertExpenseSchema,\n  insertMembershipPlanSchema, insertMembershipSchema, insertLoyaltyPointsSchema,\n  type DashboardStats, type SettlementSummary,\n} from \"@shared/schema\";\n\nexport async function registerRoutes(\n  httpServer: Server,\n  app: Express\n): Promise<Server> {\n  // WebSocket setup for real-time updates\n  const wss = new WebSocketServer({ server: httpServer, path: \"/ws\" });\n  const clients = new Set<WebSocket>();\n\n  wss.on(\"connection\", (ws) => {\n    clients.add(ws);\n    ws.on(\"close\", () => clients.delete(ws));\n  });\n\n  const broadcast = (type: string, payload: unknown) => {\n    const message = JSON.stringify({ type, payload });\n    clients.forEach((client) => {\n      if (client.readyState === WebSocket.OPEN) {\n        client.send(message);\n      }\n    });\n  };\n\n  // WhatsApp notification stubs (integrate with WhatsApp Business API in production)\n  // Using WhatsApp instead of email/SMS per requirements\n  const sendWhatsAppNotification = async (phone: string, template: string, data: Record<string, unknown>) => {\n    // Stub: In production, integrate with WhatsApp Business API or Twilio WhatsApp\n    console.log(`[WhatsApp Notification] To: ${phone}, Template: ${template}`, data);\n    \n    // Return mock response for now\n    return {\n      success: true,\n      messageId: `wa_${Date.now()}`,\n      template,\n      phone,\n    };\n  };\n\n  const sendBookingConfirmation = async (phone: string, bookingDetails: {\n    bookingId: string;\n    date: string;\n    startTime: string;\n    endTime: string;\n    courtName?: string;\n    amount: number;\n    qrCode?: string;\n  }) => {\n    return sendWhatsAppNotification(phone, \"booking_confirmation\", {\n      ...bookingDetails,\n      message: `Your booking is confirmed for ${bookingDetails.date} at ${bookingDetails.startTime}. Your booking ID: ${bookingDetails.bookingId.slice(0, 8).toUpperCase()}`,\n    });\n  };\n\n  const sendPaymentReminder = async (phone: string, paymentDetails: {\n    bookingId: string;\n    amount: number;\n    dueDate: string;\n    paymentLink?: string;\n  }) => {\n    return sendWhatsAppNotification(phone, \"payment_reminder\", {\n      ...paymentDetails,\n      message: `Payment reminder: ₹${paymentDetails.amount} due for booking #${paymentDetails.bookingId.slice(0, 8).toUpperCase()}`,\n    });\n  };\n\n  const sendSlotReminder = async (phone: string, reminderDetails: {\n    bookingId: string;\n    date: string;\n    startTime: string;\n    courtName?: string;\n  }) => {\n    return sendWhatsAppNotification(phone, \"slot_reminder\", {\n      ...reminderDetails,\n      message: `Reminder: Your slot is coming up in 1 hour at ${reminderDetails.startTime}`,\n    });\n  };\n\n  const sendWaitlistNotification = async (phone: string, slotDetails: {\n    courtName: string;\n    date: string;\n    startTime: string;\n    endTime: string;\n  }) => {\n    return sendWhatsAppNotification(phone, \"waitlist_available\", {\n      ...slotDetails,\n      message: `Good news! A slot is now available on ${slotDetails.date} at ${slotDetails.startTime}. Book now before it's gone!`,\n    });\n  };\n\n  const sendNoShowWarning = async (phone: string, noShowCount: number) => {\n    let warningLevel = \"warning\";\n    let consequence = \"\";\n    \n    if (noShowCount >= 5) {\n      warningLevel = \"blacklisted\";\n      consequence = \"Your account has been restricted due to multiple no-shows.\";\n    } else if (noShowCount >= 3) {\n      warningLevel = \"high_risk\";\n      consequence = `You have ${5 - noShowCount} more no-shows before your account is restricted.`;\n    } else {\n      consequence = \"Please make sure to show up for your future bookings.\";\n    }\n    \n    return sendWhatsAppNotification(phone, \"no_show_warning\", {\n      noShowCount,\n      warningLevel,\n      message: `Notice: You have ${noShowCount} recorded no-show(s). ${consequence}`,\n    });\n  };\n\n  // Dashboard stats\n  app.get(\"/api/stats/dashboard\", async (req, res) => {\n    try {\n      const today = new Date().toISOString().split(\"T\")[0];\n      const [allBookings, courts, customers] = await Promise.all([\n        storage.getBookings(),\n        storage.getCourts(),\n        storage.getCustomers(),\n      ]);\n\n      const todayBookings = allBookings.filter((b) => b.date === today);\n      const todayRevenue = todayBookings.reduce((sum, b) => sum + Number(b.paidAmount || 0), 0);\n      const pendingCheckIns = todayBookings.filter((b) => b.status === \"confirmed\").length;\n      const pendingPayments = allBookings.filter((b) => b.paymentStatus === \"pending\" || b.paymentStatus === \"partial\").length;\n\n      // Weekly revenue\n      const weeklyRevenue = [];\n      const days = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n      for (let i = 6; i >= 0; i--) {\n        const date = new Date();\n        date.setDate(date.getDate() - i);\n        const dateStr = date.toISOString().split(\"T\")[0];\n        const dayBookings = allBookings.filter((b) => b.date === dateStr);\n        const revenue = dayBookings.reduce((sum, b) => sum + Number(b.paidAmount || 0), 0);\n        weeklyRevenue.push({ day: days[date.getDay()], revenue });\n      }\n\n      const stats: DashboardStats = {\n        totalBookingsToday: todayBookings.length,\n        totalRevenueToday: todayRevenue,\n        occupiedCourts: courts.filter((c) => c.isActive).length,\n        totalCourts: courts.length,\n        pendingCheckIns,\n        pendingPayments,\n        weeklyRevenue,\n        peakHours: [],\n      };\n\n      res.json(stats);\n    } catch (error) {\n      console.error(\"Error getting dashboard stats:\", error);\n      res.status(500).json({ message: \"Failed to get dashboard stats\" });\n    }\n  });\n\n  // Courts\n  app.get(\"/api/courts\", async (req, res) => {\n    try {\n      const courts = await storage.getCourts();\n      res.json(courts);\n    } catch (error) {\n      console.error(\"Error getting courts:\", error);\n      res.status(500).json({ message: \"Failed to get courts\" });\n    }\n  });\n\n  app.post(\"/api/courts\", async (req, res) => {\n    try {\n      const result = insertCourtSchema.safeParse(req.body);\n      if (!result.success) {\n        return res.status(400).json({ message: result.error.message });\n      }\n      const court = await storage.createCourt(result.data);\n      broadcast(\"court_created\", court);\n      res.status(201).json(court);\n    } catch (error) {\n      console.error(\"Error creating court:\", error);\n      res.status(500).json({ message: \"Failed to create court\" });\n    }\n  });\n\n  app.patch(\"/api/courts/:id\", async (req, res) => {\n    try {\n      const court = await storage.updateCourt(req.params.id, req.body);\n      if (!court) {\n        return res.status(404).json({ message: \"Court not found\" });\n      }\n      broadcast(\"court_updated\", court);\n      res.json(court);\n    } catch (error) {\n      console.error(\"Error updating court:\", error);\n      res.status(500).json({ message: \"Failed to update court\" });\n    }\n  });\n\n  app.delete(\"/api/courts/:id\", async (req, res) => {\n    try {\n      await storage.deleteCourt(req.params.id);\n      broadcast(\"court_deleted\", { id: req.params.id });\n      res.status(204).send();\n    } catch (error) {\n      console.error(\"Error deleting court:\", error);\n      res.status(500).json({ message: \"Failed to delete court\" });\n    }\n  });\n\n  // Customers\n  app.get(\"/api/customers\", async (req, res) => {\n    try {\n      const customers = await storage.getCustomers();\n      res.json(customers);\n    } catch (error) {\n      console.error(\"Error getting customers:\", error);\n      res.status(500).json({ message: \"Failed to get customers\" });\n    }\n  });\n\n  app.get(\"/api/customers/:id\", async (req, res) => {\n    try {\n      const customer = await storage.getCustomer(req.params.id);\n      if (!customer) {\n        return res.status(404).json({ message: \"Customer not found\" });\n      }\n      res.json(customer);\n    } catch (error) {\n      console.error(\"Error getting customer:\", error);\n      res.status(500).json({ message: \"Failed to get customer\" });\n    }\n  });\n\n  app.post(\"/api/customers\", async (req, res) => {\n    try {\n      const result = insertCustomerSchema.safeParse(req.body);\n      if (!result.success) {\n        return res.status(400).json({ message: result.error.message });\n      }\n      \n      // Check if customer with phone already exists\n      const existing = await storage.getCustomerByPhone(result.data.phone);\n      if (existing) {\n        return res.status(409).json({ message: \"Customer with this phone already exists\" });\n      }\n      \n      const customer = await storage.createCustomer(result.data);\n      broadcast(\"customer_created\", customer);\n      res.status(201).json(customer);\n    } catch (error) {\n      console.error(\"Error creating customer:\", error);\n      res.status(500).json({ message: \"Failed to create customer\" });\n    }\n  });\n\n  app.patch(\"/api/customers/:id\", async (req, res) => {\n    try {\n      const customer = await storage.updateCustomer(req.params.id, req.body);\n      if (!customer) {\n        return res.status(404).json({ message: \"Customer not found\" });\n      }\n      broadcast(\"customer_updated\", customer);\n      res.json(customer);\n    } catch (error) {\n      console.error(\"Error updating customer:\", error);\n      res.status(500).json({ message: \"Failed to update customer\" });\n    }\n  });\n\n  // Bookings\n  app.get(\"/api/bookings\", async (req, res) => {\n    try {\n      const { date } = req.query;\n      const bookings = date \n        ? await storage.getBookingsByDate(date as string)\n        : await storage.getBookings();\n      res.json(bookings);\n    } catch (error) {\n      console.error(\"Error getting bookings:\", error);\n      res.status(500).json({ message: \"Failed to get bookings\" });\n    }\n  });\n\n  app.get(\"/api/bookings/:id\", async (req, res) => {\n    try {\n      const booking = await storage.getBooking(req.params.id);\n      if (!booking) {\n        return res.status(404).json({ message: \"Booking not found\" });\n      }\n      res.json(booking);\n    } catch (error) {\n      console.error(\"Error getting booking:\", error);\n      res.status(500).json({ message: \"Failed to get booking\" });\n    }\n  });\n\n  app.post(\"/api/bookings\", async (req, res) => {\n    try {\n      const result = insertBookingSchema.safeParse(req.body);\n      if (!result.success) {\n        return res.status(400).json({ message: result.error.message });\n      }\n      \n      // Calculate duration if not provided\n      const data = { ...result.data };\n      if (!data.duration && data.startTime && data.endTime) {\n        const [startHour, startMin] = data.startTime.split(\":\").map(Number);\n        const [endHour, endMin] = data.endTime.split(\":\").map(Number);\n        data.duration = (endHour * 60 + endMin) - (startHour * 60 + startMin);\n      }\n      \n      const booking = await storage.createBooking(data);\n      \n      // Create transaction if payment was made\n      if (data.paidAmount && Number(data.paidAmount) > 0) {\n        await storage.createTransaction({\n          bookingId: booking.id,\n          customerId: booking.customerId,\n          type: \"booking_payment\",\n          amount: data.paidAmount,\n          paymentMethod: data.paymentMethod || \"cash\",\n          status: \"completed\",\n        });\n      }\n      \n      // Send WhatsApp booking confirmation\n      const customer = await storage.getCustomer(booking.customerId);\n      if (customer?.phone) {\n        await sendBookingConfirmation(customer.phone, {\n          bookingId: booking.id,\n          date: booking.date,\n          startTime: booking.startTime,\n          endTime: booking.endTime,\n          amount: Number(booking.totalAmount),\n          qrCode: booking.qrCode || undefined,\n        });\n      }\n      \n      broadcast(\"booking_created\", booking);\n      res.status(201).json(booking);\n    } catch (error) {\n      console.error(\"Error creating booking:\", error);\n      res.status(500).json({ message: \"Failed to create booking\" });\n    }\n  });\n\n  app.patch(\"/api/bookings/:id\", async (req, res) => {\n    try {\n      const booking = await storage.updateBooking(req.params.id, req.body);\n      if (!booking) {\n        return res.status(404).json({ message: \"Booking not found\" });\n      }\n      broadcast(\"booking_updated\", booking);\n      res.json(booking);\n    } catch (error) {\n      console.error(\"Error updating booking:\", error);\n      res.status(500).json({ message: \"Failed to update booking\" });\n    }\n  });\n\n  app.delete(\"/api/bookings/:id\", async (req, res) => {\n    try {\n      await storage.deleteBooking(req.params.id);\n      broadcast(\"booking_deleted\", { id: req.params.id });\n      res.status(204).send();\n    } catch (error) {\n      console.error(\"Error deleting booking:\", error);\n      res.status(500).json({ message: \"Failed to delete booking\" });\n    }\n  });\n\n  // No-show tracking endpoint\n  app.post(\"/api/bookings/:id/no-show\", async (req, res) => {\n    try {\n      const booking = await storage.getBooking(req.params.id);\n      if (!booking) {\n        return res.status(404).json({ message: \"Booking not found\" });\n      }\n      \n      if (booking.status === \"no_show\") {\n        return res.status(400).json({ message: \"Booking already marked as no-show\" });\n      }\n      \n      // Validate customer exists - bookings must have valid customers for tracking\n      const customer = await storage.getCustomer(booking.customerId);\n      if (!customer) {\n        // Still mark booking as no-show even if customer is missing\n        const updatedBooking = await storage.updateBooking(req.params.id, { status: \"no_show\" });\n        broadcast(\"booking_updated\", updatedBooking);\n        return res.json({ \n          booking: updatedBooking, \n          noShowCount: 0,\n          isHighRisk: false,\n          isBlacklisted: false,\n          warning: \"Customer record not found - no-show tracking not applied\",\n        });\n      }\n      \n      // Update booking status to no_show\n      const updatedBooking = await storage.updateBooking(req.params.id, { status: \"no_show\" });\n      \n      // Calculate new metrics\n      const newNoShowCount = customer.noShowCount + 1;\n      const updatedTags = [...new Set([...customer.tags])];\n      \n      // Auto-tag HIGH_RISK after 3 no-shows\n      const isHighRisk = newNoShowCount >= 3;\n      if (isHighRisk && !updatedTags.includes(\"HIGH_RISK\")) {\n        updatedTags.push(\"HIGH_RISK\");\n      }\n      \n      // Auto-blacklist after 5 no-shows\n      const isBlacklisted = newNoShowCount >= 5;\n      const shouldBlacklist = isBlacklisted || customer.isBlacklisted;\n      \n      // Update customer with new metrics\n      const updatedCustomer = await storage.updateCustomer(booking.customerId, { \n        noShowCount: newNoShowCount,\n        tags: updatedTags,\n        isBlacklisted: shouldBlacklist,\n      });\n      \n      if (updatedCustomer) {\n        broadcast(\"customer_updated\", updatedCustomer);\n      }\n      \n      // Send warning for repeat offenders\n      if (newNoShowCount >= 2 && customer.phone) {\n        await sendNoShowWarning(customer.phone, newNoShowCount);\n      }\n      \n      broadcast(\"booking_updated\", updatedBooking);\n      res.json({ \n        booking: updatedBooking, \n        noShowCount: newNoShowCount,\n        isHighRisk,\n        isBlacklisted,\n        customerName: customer.name,\n      });\n    } catch (error) {\n      console.error(\"Error marking no-show:\", error);\n      res.status(500).json({ message: \"Failed to mark no-show\" });\n    }\n  });\n\n  // Get no-show analytics\n  app.get(\"/api/analytics/no-shows\", async (req, res) => {\n    try {\n      const bookings = await storage.getBookings();\n      const customers = await storage.getCustomers();\n      \n      const noShowBookings = bookings.filter(b => b.status === \"no_show\");\n      const highRiskCustomers = customers.filter(c => c.noShowCount >= 3 || c.tags.includes(\"HIGH_RISK\"));\n      const repeatOffenders = customers.filter(c => c.noShowCount >= 2);\n      const blacklistedCustomers = customers.filter(c => c.isBlacklisted);\n      \n      // Calculate no-show rate\n      const completedOrNoShow = bookings.filter(b => \n        b.status === \"completed\" || b.status === \"no_show\" || b.status === \"checked_in\"\n      );\n      const noShowRate = completedOrNoShow.length > 0 \n        ? (noShowBookings.length / completedOrNoShow.length) * 100 \n        : 0;\n      \n      // Revenue lost to no-shows\n      const revenueLost = noShowBookings.reduce((sum, b) => sum + Number(b.totalAmount), 0);\n      \n      res.json({\n        totalNoShows: noShowBookings.length,\n        noShowRate: Number(noShowRate.toFixed(1)),\n        revenueLost,\n        highRiskCount: highRiskCustomers.length,\n        repeatOffendersCount: repeatOffenders.length,\n        blacklistedCount: blacklistedCustomers.length,\n        recentNoShows: noShowBookings.slice(-10).reverse(),\n        repeatOffenders: repeatOffenders.map(c => ({\n          id: c.id,\n          name: c.name,\n          phone: c.phone,\n          noShowCount: c.noShowCount,\n          isBlacklisted: c.isBlacklisted,\n          tags: c.tags,\n        })),\n      });\n    } catch (error) {\n      console.error(\"Error getting no-show analytics:\", error);\n      res.status(500).json({ message: \"Failed to get no-show analytics\" });\n    }\n  });\n\n  // Transactions\n  app.get(\"/api/transactions\", async (req, res) => {\n    try {\n      const transactions = await storage.getTransactions();\n      res.json(transactions);\n    } catch (error) {\n      console.error(\"Error getting transactions:\", error);\n      res.status(500).json({ message: \"Failed to get transactions\" });\n    }\n  });\n\n  app.post(\"/api/transactions\", async (req, res) => {\n    try {\n      const result = insertTransactionSchema.safeParse(req.body);\n      if (!result.success) {\n        return res.status(400).json({ message: result.error.message });\n      }\n      const transaction = await storage.createTransaction(result.data);\n      broadcast(\"transaction_created\", transaction);\n      res.status(201).json(transaction);\n    } catch (error) {\n      console.error(\"Error creating transaction:\", error);\n      res.status(500).json({ message: \"Failed to create transaction\" });\n    }\n  });\n\n  // Settlements\n  app.get(\"/api/settlements\", async (req, res) => {\n    try {\n      const settlements = await storage.getSettlements();\n      res.json(settlements);\n    } catch (error) {\n      console.error(\"Error getting settlements:\", error);\n      res.status(500).json({ message: \"Failed to get settlements\" });\n    }\n  });\n\n  app.get(\"/api/settlements/summary\", async (req, res) => {\n    try {\n      const settlements = await storage.getSettlements();\n      const transactions = await storage.getTransactions();\n      \n      const cashTransactions = transactions.filter(\n        (t) => t.paymentMethod === \"cash\" && t.type === \"booking_payment\"\n      );\n      const totalCashReceived = cashTransactions.reduce((sum, t) => sum + Number(t.amount), 0);\n      const commissionRate = 5;\n      const totalCommission = Math.round(totalCashReceived * (commissionRate / 100));\n      \n      const totalSettled = settlements\n        .filter((s) => s.status === \"paid\")\n        .reduce((sum, s) => sum + Number(s.amount), 0);\n      \n      const summary: SettlementSummary = {\n        totalEarnings: totalCashReceived,\n        totalSettled,\n        amountDue: totalCommission - totalSettled,\n        commissionRate,\n        pendingSettlements: settlements.filter((s) => s.status === \"pending\"),\n      };\n      \n      res.json(summary);\n    } catch (error) {\n      console.error(\"Error getting settlement summary:\", error);\n      res.status(500).json({ message: \"Failed to get settlement summary\" });\n    }\n  });\n\n  // Waitlist\n  app.get(\"/api/waitlist\", async (req, res) => {\n    try {\n      const waitlistItems = await storage.getWaitlist();\n      res.json(waitlistItems);\n    } catch (error) {\n      console.error(\"Error getting waitlist:\", error);\n      res.status(500).json({ message: \"Failed to get waitlist\" });\n    }\n  });\n\n  app.post(\"/api/waitlist\", async (req, res) => {\n    try {\n      const result = insertWaitlistSchema.safeParse(req.body);\n      if (!result.success) {\n        return res.status(400).json({ message: result.error.message });\n      }\n      const item = await storage.createWaitlistItem(result.data);\n      broadcast(\"waitlist_created\", item);\n      res.status(201).json(item);\n    } catch (error) {\n      console.error(\"Error creating waitlist item:\", error);\n      res.status(500).json({ message: \"Failed to create waitlist item\" });\n    }\n  });\n\n  app.patch(\"/api/waitlist/:id\", async (req, res) => {\n    try {\n      const item = await storage.updateWaitlistItem(req.params.id, req.body);\n      if (!item) {\n        return res.status(404).json({ message: \"Waitlist item not found\" });\n      }\n      broadcast(\"waitlist_updated\", item);\n      res.json(item);\n    } catch (error) {\n      console.error(\"Error updating waitlist item:\", error);\n      res.status(500).json({ message: \"Failed to update waitlist item\" });\n    }\n  });\n\n  // Blocked Slots\n  app.get(\"/api/blocked-slots\", async (req, res) => {\n    try {\n      const blockedSlots = await storage.getBlockedSlots();\n      res.json(blockedSlots);\n    } catch (error) {\n      console.error(\"Error getting blocked slots:\", error);\n      res.status(500).json({ message: \"Failed to get blocked slots\" });\n    }\n  });\n\n  app.post(\"/api/blocked-slots\", async (req, res) => {\n    try {\n      const result = insertBlockedSlotSchema.safeParse(req.body);\n      if (!result.success) {\n        return res.status(400).json({ message: result.error.message });\n      }\n      const slot = await storage.createBlockedSlot(result.data);\n      broadcast(\"blocked_slot_created\", slot);\n      res.status(201).json(slot);\n    } catch (error) {\n      console.error(\"Error creating blocked slot:\", error);\n      res.status(500).json({ message: \"Failed to create blocked slot\" });\n    }\n  });\n\n  app.delete(\"/api/blocked-slots/:id\", async (req, res) => {\n    try {\n      await storage.deleteBlockedSlot(req.params.id);\n      broadcast(\"blocked_slot_deleted\", { id: req.params.id });\n      res.status(204).send();\n    } catch (error) {\n      console.error(\"Error deleting blocked slot:\", error);\n      res.status(500).json({ message: \"Failed to delete blocked slot\" });\n    }\n  });\n\n  // Tournaments\n  app.get(\"/api/tournaments\", async (req, res) => {\n    try {\n      const tournaments = await storage.getTournaments();\n      res.json(tournaments);\n    } catch (error) {\n      console.error(\"Error getting tournaments:\", error);\n      res.status(500).json({ message: \"Failed to get tournaments\" });\n    }\n  });\n\n  app.get(\"/api/tournaments/:id\", async (req, res) => {\n    try {\n      const tournament = await storage.getTournament(req.params.id);\n      if (!tournament) {\n        return res.status(404).json({ message: \"Tournament not found\" });\n      }\n      res.json(tournament);\n    } catch (error) {\n      console.error(\"Error getting tournament:\", error);\n      res.status(500).json({ message: \"Failed to get tournament\" });\n    }\n  });\n\n  app.post(\"/api/tournaments\", async (req, res) => {\n    try {\n      const result = insertTournamentSchema.safeParse(req.body);\n      if (!result.success) {\n        return res.status(400).json({ message: result.error.message });\n      }\n      const tournament = await storage.createTournament(result.data);\n      broadcast(\"tournament_created\", tournament);\n      res.status(201).json(tournament);\n    } catch (error) {\n      console.error(\"Error creating tournament:\", error);\n      res.status(500).json({ message: \"Failed to create tournament\" });\n    }\n  });\n\n  app.patch(\"/api/tournaments/:id\", async (req, res) => {\n    try {\n      const tournament = await storage.updateTournament(req.params.id, req.body);\n      if (!tournament) {\n        return res.status(404).json({ message: \"Tournament not found\" });\n      }\n      broadcast(\"tournament_updated\", tournament);\n      res.json(tournament);\n    } catch (error) {\n      console.error(\"Error updating tournament:\", error);\n      res.status(500).json({ message: \"Failed to update tournament\" });\n    }\n  });\n\n  // Tournament Teams\n  app.get(\"/api/tournaments/:id/teams\", async (req, res) => {\n    try {\n      const teams = await storage.getTournamentTeams(req.params.id);\n      res.json(teams);\n    } catch (error) {\n      console.error(\"Error getting tournament teams:\", error);\n      res.status(500).json({ message: \"Failed to get tournament teams\" });\n    }\n  });\n\n  app.post(\"/api/tournaments/:id/teams\", async (req, res) => {\n    try {\n      const result = insertTournamentTeamSchema.safeParse({\n        ...req.body,\n        tournamentId: req.params.id,\n      });\n      if (!result.success) {\n        return res.status(400).json({ message: result.error.message });\n      }\n      const team = await storage.createTournamentTeam(result.data);\n      broadcast(\"tournament_team_created\", team);\n      res.status(201).json(team);\n    } catch (error) {\n      console.error(\"Error creating tournament team:\", error);\n      res.status(500).json({ message: \"Failed to create tournament team\" });\n    }\n  });\n\n  // Expenses\n  app.get(\"/api/expenses\", async (req, res) => {\n    try {\n      const expenses = await storage.getExpenses();\n      res.json(expenses);\n    } catch (error) {\n      console.error(\"Error getting expenses:\", error);\n      res.status(500).json({ message: \"Failed to get expenses\" });\n    }\n  });\n\n  app.post(\"/api/expenses\", async (req, res) => {\n    try {\n      const result = insertExpenseSchema.safeParse(req.body);\n      if (!result.success) {\n        return res.status(400).json({ message: result.error.message });\n      }\n      const expense = await storage.createExpense(result.data);\n      broadcast(\"expense_created\", expense);\n      res.status(201).json(expense);\n    } catch (error) {\n      console.error(\"Error creating expense:\", error);\n      res.status(500).json({ message: \"Failed to create expense\" });\n    }\n  });\n\n  app.delete(\"/api/expenses/:id\", async (req, res) => {\n    try {\n      await storage.deleteExpense(req.params.id);\n      broadcast(\"expense_deleted\", { id: req.params.id });\n      res.status(204).send();\n    } catch (error) {\n      console.error(\"Error deleting expense:\", error);\n      res.status(500).json({ message: \"Failed to delete expense\" });\n    }\n  });\n\n  // Maintenance Logs\n  app.get(\"/api/maintenance\", async (req, res) => {\n    try {\n      const logs = await storage.getMaintenanceLogs();\n      res.json(logs);\n    } catch (error) {\n      console.error(\"Error getting maintenance logs:\", error);\n      res.status(500).json({ message: \"Failed to get maintenance logs\" });\n    }\n  });\n\n  // Helper to check if user has owner role\n  const requireOwnerRole = async (req: any, res: any, next: any) => {\n    if (!req.isAuthenticated?.() || !req.user?.claims?.sub) {\n      return res.status(401).json({ message: \"Unauthorized\" });\n    }\n    const currentUser = await storage.getUser(req.user.claims.sub);\n    if (!currentUser || currentUser.role !== \"owner\") {\n      return res.status(403).json({ message: \"Forbidden - Owner access required\" });\n    }\n    next();\n  };\n\n  // Staff Management (RBAC) - Owner only\n  app.get(\"/api/staff\", requireOwnerRole, async (req, res) => {\n    try {\n      const staff = await storage.getStaff();\n      res.json(staff);\n    } catch (error) {\n      console.error(\"Error getting staff:\", error);\n      res.status(500).json({ message: \"Failed to get staff\" });\n    }\n  });\n\n  app.patch(\"/api/staff/:id/role\", requireOwnerRole, async (req, res) => {\n    try {\n      const { role } = req.body;\n      if (!role || ![\"owner\", \"manager\", \"receptionist\"].includes(role)) {\n        return res.status(400).json({ message: \"Invalid role\" });\n      }\n      const updatedUser = await storage.updateStaffRole(req.params.id, role);\n      if (!updatedUser) {\n        return res.status(404).json({ message: \"Staff member not found\" });\n      }\n      broadcast(\"staff_role_updated\", updatedUser);\n      res.json(updatedUser);\n    } catch (error) {\n      console.error(\"Error updating staff role:\", error);\n      res.status(500).json({ message: \"Failed to update staff role\" });\n    }\n  });\n\n  // ========== Membership Plans (Owner only) ==========\n  app.get(\"/api/membership-plans\", async (req, res) => {\n    try {\n      const plans = await storage.getMembershipPlans();\n      res.json(plans);\n    } catch (error) {\n      console.error(\"Error getting membership plans:\", error);\n      res.status(500).json({ message: \"Failed to get membership plans\" });\n    }\n  });\n\n  app.post(\"/api/membership-plans\", requireOwnerRole, async (req, res) => {\n    try {\n      const result = insertMembershipPlanSchema.safeParse(req.body);\n      if (!result.success) {\n        return res.status(400).json({ message: result.error.message });\n      }\n      const plan = await storage.createMembershipPlan(result.data);\n      broadcast(\"membership_plan_created\", plan);\n      res.status(201).json(plan);\n    } catch (error) {\n      console.error(\"Error creating membership plan:\", error);\n      res.status(500).json({ message: \"Failed to create membership plan\" });\n    }\n  });\n\n  app.patch(\"/api/membership-plans/:id\", requireOwnerRole, async (req, res) => {\n    try {\n      const plan = await storage.updateMembershipPlan(req.params.id, req.body);\n      if (!plan) {\n        return res.status(404).json({ message: \"Membership plan not found\" });\n      }\n      broadcast(\"membership_plan_updated\", plan);\n      res.json(plan);\n    } catch (error) {\n      console.error(\"Error updating membership plan:\", error);\n      res.status(500).json({ message: \"Failed to update membership plan\" });\n    }\n  });\n\n  app.delete(\"/api/membership-plans/:id\", requireOwnerRole, async (req, res) => {\n    try {\n      await storage.deleteMembershipPlan(req.params.id);\n      broadcast(\"membership_plan_deleted\", { id: req.params.id });\n      res.status(204).send();\n    } catch (error) {\n      console.error(\"Error deleting membership plan:\", error);\n      res.status(500).json({ message: \"Failed to delete membership plan\" });\n    }\n  });\n\n  // ========== Customer Memberships ==========\n  app.get(\"/api/memberships\", async (req, res) => {\n    try {\n      const allMemberships = await storage.getMemberships();\n      // Enrich with plan details\n      const plans = await storage.getMembershipPlans();\n      const planMap = new Map(plans.map(p => [p.id, p]));\n      \n      const enriched = allMemberships.map(m => ({\n        ...m,\n        plan: planMap.get(m.planId),\n      }));\n      res.json(enriched);\n    } catch (error) {\n      console.error(\"Error getting memberships:\", error);\n      res.status(500).json({ message: \"Failed to get memberships\" });\n    }\n  });\n\n  app.get(\"/api/customers/:customerId/membership\", async (req, res) => {\n    try {\n      const membership = await storage.getActiveMembership(req.params.customerId);\n      if (!membership) {\n        return res.json(null);\n      }\n      const plan = await storage.getMembershipPlan(membership.planId);\n      res.json({ ...membership, plan });\n    } catch (error) {\n      console.error(\"Error getting customer membership:\", error);\n      res.status(500).json({ message: \"Failed to get customer membership\" });\n    }\n  });\n\n  app.post(\"/api/memberships\", async (req, res) => {\n    try {\n      const result = insertMembershipSchema.safeParse(req.body);\n      if (!result.success) {\n        return res.status(400).json({ message: result.error.message });\n      }\n      \n      // Check if customer exists\n      const customer = await storage.getCustomer(result.data.customerId);\n      if (!customer) {\n        return res.status(404).json({ message: \"Customer not found\" });\n      }\n      \n      // Check if plan exists\n      const plan = await storage.getMembershipPlan(result.data.planId);\n      if (!plan) {\n        return res.status(404).json({ message: \"Membership plan not found\" });\n      }\n      \n      const membership = await storage.createMembership(result.data);\n      \n      // Add VIP tag to customer if not already present\n      if (!customer.tags.includes(\"VIP\")) {\n        const updatedCustomer = await storage.updateCustomer(customer.id, {\n          tags: [...customer.tags, \"VIP\"],\n        });\n        if (updatedCustomer) {\n          broadcast(\"customer_updated\", updatedCustomer);\n        }\n      }\n      \n      // Award loyalty points for joining membership (10 points per 100 spent)\n      const pointsEarned = Math.floor(Number(result.data.paidAmount) / 100) * 10;\n      if (pointsEarned > 0) {\n        const loyaltyRecord = await storage.createLoyaltyPoints({\n          customerId: result.data.customerId,\n          type: \"earned\",\n          points: pointsEarned,\n          description: `Membership purchase: ${plan.name}`,\n        });\n        broadcast(\"loyalty_earned\", { ...loyaltyRecord, balance: pointsEarned });\n      }\n      \n      broadcast(\"membership_created\", { ...membership, plan });\n      res.status(201).json({ ...membership, plan, pointsEarned });\n    } catch (error) {\n      console.error(\"Error creating membership:\", error);\n      res.status(500).json({ message: \"Failed to create membership\" });\n    }\n  });\n\n  app.patch(\"/api/memberships/:id\", async (req, res) => {\n    try {\n      const membership = await storage.updateMembership(req.params.id, req.body);\n      if (!membership) {\n        return res.status(404).json({ message: \"Membership not found\" });\n      }\n      broadcast(\"membership_updated\", membership);\n      res.json(membership);\n    } catch (error) {\n      console.error(\"Error updating membership:\", error);\n      res.status(500).json({ message: \"Failed to update membership\" });\n    }\n  });\n\n  // ========== Loyalty Points ==========\n  app.get(\"/api/customers/:customerId/loyalty\", async (req, res) => {\n    try {\n      const points = await storage.getLoyaltyPoints(req.params.customerId);\n      const balance = await storage.getCustomerPointsBalance(req.params.customerId);\n      \n      // Calculate stats\n      const earned = points.filter(p => p.type === \"earned\").reduce((sum, p) => sum + p.points, 0);\n      const redeemed = points.filter(p => p.type === \"redeemed\").reduce((sum, p) => sum + Math.abs(p.points), 0);\n      \n      res.json({\n        balance,\n        lifetimeEarned: earned,\n        lifetimeRedeemed: redeemed,\n        history: points.slice(0, 20), // Last 20 transactions\n      });\n    } catch (error) {\n      console.error(\"Error getting customer loyalty:\", error);\n      res.status(500).json({ message: \"Failed to get loyalty points\" });\n    }\n  });\n\n  app.post(\"/api/customers/:customerId/loyalty/earn\", async (req, res) => {\n    try {\n      const { points, description, bookingId } = req.body;\n      if (!points || points <= 0) {\n        return res.status(400).json({ message: \"Points must be positive\" });\n      }\n      \n      const pointsRecord = await storage.createLoyaltyPoints({\n        customerId: req.params.customerId,\n        type: \"earned\",\n        points,\n        description: description || \"Points earned\",\n        bookingId,\n      });\n      \n      const balance = await storage.getCustomerPointsBalance(req.params.customerId);\n      broadcast(\"loyalty_earned\", { ...pointsRecord, balance });\n      res.status(201).json({ ...pointsRecord, balance });\n    } catch (error) {\n      console.error(\"Error earning loyalty points:\", error);\n      res.status(500).json({ message: \"Failed to earn loyalty points\" });\n    }\n  });\n\n  app.post(\"/api/customers/:customerId/loyalty/redeem\", async (req, res) => {\n    try {\n      const { points, description } = req.body;\n      if (!points || points <= 0) {\n        return res.status(400).json({ message: \"Points must be positive\" });\n      }\n      \n      // Check balance\n      const balance = await storage.getCustomerPointsBalance(req.params.customerId);\n      if (balance < points) {\n        return res.status(400).json({ message: `Insufficient points. Available: ${balance}` });\n      }\n      \n      const pointsRecord = await storage.createLoyaltyPoints({\n        customerId: req.params.customerId,\n        type: \"redeemed\",\n        points: -points, // Negative for redemption\n        description: description || \"Points redeemed\",\n      });\n      \n      const newBalance = await storage.getCustomerPointsBalance(req.params.customerId);\n      broadcast(\"loyalty_redeemed\", { ...pointsRecord, balance: newBalance });\n      res.status(201).json({ ...pointsRecord, balance: newBalance });\n    } catch (error) {\n      console.error(\"Error redeeming loyalty points:\", error);\n      res.status(500).json({ message: \"Failed to redeem loyalty points\" });\n    }\n  });\n\n  return httpServer;\n}\n","path":null,"size_bytes":36869,"size_tokens":null},"server/replit_integrations/auth/index.ts":{"content":"export { setupAuth, isAuthenticated, getSession } from \"./replitAuth\";\nexport { authStorage, type IAuthStorage } from \"./storage\";\nexport { registerAuthRoutes } from \"./routes\";\n","path":null,"size_bytes":178,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1592,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10481,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":791,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1139,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"shared/models/auth.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { index, jsonb, pgTable, timestamp, varchar } from \"drizzle-orm/pg-core\";\n\n// Session storage table.\n// (IMPORTANT) This table is mandatory for Replit Auth, don't drop it.\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)]\n);\n\n// User storage table.\n// (IMPORTANT) This table is mandatory for Replit Auth, don't drop it.\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  role: varchar(\"role\").notNull().default(\"receptionist\"), // owner, manager, receptionist\n  phone: varchar(\"phone\"),\n  isActive: varchar(\"is_active\").notNull().default(\"true\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport type UpsertUser = typeof users.$inferInsert;\nexport type User = typeof users.$inferSelect;\n\n// Role permissions for RBAC\nexport const rolePermissions = {\n  owner: [\n    \"manage_staff\",\n    \"manage_settings\",\n    \"view_financials\",\n    \"manage_settlements\",\n    \"manage_courts\",\n    \"manage_bookings\",\n    \"manage_customers\",\n    \"view_analytics\",\n    \"manage_tournaments\",\n  ],\n  manager: [\n    \"view_financials\",\n    \"manage_courts\",\n    \"manage_bookings\",\n    \"manage_customers\",\n    \"view_analytics\",\n    \"manage_tournaments\",\n  ],\n  receptionist: [\n    \"manage_bookings\",\n    \"manage_customers\",\n    \"view_today_schedule\",\n  ],\n} as const;\n\nexport type UserRole = keyof typeof rolePermissions;\nexport type Permission = (typeof rolePermissions)[UserRole][number];\n","path":null,"size_bytes":1864,"size_tokens":null},"server/replit_integrations/auth/routes.ts":{"content":"import type { Express } from \"express\";\nimport { authStorage } from \"./storage\";\nimport { isAuthenticated } from \"./replitAuth\";\n\n// Register auth-specific routes\nexport function registerAuthRoutes(app: Express): void {\n  // Get current authenticated user\n  app.get(\"/api/auth/user\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await authStorage.getUser(userId);\n      res.json(user);\n    } catch (error) {\n      console.error(\"Error fetching user:\", error);\n      res.status(500).json({ message: \"Failed to fetch user\" });\n    }\n  });\n}\n","path":null,"size_bytes":609,"size_tokens":null},"server/vite.ts":{"content":"import { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport async function setupVite(server: Server, app: Express) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server, path: \"/vite-hmr\" },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n","path":null,"size_bytes":1534,"size_tokens":null},"client/src/pages/waitlist.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Clock,\n  Plus,\n  Bell,\n  Check,\n  X,\n  User,\n  Calendar,\n  Send,\n  MessageCircle,\n} from \"lucide-react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { format } from \"date-fns\";\nimport type { Waitlist, Customer, Court } from \"@shared/schema\";\nimport { insertWaitlistSchema } from \"@shared/schema\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { TIME_SLOTS } from \"@/lib/constants\";\n\nconst waitlistFormSchema = insertWaitlistSchema.extend({\n  courtId: z.string().min(1, \"Please select a court\"),\n  customerId: z.string().min(1, \"Please select a customer\"),\n  date: z.string().min(1, \"Please select a date\"),\n  preferredStartTime: z.string().min(1, \"Please select a start time\"),\n  preferredEndTime: z.string().min(1, \"Please select an end time\"),\n});\n\ntype WaitlistFormValues = z.infer<typeof waitlistFormSchema>;\n\nfunction WaitlistStatusBadge({ status }: { status: string }) {\n  const variants: Record<string, { className: string; label: string }> = {\n    waiting: {\n      className: \"bg-blue-500/20 text-blue-700 dark:text-blue-400 border-blue-500/30\",\n      label: \"Waiting\",\n    },\n    notified: {\n      className: \"bg-orange-500/20 text-orange-700 dark:text-orange-400 border-orange-500/30\",\n      label: \"Notified\",\n    },\n    booked: {\n      className: \"bg-green-500/20 text-green-700 dark:text-green-400 border-green-500/30\",\n      label: \"Booked\",\n    },\n    expired: {\n      className: \"bg-gray-500/20 text-gray-700 dark:text-gray-400 border-gray-500/30\",\n      label: \"Expired\",\n    },\n  };\n\n  const variant = variants[status] || variants.waiting;\n\n  return (\n    <Badge variant=\"outline\" className={`${variant.className} text-xs`}>\n      {variant.label}\n    </Badge>\n  );\n}\n\nfunction AddToWaitlistDialog({\n  open,\n  onClose,\n}: {\n  open: boolean;\n  onClose: () => void;\n}) {\n  const { toast } = useToast();\n\n  const { data: courts } = useQuery<Court[]>({\n    queryKey: [\"/api/courts\"],\n  });\n\n  const { data: customers } = useQuery<Customer[]>({\n    queryKey: [\"/api/customers\"],\n  });\n\n  const form = useForm<WaitlistFormValues>({\n    resolver: zodResolver(waitlistFormSchema),\n    defaultValues: {\n      courtId: \"\",\n      customerId: \"\",\n      date: format(new Date(), \"yyyy-MM-dd\"),\n      preferredStartTime: \"\",\n      preferredEndTime: \"\",\n      status: \"waiting\",\n    },\n  });\n\n  const createWaitlist = useMutation({\n    mutationFn: async (data: WaitlistFormValues) => {\n      const response = await apiRequest(\"POST\", \"/api/waitlist\", data);\n      return response;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/waitlist\"] });\n      toast({ title: \"Added to waitlist successfully\" });\n      form.reset();\n      onClose();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to add to waitlist\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: WaitlistFormValues) => {\n    createWaitlist.mutate(data);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>Add to Waitlist</DialogTitle>\n          <DialogDescription>\n            Add a customer to the waitlist for a specific slot\n          </DialogDescription>\n        </DialogHeader>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"customerId\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Customer</FormLabel>\n                  <Select onValueChange={field.onChange} value={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-waitlist-customer\">\n                        <SelectValue placeholder=\"Select customer\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      {customers?.map((customer) => (\n                        <SelectItem key={customer.id} value={customer.id}>\n                          {customer.name} - {customer.phone}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"courtId\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Court</FormLabel>\n                  <Select onValueChange={field.onChange} value={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-waitlist-court\">\n                        <SelectValue placeholder=\"Select court\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      {courts?.filter((c) => c.isActive).map((court) => (\n                        <SelectItem key={court.id} value={court.id}>\n                          {court.name} - {court.sport}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"date\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Date</FormLabel>\n                  <FormControl>\n                    <Input type=\"date\" {...field} data-testid=\"input-waitlist-date\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"preferredStartTime\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Preferred Start</FormLabel>\n                    <Select onValueChange={field.onChange} value={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-waitlist-start\">\n                          <SelectValue placeholder=\"Start time\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        {TIME_SLOTS.map((slot) => (\n                          <SelectItem key={slot.value} value={slot.value}>\n                            {slot.label}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"preferredEndTime\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Preferred End</FormLabel>\n                    <Select onValueChange={field.onChange} value={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-waitlist-end\">\n                          <SelectValue placeholder=\"End time\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        {TIME_SLOTS.map((slot) => (\n                          <SelectItem key={slot.value} value={slot.value}>\n                            {slot.label}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"flex justify-end gap-2\">\n              <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={createWaitlist.isPending} data-testid=\"button-add-waitlist\">\n                {createWaitlist.isPending ? \"Adding...\" : \"Add to Waitlist\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nexport default function WaitlistPage() {\n  const { toast } = useToast();\n  const [addDialogOpen, setAddDialogOpen] = useState(false);\n\n  const { data: waitlistItems, isLoading } = useQuery<Waitlist[]>({\n    queryKey: [\"/api/waitlist\"],\n  });\n\n  const { data: customers } = useQuery<Customer[]>({\n    queryKey: [\"/api/customers\"],\n  });\n\n  const { data: courts } = useQuery<Court[]>({\n    queryKey: [\"/api/courts\"],\n  });\n\n  const getCustomer = (id: string) => customers?.find((c) => c.id === id);\n  const getCourt = (id: string) => courts?.find((c) => c.id === id);\n\n  const notifyMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return apiRequest(\"PATCH\", `/api/waitlist/${id}`, { status: \"notified\" });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/waitlist\"] });\n      toast({ title: \"Customer notified via WhatsApp\" });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to notify customer\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const activeWaitlist = waitlistItems?.filter(\n    (w) => w.status === \"waiting\" || w.status === \"notified\"\n  ) || [];\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n        <div>\n          <h1 className=\"text-2xl font-semibold\">Waitlist</h1>\n          <p className=\"text-muted-foreground text-sm\">\n            Manage customers waiting for slot openings\n          </p>\n        </div>\n        <Button onClick={() => setAddDialogOpen(true)} data-testid=\"button-add-to-waitlist\">\n          <Plus className=\"h-4 w-4 mr-2\" />\n          Add to Waitlist\n        </Button>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n              Active Waitlist\n            </CardTitle>\n            <Clock className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold\" data-testid=\"stat-active-waitlist\">\n              {activeWaitlist.length}\n            </div>\n            <p className=\"text-xs text-muted-foreground\">customers waiting</p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n              Notified Today\n            </CardTitle>\n            <Bell className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold\" data-testid=\"stat-notified-today\">\n              {waitlistItems?.filter((w) => w.status === \"notified\").length || 0}\n            </div>\n            <p className=\"text-xs text-muted-foreground\">awaiting response</p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n              Converted\n            </CardTitle>\n            <Check className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold\" data-testid=\"stat-converted\">\n              {waitlistItems?.filter((w) => w.status === \"booked\").length || 0}\n            </div>\n            <p className=\"text-xs text-muted-foreground\">successfully booked</p>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-lg\">Active Waitlist</CardTitle>\n        </CardHeader>\n        <CardContent>\n          {isLoading ? (\n            <div className=\"space-y-3\">\n              {[1, 2, 3, 4].map((i) => (\n                <Skeleton key={i} className=\"h-16 w-full\" />\n              ))}\n            </div>\n          ) : (\n            <div className=\"overflow-x-auto\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Customer</TableHead>\n                    <TableHead>Court</TableHead>\n                    <TableHead>Date</TableHead>\n                    <TableHead>Preferred Time</TableHead>\n                    <TableHead>Status</TableHead>\n                    <TableHead>Actions</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {activeWaitlist.map((item) => {\n                    const customer = getCustomer(item.customerId);\n                    const court = getCourt(item.courtId);\n\n                    return (\n                      <TableRow key={item.id} data-testid={`waitlist-row-${item.id}`}>\n                        <TableCell>\n                          <div className=\"flex items-center gap-2\">\n                            <div className=\"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center text-xs\">\n                              {customer?.name.charAt(0) || \"?\"}\n                            </div>\n                            <div>\n                              <div className=\"font-medium\">{customer?.name || \"Unknown\"}</div>\n                              <div className=\"text-xs text-muted-foreground\">\n                                {customer?.phone}\n                              </div>\n                            </div>\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          <div>\n                            <div className=\"font-medium\">{court?.name || \"Unknown\"}</div>\n                            <div className=\"text-xs text-muted-foreground\">\n                              {court?.sport}\n                            </div>\n                          </div>\n                        </TableCell>\n                        <TableCell>{item.date}</TableCell>\n                        <TableCell>\n                          {item.preferredStartTime} - {item.preferredEndTime}\n                        </TableCell>\n                        <TableCell>\n                          <WaitlistStatusBadge status={item.status} />\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"flex items-center gap-2\">\n                            {item.status === \"waiting\" && (\n                              <Button\n                                size=\"sm\"\n                                variant=\"outline\"\n                                onClick={() => notifyMutation.mutate(item.id)}\n                                disabled={notifyMutation.isPending}\n                                data-testid={`button-notify-${item.id}`}\n                              >\n                                <MessageCircle className=\"h-4 w-4 mr-1\" />\n                                Notify\n                              </Button>\n                            )}\n                            {item.status === \"notified\" && (\n                              <Button size=\"sm\" data-testid={`button-book-${item.id}`}>\n                                <Check className=\"h-4 w-4 mr-1\" />\n                                Book Now\n                              </Button>\n                            )}\n                          </div>\n                        </TableCell>\n                      </TableRow>\n                    );\n                  })}\n                </TableBody>\n              </Table>\n\n              {activeWaitlist.length === 0 && (\n                <div className=\"text-center py-12 text-muted-foreground\">\n                  <Clock className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                  <p>No customers in waitlist</p>\n                  <p className=\"text-sm mt-1\">\n                    Add customers when prime slots are fully booked\n                  </p>\n                </div>\n              )}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      <AddToWaitlistDialog\n        open={addDialogOpen}\n        onClose={() => setAddDialogOpen(false)}\n      />\n    </div>\n  );\n}\n","path":null,"size_bytes":17665,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4420,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":1080,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":1977,"size_tokens":null},"client/src/components/theme-toggle.tsx":{"content":"import { Moon, Sun } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { useTheme } from \"@/components/theme-provider\";\n\nexport function ThemeToggle() {\n  const { setTheme } = useTheme();\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button variant=\"ghost\" size=\"icon\" data-testid=\"button-theme-toggle\">\n          <Sun className=\"h-4 w-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0\" />\n          <Moon className=\"absolute h-4 w-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100\" />\n          <span className=\"sr-only\">Toggle theme</span>\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"end\">\n        <DropdownMenuItem onClick={() => setTheme(\"light\")} data-testid=\"menu-theme-light\">\n          Light\n        </DropdownMenuItem>\n        <DropdownMenuItem onClick={() => setTheme(\"dark\")} data-testid=\"menu-theme-dark\">\n          Dark\n        </DropdownMenuItem>\n        <DropdownMenuItem onClick={() => setTheme(\"system\")} data-testid=\"menu-theme-system\">\n          System\n        </DropdownMenuItem>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}\n","path":null,"size_bytes":1310,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1056,"size_tokens":null},"server/storage.ts":{"content":"import { db } from \"./db\";\nimport { eq, and, desc, asc, gte, lte, sql, sum } from \"drizzle-orm\";\nimport {\n  users, courts, customers, bookings, transactions, settlements,\n  waitlist, blockedSlots, tournaments, tournamentTeams, maintenanceLogs, expenses,\n  membershipPlans, memberships, loyaltyPoints,\n  type User, type UpsertUser,\n  type Court, type InsertCourt,\n  type Customer, type InsertCustomer,\n  type Booking, type InsertBooking,\n  type Transaction, type InsertTransaction,\n  type Settlement, type InsertSettlement,\n  type Waitlist, type InsertWaitlist,\n  type BlockedSlot, type InsertBlockedSlot,\n  type Tournament, type InsertTournament,\n  type TournamentTeam, type InsertTournamentTeam,\n  type MaintenanceLog, type InsertMaintenanceLog,\n  type Expense, type InsertExpense,\n  type MembershipPlan, type InsertMembershipPlan,\n  type Membership, type InsertMembership,\n  type LoyaltyPoints, type InsertLoyaltyPoints,\n} from \"@shared/schema\";\n\nexport interface IStorage {\n  // Users\n  getUser(id: string): Promise<User | undefined>;\n  createUser(user: any): Promise<User>;\n  \n  // Staff (RBAC)\n  getStaff(): Promise<User[]>;\n  updateStaffRole(id: string, role: string): Promise<User | undefined>;\n\n  // Courts\n  getCourts(): Promise<Court[]>;\n  getCourt(id: string): Promise<Court | undefined>;\n  createCourt(court: InsertCourt): Promise<Court>;\n  updateCourt(id: string, court: Partial<InsertCourt>): Promise<Court | undefined>;\n  deleteCourt(id: string): Promise<void>;\n\n  // Customers\n  getCustomers(): Promise<Customer[]>;\n  getCustomer(id: string): Promise<Customer | undefined>;\n  getCustomerByPhone(phone: string): Promise<Customer | undefined>;\n  createCustomer(customer: InsertCustomer): Promise<Customer>;\n  updateCustomer(id: string, customer: Partial<InsertCustomer>): Promise<Customer | undefined>;\n\n  // Bookings\n  getBookings(): Promise<Booking[]>;\n  getBookingsByDate(date: string): Promise<Booking[]>;\n  getBooking(id: string): Promise<Booking | undefined>;\n  createBooking(booking: InsertBooking): Promise<Booking>;\n  updateBooking(id: string, booking: Partial<InsertBooking>): Promise<Booking | undefined>;\n  deleteBooking(id: string): Promise<void>;\n\n  // Transactions\n  getTransactions(): Promise<Transaction[]>;\n  createTransaction(transaction: InsertTransaction): Promise<Transaction>;\n\n  // Settlements\n  getSettlements(): Promise<Settlement[]>;\n  createSettlement(settlement: InsertSettlement): Promise<Settlement>;\n  updateSettlement(id: string, settlement: Partial<InsertSettlement>): Promise<Settlement | undefined>;\n\n  // Waitlist\n  getWaitlist(): Promise<Waitlist[]>;\n  getWaitlistItem(id: string): Promise<Waitlist | undefined>;\n  createWaitlistItem(item: InsertWaitlist): Promise<Waitlist>;\n  updateWaitlistItem(id: string, item: Partial<InsertWaitlist>): Promise<Waitlist | undefined>;\n\n  // Blocked Slots\n  getBlockedSlots(): Promise<BlockedSlot[]>;\n  createBlockedSlot(slot: InsertBlockedSlot): Promise<BlockedSlot>;\n  deleteBlockedSlot(id: string): Promise<void>;\n\n  // Tournaments\n  getTournaments(): Promise<Tournament[]>;\n  getTournament(id: string): Promise<Tournament | undefined>;\n  createTournament(tournament: InsertTournament): Promise<Tournament>;\n  updateTournament(id: string, tournament: Partial<InsertTournament>): Promise<Tournament | undefined>;\n\n  // Tournament Teams\n  getTournamentTeams(tournamentId: string): Promise<TournamentTeam[]>;\n  createTournamentTeam(team: InsertTournamentTeam): Promise<TournamentTeam>;\n\n  // Maintenance Logs\n  getMaintenanceLogs(): Promise<MaintenanceLog[]>;\n  createMaintenanceLog(log: InsertMaintenanceLog): Promise<MaintenanceLog>;\n  updateMaintenanceLog(id: string, log: Partial<InsertMaintenanceLog>): Promise<MaintenanceLog | undefined>;\n\n  // Expenses\n  getExpenses(): Promise<Expense[]>;\n  createExpense(expense: InsertExpense): Promise<Expense>;\n  deleteExpense(id: string): Promise<void>;\n\n  // Membership Plans\n  getMembershipPlans(): Promise<MembershipPlan[]>;\n  getMembershipPlan(id: string): Promise<MembershipPlan | undefined>;\n  createMembershipPlan(plan: InsertMembershipPlan): Promise<MembershipPlan>;\n  updateMembershipPlan(id: string, plan: Partial<InsertMembershipPlan>): Promise<MembershipPlan | undefined>;\n  deleteMembershipPlan(id: string): Promise<void>;\n\n  // Memberships\n  getMemberships(): Promise<Membership[]>;\n  getMembership(id: string): Promise<Membership | undefined>;\n  getCustomerMemberships(customerId: string): Promise<Membership[]>;\n  getActiveMembership(customerId: string): Promise<Membership | undefined>;\n  createMembership(membership: InsertMembership): Promise<Membership>;\n  updateMembership(id: string, membership: Partial<InsertMembership>): Promise<Membership | undefined>;\n\n  // Loyalty Points\n  getLoyaltyPoints(customerId: string): Promise<LoyaltyPoints[]>;\n  createLoyaltyPoints(points: InsertLoyaltyPoints): Promise<LoyaltyPoints>;\n  getCustomerPointsBalance(customerId: string): Promise<number>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // Users\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async createUser(user: any): Promise<User> {\n    const [created] = await db.insert(users).values(user).returning();\n    return created;\n  }\n  \n  // Staff (RBAC)\n  async getStaff(): Promise<User[]> {\n    return db.select().from(users).orderBy(desc(users.createdAt));\n  }\n\n  async updateStaffRole(id: string, role: string): Promise<User | undefined> {\n    const [updated] = await db.update(users)\n      .set({ role, updatedAt: new Date() })\n      .where(eq(users.id, id))\n      .returning();\n    return updated;\n  }\n\n  // Courts\n  async getCourts(): Promise<Court[]> {\n    return db.select().from(courts).orderBy(asc(courts.name));\n  }\n\n  async getCourt(id: string): Promise<Court | undefined> {\n    const [court] = await db.select().from(courts).where(eq(courts.id, id));\n    return court;\n  }\n\n  async createCourt(court: InsertCourt): Promise<Court> {\n    const [created] = await db.insert(courts).values(court).returning();\n    return created;\n  }\n\n  async updateCourt(id: string, court: Partial<InsertCourt>): Promise<Court | undefined> {\n    const [updated] = await db.update(courts).set(court).where(eq(courts.id, id)).returning();\n    return updated;\n  }\n\n  async deleteCourt(id: string): Promise<void> {\n    await db.delete(courts).where(eq(courts.id, id));\n  }\n\n  // Customers\n  async getCustomers(): Promise<Customer[]> {\n    return db.select().from(customers).orderBy(desc(customers.totalSpend));\n  }\n\n  async getCustomer(id: string): Promise<Customer | undefined> {\n    const [customer] = await db.select().from(customers).where(eq(customers.id, id));\n    return customer;\n  }\n\n  async getCustomerByPhone(phone: string): Promise<Customer | undefined> {\n    const [customer] = await db.select().from(customers).where(eq(customers.phone, phone));\n    return customer;\n  }\n\n  async createCustomer(customer: InsertCustomer): Promise<Customer> {\n    const [created] = await db.insert(customers).values(customer).returning();\n    return created;\n  }\n\n  async updateCustomer(id: string, customer: Partial<InsertCustomer>): Promise<Customer | undefined> {\n    const [updated] = await db.update(customers).set(customer).where(eq(customers.id, id)).returning();\n    return updated;\n  }\n\n  // Bookings\n  async getBookings(): Promise<Booking[]> {\n    return db.select().from(bookings).orderBy(desc(bookings.createdAt));\n  }\n\n  async getBookingsByDate(date: string): Promise<Booking[]> {\n    return db.select().from(bookings).where(eq(bookings.date, date)).orderBy(asc(bookings.startTime));\n  }\n\n  async getBooking(id: string): Promise<Booking | undefined> {\n    const [booking] = await db.select().from(bookings).where(eq(bookings.id, id));\n    return booking;\n  }\n\n  async createBooking(booking: InsertBooking): Promise<Booking> {\n    const [created] = await db.insert(bookings).values(booking).returning();\n    \n    // Update customer stats\n    await db.update(customers)\n      .set({\n        totalBookings: sql`${customers.totalBookings} + 1`,\n        totalSpend: sql`${customers.totalSpend} + ${booking.paidAmount || \"0\"}`,\n      })\n      .where(eq(customers.id, booking.customerId));\n    \n    return created;\n  }\n\n  async updateBooking(id: string, booking: Partial<InsertBooking>): Promise<Booking | undefined> {\n    const [updated] = await db.update(bookings).set(booking).where(eq(bookings.id, id)).returning();\n    return updated;\n  }\n\n  async deleteBooking(id: string): Promise<void> {\n    await db.delete(bookings).where(eq(bookings.id, id));\n  }\n\n  // Transactions\n  async getTransactions(): Promise<Transaction[]> {\n    return db.select().from(transactions).orderBy(desc(transactions.createdAt));\n  }\n\n  async createTransaction(transaction: InsertTransaction): Promise<Transaction> {\n    const [created] = await db.insert(transactions).values(transaction).returning();\n    return created;\n  }\n\n  // Settlements\n  async getSettlements(): Promise<Settlement[]> {\n    return db.select().from(settlements).orderBy(desc(settlements.createdAt));\n  }\n\n  async createSettlement(settlement: InsertSettlement): Promise<Settlement> {\n    const [created] = await db.insert(settlements).values(settlement).returning();\n    return created;\n  }\n\n  async updateSettlement(id: string, settlement: Partial<InsertSettlement>): Promise<Settlement | undefined> {\n    const [updated] = await db.update(settlements).set(settlement).where(eq(settlements.id, id)).returning();\n    return updated;\n  }\n\n  // Waitlist\n  async getWaitlist(): Promise<Waitlist[]> {\n    return db.select().from(waitlist).orderBy(desc(waitlist.createdAt));\n  }\n\n  async getWaitlistItem(id: string): Promise<Waitlist | undefined> {\n    const [item] = await db.select().from(waitlist).where(eq(waitlist.id, id));\n    return item;\n  }\n\n  async createWaitlistItem(item: InsertWaitlist): Promise<Waitlist> {\n    const [created] = await db.insert(waitlist).values(item).returning();\n    return created;\n  }\n\n  async updateWaitlistItem(id: string, item: Partial<InsertWaitlist>): Promise<Waitlist | undefined> {\n    const [updated] = await db.update(waitlist).set(item).where(eq(waitlist.id, id)).returning();\n    return updated;\n  }\n\n  // Blocked Slots\n  async getBlockedSlots(): Promise<BlockedSlot[]> {\n    return db.select().from(blockedSlots).orderBy(desc(blockedSlots.createdAt));\n  }\n\n  async createBlockedSlot(slot: InsertBlockedSlot): Promise<BlockedSlot> {\n    const [created] = await db.insert(blockedSlots).values(slot).returning();\n    return created;\n  }\n\n  async deleteBlockedSlot(id: string): Promise<void> {\n    await db.delete(blockedSlots).where(eq(blockedSlots.id, id));\n  }\n\n  // Tournaments\n  async getTournaments(): Promise<Tournament[]> {\n    return db.select().from(tournaments).orderBy(desc(tournaments.startDate));\n  }\n\n  async getTournament(id: string): Promise<Tournament | undefined> {\n    const [tournament] = await db.select().from(tournaments).where(eq(tournaments.id, id));\n    return tournament;\n  }\n\n  async createTournament(tournament: InsertTournament): Promise<Tournament> {\n    const [created] = await db.insert(tournaments).values(tournament).returning();\n    return created;\n  }\n\n  async updateTournament(id: string, tournament: Partial<InsertTournament>): Promise<Tournament | undefined> {\n    const [updated] = await db.update(tournaments).set(tournament).where(eq(tournaments.id, id)).returning();\n    return updated;\n  }\n\n  // Tournament Teams\n  async getTournamentTeams(tournamentId: string): Promise<TournamentTeam[]> {\n    return db.select().from(tournamentTeams).where(eq(tournamentTeams.tournamentId, tournamentId));\n  }\n\n  async createTournamentTeam(team: InsertTournamentTeam): Promise<TournamentTeam> {\n    const [created] = await db.insert(tournamentTeams).values(team).returning();\n    return created;\n  }\n\n  // Maintenance Logs\n  async getMaintenanceLogs(): Promise<MaintenanceLog[]> {\n    return db.select().from(maintenanceLogs).orderBy(desc(maintenanceLogs.createdAt));\n  }\n\n  async createMaintenanceLog(log: InsertMaintenanceLog): Promise<MaintenanceLog> {\n    const [created] = await db.insert(maintenanceLogs).values(log).returning();\n    return created;\n  }\n\n  async updateMaintenanceLog(id: string, log: Partial<InsertMaintenanceLog>): Promise<MaintenanceLog | undefined> {\n    const [updated] = await db.update(maintenanceLogs).set(log).where(eq(maintenanceLogs.id, id)).returning();\n    return updated;\n  }\n\n  // Expenses\n  async getExpenses(): Promise<Expense[]> {\n    return db.select().from(expenses).orderBy(desc(expenses.date));\n  }\n\n  async createExpense(expense: InsertExpense): Promise<Expense> {\n    const [created] = await db.insert(expenses).values(expense).returning();\n    return created;\n  }\n\n  async deleteExpense(id: string): Promise<void> {\n    await db.delete(expenses).where(eq(expenses.id, id));\n  }\n\n  // Membership Plans\n  async getMembershipPlans(): Promise<MembershipPlan[]> {\n    return db.select().from(membershipPlans).orderBy(asc(membershipPlans.price));\n  }\n\n  async getMembershipPlan(id: string): Promise<MembershipPlan | undefined> {\n    const [plan] = await db.select().from(membershipPlans).where(eq(membershipPlans.id, id));\n    return plan;\n  }\n\n  async createMembershipPlan(plan: InsertMembershipPlan): Promise<MembershipPlan> {\n    const [created] = await db.insert(membershipPlans).values(plan).returning();\n    return created;\n  }\n\n  async updateMembershipPlan(id: string, plan: Partial<InsertMembershipPlan>): Promise<MembershipPlan | undefined> {\n    const [updated] = await db.update(membershipPlans).set(plan).where(eq(membershipPlans.id, id)).returning();\n    return updated;\n  }\n\n  async deleteMembershipPlan(id: string): Promise<void> {\n    await db.delete(membershipPlans).where(eq(membershipPlans.id, id));\n  }\n\n  // Memberships\n  async getMemberships(): Promise<Membership[]> {\n    return db.select().from(memberships).orderBy(desc(memberships.createdAt));\n  }\n\n  async getMembership(id: string): Promise<Membership | undefined> {\n    const [membership] = await db.select().from(memberships).where(eq(memberships.id, id));\n    return membership;\n  }\n\n  async getCustomerMemberships(customerId: string): Promise<Membership[]> {\n    return db.select().from(memberships)\n      .where(eq(memberships.customerId, customerId))\n      .orderBy(desc(memberships.createdAt));\n  }\n\n  async getActiveMembership(customerId: string): Promise<Membership | undefined> {\n    const today = new Date().toISOString().split(\"T\")[0];\n    const [membership] = await db.select().from(memberships)\n      .where(and(\n        eq(memberships.customerId, customerId),\n        eq(memberships.status, \"active\"),\n        lte(memberships.startDate, today),\n        gte(memberships.endDate, today)\n      ));\n    return membership;\n  }\n\n  async createMembership(membership: InsertMembership): Promise<Membership> {\n    const [created] = await db.insert(memberships).values(membership).returning();\n    return created;\n  }\n\n  async updateMembership(id: string, membership: Partial<InsertMembership>): Promise<Membership | undefined> {\n    const [updated] = await db.update(memberships).set(membership).where(eq(memberships.id, id)).returning();\n    return updated;\n  }\n\n  // Loyalty Points\n  async getLoyaltyPoints(customerId: string): Promise<LoyaltyPoints[]> {\n    return db.select().from(loyaltyPoints)\n      .where(eq(loyaltyPoints.customerId, customerId))\n      .orderBy(desc(loyaltyPoints.createdAt));\n  }\n\n  async createLoyaltyPoints(points: InsertLoyaltyPoints): Promise<LoyaltyPoints> {\n    const [created] = await db.insert(loyaltyPoints).values(points).returning();\n    return created;\n  }\n\n  async getCustomerPointsBalance(customerId: string): Promise<number> {\n    const result = await db.select({ \n      total: sql<number>`COALESCE(SUM(${loyaltyPoints.points}), 0)`\n    })\n    .from(loyaltyPoints)\n    .where(eq(loyaltyPoints.customerId, customerId));\n    \n    return Number(result[0]?.total ?? 0);\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","path":null,"size_bytes":16062,"size_tokens":null},"client/src/components/theme-provider.tsx":{"content":"import { createContext, useContext, useEffect, useState } from \"react\";\n\ntype Theme = \"dark\" | \"light\" | \"system\";\n\ntype ThemeProviderProps = {\n  children: React.ReactNode;\n  defaultTheme?: Theme;\n  storageKey?: string;\n};\n\ntype ThemeProviderState = {\n  theme: Theme;\n  setTheme: (theme: Theme) => void;\n};\n\nconst initialState: ThemeProviderState = {\n  theme: \"system\",\n  setTheme: () => null,\n};\n\nconst ThemeProviderContext = createContext<ThemeProviderState>(initialState);\n\nexport function ThemeProvider({\n  children,\n  defaultTheme = \"system\",\n  storageKey = \"venuehub-ui-theme\",\n  ...props\n}: ThemeProviderProps) {\n  const [theme, setTheme] = useState<Theme>(\n    () => (localStorage.getItem(storageKey) as Theme) || defaultTheme\n  );\n\n  useEffect(() => {\n    const root = window.document.documentElement;\n\n    root.classList.remove(\"light\", \"dark\");\n\n    if (theme === \"system\") {\n      const systemTheme = window.matchMedia(\"(prefers-color-scheme: dark)\")\n        .matches\n        ? \"dark\"\n        : \"light\";\n\n      root.classList.add(systemTheme);\n      return;\n    }\n\n    root.classList.add(theme);\n  }, [theme]);\n\n  const value = {\n    theme,\n    setTheme: (theme: Theme) => {\n      localStorage.setItem(storageKey, theme);\n      setTheme(theme);\n    },\n  };\n\n  return (\n    <ThemeProviderContext.Provider {...props} value={value}>\n      {children}\n    </ThemeProviderContext.Provider>\n  );\n}\n\nexport const useTheme = () => {\n  const context = useContext(ThemeProviderContext);\n\n  if (context === undefined)\n    throw new Error(\"useTheme must be used within a ThemeProvider\");\n\n  return context;\n};\n","path":null,"size_bytes":1609,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/pages/walkin.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from \"@/components/ui/command\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  User,\n  Plus,\n  Calendar,\n  Clock,\n  CreditCard,\n  Star,\n  AlertTriangle,\n  Check,\n  QrCode,\n} from \"lucide-react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { format } from \"date-fns\";\nimport type { Court, Customer, Booking } from \"@shared/schema\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { TIME_SLOTS, DURATIONS, PAYMENT_METHODS } from \"@/lib/constants\";\nimport { QRCodeSVG } from \"qrcode.react\";\n\nconst bookingFormSchema = z.object({\n  courtId: z.string().min(1, \"Please select a court\"),\n  customerId: z.string().min(1, \"Please select a customer\"),\n  date: z.string().min(1, \"Please select a date\"),\n  startTime: z.string().min(1, \"Please select start time\"),\n  duration: z.coerce.number().min(30, \"Please select duration\"),\n  paymentMethod: z.string().optional(),\n  paidAmount: z.coerce.number().min(0).optional(),\n  notes: z.string().optional(),\n});\n\ntype BookingFormValues = z.infer<typeof bookingFormSchema>;\n\nfunction CustomerSearchCombobox({\n  customers,\n  value,\n  onChange,\n}: {\n  customers: Customer[];\n  value: string;\n  onChange: (value: string) => void;\n}) {\n  const [open, setOpen] = useState(false);\n  const selectedCustomer = customers.find((c) => c.id === value);\n\n  return (\n    <Popover open={open} onOpenChange={setOpen}>\n      <PopoverTrigger asChild>\n        <Button\n          variant=\"outline\"\n          role=\"combobox\"\n          aria-expanded={open}\n          className=\"w-full justify-between\"\n          data-testid=\"select-customer\"\n        >\n          {selectedCustomer ? (\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-6 h-6 rounded-full bg-primary/20 flex items-center justify-center text-xs\">\n                {selectedCustomer.name.charAt(0)}\n              </div>\n              <span>{selectedCustomer.name}</span>\n              <span className=\"text-muted-foreground text-xs\">\n                {selectedCustomer.phone}\n              </span>\n              {selectedCustomer.tags.includes(\"VIP\") && (\n                <Badge className=\"bg-amber-500 text-white text-xs ml-1\">\n                  <Star className=\"h-3 w-3 mr-1\" />\n                  VIP\n                </Badge>\n              )}\n            </div>\n          ) : (\n            <span className=\"text-muted-foreground\">Search customer...</span>\n          )}\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-full p-0\" align=\"start\">\n        <Command>\n          <CommandInput placeholder=\"Search by name or phone...\" />\n          <CommandList>\n            <CommandEmpty>No customer found.</CommandEmpty>\n            <CommandGroup>\n              {customers.map((customer) => (\n                <CommandItem\n                  key={customer.id}\n                  value={`${customer.name} ${customer.phone}`}\n                  onSelect={() => {\n                    onChange(customer.id);\n                    setOpen(false);\n                  }}\n                  data-testid={`customer-option-${customer.id}`}\n                >\n                  <div className=\"flex items-center gap-3 w-full\">\n                    <div className=\"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center text-sm\">\n                      {customer.name.charAt(0)}\n                    </div>\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"font-medium\">{customer.name}</span>\n                        {customer.tags.includes(\"VIP\") && (\n                          <Badge className=\"bg-amber-500 text-white text-xs\">VIP</Badge>\n                        )}\n                        {customer.tags.includes(\"HIGH_RISK\") && (\n                          <Badge className=\"bg-red-500 text-white text-xs\">\n                            <AlertTriangle className=\"h-3 w-3\" />\n                          </Badge>\n                        )}\n                      </div>\n                      <div className=\"text-xs text-muted-foreground\">\n                        {customer.phone}\n                      </div>\n                    </div>\n                    {value === customer.id && <Check className=\"h-4 w-4\" />}\n                  </div>\n                </CommandItem>\n              ))}\n            </CommandGroup>\n          </CommandList>\n        </Command>\n      </PopoverContent>\n    </Popover>\n  );\n}\n\nfunction HighRiskWarningDialog({\n  customer,\n  open,\n  onConfirm,\n  onCancel,\n}: {\n  customer: Customer | null;\n  open: boolean;\n  onConfirm: () => void;\n  onCancel: () => void;\n}) {\n  if (!customer) return null;\n\n  return (\n    <Dialog open={open} onOpenChange={onCancel}>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2 text-destructive\">\n            <AlertTriangle className=\"h-5 w-5\" />\n            High Risk Customer\n          </DialogTitle>\n          <DialogDescription>\n            This customer has been flagged as high risk\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4\">\n          <div className=\"p-4 bg-red-50 dark:bg-red-900/20 rounded-md\">\n            <p className=\"font-medium\">{customer.name}</p>\n            <p className=\"text-sm text-muted-foreground\">{customer.phone}</p>\n            <div className=\"mt-2 text-sm\">\n              <p>No-shows: {customer.noShowCount}</p>\n              {customer.notes && (\n                <p className=\"mt-1 text-muted-foreground\">\n                  Notes: {customer.notes}\n                </p>\n              )}\n            </div>\n          </div>\n\n          <p className=\"text-sm text-muted-foreground\">\n            Are you sure you want to proceed with this booking?\n          </p>\n\n          <div className=\"flex justify-end gap-2\">\n            <Button variant=\"outline\" onClick={onCancel}>\n              Cancel\n            </Button>\n            <Button variant=\"destructive\" onClick={onConfirm} data-testid=\"button-confirm-high-risk\">\n              Proceed Anyway\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nfunction BookingConfirmationDialog({\n  booking,\n  court,\n  customer,\n  open,\n  onClose,\n}: {\n  booking: Booking | null;\n  court: Court | null;\n  customer: Customer | null;\n  open: boolean;\n  onClose: () => void;\n}) {\n  if (!booking || !court || !customer) return null;\n\n  const qrValue = `BOOKING:${booking.id}`;\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-md\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2 text-green-600\">\n            <Check className=\"h-5 w-5\" />\n            Booking Confirmed\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"space-y-4 text-center\">\n          <div className=\"flex flex-col items-center p-4 bg-white rounded-md\">\n            <QRCodeSVG value={qrValue} size={150} />\n            <p className=\"text-xs text-muted-foreground mt-2\">Scan to verify</p>\n          </div>\n\n          <div className=\"text-left p-4 bg-muted rounded-md\">\n            <div className=\"grid grid-cols-2 gap-2 text-sm\">\n              <div className=\"text-muted-foreground\">Customer:</div>\n              <div className=\"font-medium\">{customer.name}</div>\n              <div className=\"text-muted-foreground\">Court:</div>\n              <div className=\"font-medium\">{court.name}</div>\n              <div className=\"text-muted-foreground\">Date:</div>\n              <div className=\"font-medium\">{booking.date}</div>\n              <div className=\"text-muted-foreground\">Time:</div>\n              <div className=\"font-medium\">\n                {booking.startTime} - {booking.endTime}\n              </div>\n              <div className=\"text-muted-foreground\">Amount:</div>\n              <div className=\"font-medium\">₹{booking.totalAmount}</div>\n              <div className=\"text-muted-foreground\">Paid:</div>\n              <div className=\"font-medium\">₹{booking.paidAmount}</div>\n            </div>\n          </div>\n\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" className=\"flex-1\" data-testid=\"button-send-whatsapp\">\n              Send via WhatsApp\n            </Button>\n            <Button className=\"flex-1\" onClick={onClose} data-testid=\"button-done\">\n              Done\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nexport default function WalkinBooking() {\n  const { toast } = useToast();\n  const [highRiskWarning, setHighRiskWarning] = useState<Customer | null>(null);\n  const [confirmedBooking, setConfirmedBooking] = useState<Booking | null>(null);\n\n  const { data: courts, isLoading: courtsLoading } = useQuery<Court[]>({\n    queryKey: [\"/api/courts\"],\n  });\n\n  const { data: customers, isLoading: customersLoading } = useQuery<Customer[]>({\n    queryKey: [\"/api/customers\"],\n  });\n\n  const form = useForm<BookingFormValues>({\n    resolver: zodResolver(bookingFormSchema),\n    defaultValues: {\n      courtId: \"\",\n      customerId: \"\",\n      date: format(new Date(), \"yyyy-MM-dd\"),\n      startTime: \"\",\n      duration: 60,\n      paymentMethod: \"cash\",\n      paidAmount: 0,\n      notes: \"\",\n    },\n  });\n\n  const selectedCourt = courts?.find((c) => c.id === form.watch(\"courtId\"));\n  const selectedCustomer = customers?.find((c) => c.id === form.watch(\"customerId\"));\n  const duration = form.watch(\"duration\");\n  const startTime = form.watch(\"startTime\");\n\n  const calculateEndTime = (start: string, dur: number) => {\n    if (!start) return \"\";\n    const [hours, minutes] = start.split(\":\").map(Number);\n    const totalMinutes = hours * 60 + minutes + dur;\n    const endHours = Math.floor(totalMinutes / 60);\n    const endMins = totalMinutes % 60;\n    return `${endHours.toString().padStart(2, \"0\")}:${endMins.toString().padStart(2, \"0\")}`;\n  };\n\n  const endTime = calculateEndTime(startTime, duration);\n\n  const calculatePrice = () => {\n    if (!selectedCourt || !duration) return 0;\n    const hourlyRate = Number(selectedCourt.hourlyRate);\n    return Math.round((hourlyRate * duration) / 60);\n  };\n\n  const totalPrice = calculatePrice();\n\n  const createBooking = useMutation({\n    mutationFn: async (data: BookingFormValues) => {\n      const bookingData = {\n        ...data,\n        endTime: calculateEndTime(data.startTime, data.duration),\n        totalAmount: totalPrice.toString(),\n        paidAmount: (data.paidAmount || 0).toString(),\n        paymentStatus:\n          (data.paidAmount || 0) >= totalPrice\n            ? \"paid\"\n            : (data.paidAmount || 0) > 0\n            ? \"partial\"\n            : \"pending\",\n        status: \"confirmed\",\n        qrCode: `BOOKING:${Date.now()}`,\n      };\n      const response = await apiRequest(\"POST\", \"/api/bookings\", bookingData);\n      return response;\n    },\n    onSuccess: (booking) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/bookings\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/stats/dashboard\"] });\n      toast({ title: \"Booking created successfully\" });\n      setConfirmedBooking(booking);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to create booking\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: BookingFormValues) => {\n    const customer = customers?.find((c) => c.id === data.customerId);\n    if (customer?.tags.includes(\"HIGH_RISK\")) {\n      setHighRiskWarning(customer);\n      return;\n    }\n    createBooking.mutate(data);\n  };\n\n  const confirmHighRiskBooking = () => {\n    setHighRiskWarning(null);\n    createBooking.mutate(form.getValues());\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-2xl font-semibold\">Walk-in Booking</h1>\n        <p className=\"text-muted-foreground text-sm\">\n          Quick booking for customers at the desk\n        </p>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        <Card className=\"lg:col-span-2\">\n          <CardHeader>\n            <CardTitle className=\"text-lg flex items-center gap-2\">\n              <Calendar className=\"h-5 w-5\" />\n              Booking Details\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            {courtsLoading || customersLoading ? (\n              <div className=\"space-y-4\">\n                {[1, 2, 3, 4].map((i) => (\n                  <Skeleton key={i} className=\"h-12 w-full\" />\n                ))}\n              </div>\n            ) : (\n              <Form {...form}>\n                <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n                  <FormField\n                    control={form.control}\n                    name=\"customerId\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"flex items-center gap-2\">\n                          <User className=\"h-4 w-4\" />\n                          Customer\n                        </FormLabel>\n                        <FormControl>\n                          <CustomerSearchCombobox\n                            customers={customers || []}\n                            value={field.value}\n                            onChange={field.onChange}\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"courtId\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Court</FormLabel>\n                        <Select onValueChange={field.onChange} value={field.value}>\n                          <FormControl>\n                            <SelectTrigger data-testid=\"select-court\">\n                              <SelectValue placeholder=\"Select a court\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            {courts?.filter((c) => c.isActive).map((court) => (\n                              <SelectItem key={court.id} value={court.id}>\n                                {court.name} - {court.sport} (₹{court.hourlyRate}/hr)\n                              </SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                    <FormField\n                      control={form.control}\n                      name=\"date\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Date</FormLabel>\n                          <FormControl>\n                            <Input type=\"date\" {...field} data-testid=\"input-date\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"startTime\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Start Time</FormLabel>\n                          <Select onValueChange={field.onChange} value={field.value}>\n                            <FormControl>\n                              <SelectTrigger data-testid=\"select-start-time\">\n                                <SelectValue placeholder=\"Select time\" />\n                              </SelectTrigger>\n                            </FormControl>\n                            <SelectContent>\n                              {TIME_SLOTS.map((slot) => (\n                                <SelectItem key={slot.value} value={slot.value}>\n                                  {slot.label}\n                                </SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"duration\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Duration</FormLabel>\n                          <Select\n                            onValueChange={(v) => field.onChange(Number(v))}\n                            value={field.value.toString()}\n                          >\n                            <FormControl>\n                              <SelectTrigger data-testid=\"select-duration\">\n                                <SelectValue placeholder=\"Select duration\" />\n                              </SelectTrigger>\n                            </FormControl>\n                            <SelectContent>\n                              {DURATIONS.map((dur) => (\n                                <SelectItem key={dur.value} value={dur.value.toString()}>\n                                  {dur.label}\n                                </SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                  </div>\n\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <FormField\n                      control={form.control}\n                      name=\"paymentMethod\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Payment Method</FormLabel>\n                          <Select onValueChange={field.onChange} value={field.value}>\n                            <FormControl>\n                              <SelectTrigger data-testid=\"select-payment-method\">\n                                <SelectValue placeholder=\"Select method\" />\n                              </SelectTrigger>\n                            </FormControl>\n                            <SelectContent>\n                              {PAYMENT_METHODS.map((method) => (\n                                <SelectItem key={method.value} value={method.value}>\n                                  {method.label}\n                                </SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"paidAmount\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Amount Paid (₹)</FormLabel>\n                          <FormControl>\n                            <Input\n                              type=\"number\"\n                              placeholder=\"0\"\n                              {...field}\n                              data-testid=\"input-paid-amount\"\n                            />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                  </div>\n\n                  <FormField\n                    control={form.control}\n                    name=\"notes\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Notes (Optional)</FormLabel>\n                        <FormControl>\n                          <Input\n                            placeholder=\"Any special requests...\"\n                            {...field}\n                            data-testid=\"input-notes\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <Button\n                    type=\"submit\"\n                    className=\"w-full\"\n                    size=\"lg\"\n                    disabled={createBooking.isPending}\n                    data-testid=\"button-create-booking\"\n                  >\n                    {createBooking.isPending ? \"Creating...\" : \"Create Booking\"}\n                  </Button>\n                </form>\n              </Form>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg flex items-center gap-2\">\n              <CreditCard className=\"h-5 w-5\" />\n              Booking Summary\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              {selectedCustomer && (\n                <div className=\"p-3 bg-muted rounded-md\">\n                  <div className=\"text-xs text-muted-foreground mb-1\">Customer</div>\n                  <div className=\"font-medium\">{selectedCustomer.name}</div>\n                  <div className=\"text-sm text-muted-foreground\">\n                    {selectedCustomer.phone}\n                  </div>\n                  {selectedCustomer.tags.includes(\"VIP\") && (\n                    <Badge className=\"mt-2 bg-amber-500 text-white\">\n                      <Star className=\"h-3 w-3 mr-1\" />\n                      VIP Customer\n                    </Badge>\n                  )}\n                </div>\n              )}\n\n              {selectedCourt && (\n                <div className=\"p-3 bg-muted rounded-md\">\n                  <div className=\"text-xs text-muted-foreground mb-1\">Court</div>\n                  <div className=\"font-medium\">{selectedCourt.name}</div>\n                  <div className=\"text-sm text-muted-foreground\">\n                    {selectedCourt.sport}\n                  </div>\n                </div>\n              )}\n\n              {startTime && endTime && (\n                <div className=\"p-3 bg-muted rounded-md\">\n                  <div className=\"text-xs text-muted-foreground mb-1\">Time Slot</div>\n                  <div className=\"font-medium flex items-center gap-2\">\n                    <Clock className=\"h-4 w-4\" />\n                    {startTime} - {endTime}\n                  </div>\n                  <div className=\"text-sm text-muted-foreground\">\n                    {duration} minutes\n                  </div>\n                </div>\n              )}\n\n              <div className=\"border-t pt-4\">\n                <div className=\"flex justify-between items-center text-lg\">\n                  <span className=\"font-medium\">Total Amount</span>\n                  <span className=\"font-bold text-primary\">₹{totalPrice}</span>\n                </div>\n                <div className=\"flex justify-between items-center text-sm text-muted-foreground mt-1\">\n                  <span>Balance Due</span>\n                  <span>\n                    ₹{Math.max(0, totalPrice - (form.watch(\"paidAmount\") || 0))}\n                  </span>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      <HighRiskWarningDialog\n        customer={highRiskWarning}\n        open={!!highRiskWarning}\n        onConfirm={confirmHighRiskBooking}\n        onCancel={() => setHighRiskWarning(null)}\n      />\n\n      <BookingConfirmationDialog\n        booking={confirmedBooking}\n        court={selectedCourt || null}\n        customer={selectedCustomer || null}\n        open={!!confirmedBooking}\n        onClose={() => setConfirmedBooking(null)}\n      />\n    </div>\n  );\n}\n","path":null,"size_bytes":25005,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1209,"size_tokens":null},"client/src/pages/settings.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Separator } from \"@/components/ui/separator\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n  FormDescription,\n} from \"@/components/ui/form\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Building,\n  Plus,\n  Edit,\n  Trash2,\n  LayoutGrid,\n  Bell,\n  MessageCircle,\n  Shield,\n  CreditCard,\n} from \"lucide-react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport type { Court } from \"@shared/schema\";\nimport { insertCourtSchema } from \"@shared/schema\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { SPORTS } from \"@/lib/constants\";\n\nconst courtFormSchema = insertCourtSchema.extend({\n  name: z.string().min(2, \"Name must be at least 2 characters\"),\n  sport: z.string().min(1, \"Please select a sport\"),\n  hourlyRate: z.coerce.number().positive(\"Rate must be positive\"),\n  peakHourlyRate: z.coerce.number().optional(),\n});\n\ntype CourtFormValues = z.infer<typeof courtFormSchema>;\n\nfunction CourtDialog({\n  court,\n  open,\n  onClose,\n}: {\n  court?: Court | null;\n  open: boolean;\n  onClose: () => void;\n}) {\n  const { toast } = useToast();\n  const isEditing = !!court;\n\n  const form = useForm<CourtFormValues>({\n    resolver: zodResolver(courtFormSchema),\n    defaultValues: court\n      ? {\n          name: court.name,\n          sport: court.sport,\n          description: court.description || \"\",\n          hourlyRate: Number(court.hourlyRate),\n          peakHourlyRate: court.peakHourlyRate ? Number(court.peakHourlyRate) : undefined,\n          isActive: court.isActive,\n        }\n      : {\n          name: \"\",\n          sport: \"\",\n          description: \"\",\n          hourlyRate: 500,\n          peakHourlyRate: undefined,\n          isActive: true,\n        },\n  });\n\n  const mutation = useMutation({\n    mutationFn: async (data: CourtFormValues) => {\n      const payload = {\n        ...data,\n        hourlyRate: data.hourlyRate.toString(),\n        peakHourlyRate: data.peakHourlyRate?.toString() || null,\n      };\n\n      if (isEditing) {\n        return apiRequest(\"PATCH\", `/api/courts/${court.id}`, payload);\n      }\n      return apiRequest(\"POST\", \"/api/courts\", payload);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/courts\"] });\n      toast({ title: isEditing ? \"Court updated\" : \"Court added\" });\n      form.reset();\n      onClose();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: isEditing ? \"Failed to update court\" : \"Failed to add court\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: CourtFormValues) => {\n    mutation.mutate(data);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>{isEditing ? \"Edit Court\" : \"Add New Court\"}</DialogTitle>\n          <DialogDescription>\n            {isEditing ? \"Update court details\" : \"Add a new court or playing area\"}\n          </DialogDescription>\n        </DialogHeader>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"name\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Court Name</FormLabel>\n                  <FormControl>\n                    <Input placeholder=\"e.g., Court 1, Main Turf\" {...field} data-testid=\"input-court-name\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"sport\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Sport</FormLabel>\n                  <Select onValueChange={field.onChange} value={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-court-sport\">\n                        <SelectValue placeholder=\"Select sport\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      {SPORTS.map((sport) => (\n                        <SelectItem key={sport.value} value={sport.value}>\n                          {sport.label}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"hourlyRate\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Hourly Rate (₹)</FormLabel>\n                    <FormControl>\n                      <Input type=\"number\" {...field} data-testid=\"input-hourly-rate\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"peakHourlyRate\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Peak Rate (₹)</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"number\"\n                        placeholder=\"Optional\"\n                        {...field}\n                        value={field.value || \"\"}\n                        data-testid=\"input-peak-rate\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <FormField\n              control={form.control}\n              name=\"description\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Description (Optional)</FormLabel>\n                  <FormControl>\n                    <Input\n                      placeholder=\"Court details...\"\n                      {...field}\n                      value={field.value || \"\"}\n                      data-testid=\"input-court-description\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"isActive\"\n              render={({ field }) => (\n                <FormItem className=\"flex items-center justify-between rounded-lg border p-3\">\n                  <div className=\"space-y-0.5\">\n                    <FormLabel>Active</FormLabel>\n                    <FormDescription className=\"text-xs\">\n                      Available for bookings\n                    </FormDescription>\n                  </div>\n                  <FormControl>\n                    <Switch\n                      checked={field.value}\n                      onCheckedChange={field.onChange}\n                      data-testid=\"switch-court-active\"\n                    />\n                  </FormControl>\n                </FormItem>\n              )}\n            />\n\n            <div className=\"flex justify-end gap-2\">\n              <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={mutation.isPending} data-testid=\"button-save-court\">\n                {mutation.isPending ? \"Saving...\" : isEditing ? \"Update\" : \"Add Court\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nexport default function Settings() {\n  const { toast } = useToast();\n  const [courtDialogOpen, setCourtDialogOpen] = useState(false);\n  const [editingCourt, setEditingCourt] = useState<Court | null>(null);\n\n  const { data: courts, isLoading } = useQuery<Court[]>({\n    queryKey: [\"/api/courts\"],\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return apiRequest(\"DELETE\", `/api/courts/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/courts\"] });\n      toast({ title: \"Court deleted\" });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to delete court\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-2xl font-semibold\">Settings</h1>\n        <p className=\"text-muted-foreground text-sm\">Manage your venue configuration</p>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        <div className=\"lg:col-span-2 space-y-6\">\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between gap-4\">\n              <div>\n                <CardTitle className=\"text-lg flex items-center gap-2\">\n                  <LayoutGrid className=\"h-5 w-5\" />\n                  Courts & Playing Areas\n                </CardTitle>\n                <CardDescription>\n                  Manage your bookable courts and turfs\n                </CardDescription>\n              </div>\n              <Button\n                onClick={() => {\n                  setEditingCourt(null);\n                  setCourtDialogOpen(true);\n                }}\n                data-testid=\"button-add-court\"\n              >\n                <Plus className=\"h-4 w-4 mr-2\" />\n                Add Court\n              </Button>\n            </CardHeader>\n            <CardContent>\n              {isLoading ? (\n                <div className=\"space-y-3\">\n                  {[1, 2, 3].map((i) => (\n                    <Skeleton key={i} className=\"h-16 w-full\" />\n                  ))}\n                </div>\n              ) : (\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>Name</TableHead>\n                      <TableHead>Sport</TableHead>\n                      <TableHead className=\"text-right\">Rate</TableHead>\n                      <TableHead>Status</TableHead>\n                      <TableHead></TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {courts?.map((court) => (\n                      <TableRow key={court.id} data-testid={`court-row-${court.id}`}>\n                        <TableCell className=\"font-medium\">{court.name}</TableCell>\n                        <TableCell className=\"capitalize\">{court.sport}</TableCell>\n                        <TableCell className=\"text-right\">\n                          ₹{court.hourlyRate}/hr\n                          {court.peakHourlyRate && (\n                            <span className=\"text-muted-foreground text-xs block\">\n                              Peak: ₹{court.peakHourlyRate}/hr\n                            </span>\n                          )}\n                        </TableCell>\n                        <TableCell>\n                          <Badge\n                            variant={court.isActive ? \"default\" : \"secondary\"}\n                            className=\"text-xs\"\n                          >\n                            {court.isActive ? \"Active\" : \"Inactive\"}\n                          </Badge>\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"flex items-center gap-1\">\n                            <Button\n                              variant=\"ghost\"\n                              size=\"icon\"\n                              onClick={() => {\n                                setEditingCourt(court);\n                                setCourtDialogOpen(true);\n                              }}\n                              data-testid={`button-edit-court-${court.id}`}\n                            >\n                              <Edit className=\"h-4 w-4\" />\n                            </Button>\n                            <Button\n                              variant=\"ghost\"\n                              size=\"icon\"\n                              onClick={() => deleteMutation.mutate(court.id)}\n                              disabled={deleteMutation.isPending}\n                              data-testid={`button-delete-court-${court.id}`}\n                            >\n                              <Trash2 className=\"h-4 w-4 text-destructive\" />\n                            </Button>\n                          </div>\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              )}\n\n              {(!courts || courts.length === 0) && !isLoading && (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  <LayoutGrid className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                  <p>No courts configured</p>\n                  <Button\n                    variant=\"link\"\n                    className=\"mt-2\"\n                    onClick={() => {\n                      setEditingCourt(null);\n                      setCourtDialogOpen(true);\n                    }}\n                    data-testid=\"link-add-first-court\"\n                  >\n                    Add your first court\n                  </Button>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"space-y-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg flex items-center gap-2\">\n                <Building className=\"h-5 w-5\" />\n                Venue Details\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div>\n                <label className=\"text-sm font-medium\">Venue Name</label>\n                <Input\n                  defaultValue=\"My Sports Venue\"\n                  className=\"mt-1\"\n                  data-testid=\"input-venue-name\"\n                />\n              </div>\n              <div>\n                <label className=\"text-sm font-medium\">Contact Number</label>\n                <Input\n                  defaultValue=\"+91 98765 43210\"\n                  className=\"mt-1\"\n                  data-testid=\"input-venue-phone\"\n                />\n              </div>\n              <Button className=\"w-full\" data-testid=\"button-save-venue\">\n                Save Changes\n              </Button>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg flex items-center gap-2\">\n                <MessageCircle className=\"h-5 w-5\" />\n                WhatsApp Integration\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium\">Booking Confirmations</p>\n                  <p className=\"text-xs text-muted-foreground\">\n                    Send booking details via WhatsApp\n                  </p>\n                </div>\n                <Switch defaultChecked data-testid=\"switch-whatsapp-bookings\" />\n              </div>\n              <Separator />\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium\">Payment Reminders</p>\n                  <p className=\"text-xs text-muted-foreground\">\n                    Send payment links for pending dues\n                  </p>\n                </div>\n                <Switch defaultChecked data-testid=\"switch-whatsapp-payments\" />\n              </div>\n              <Separator />\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium\">Slot Reminders</p>\n                  <p className=\"text-xs text-muted-foreground\">\n                    Remind customers 1 hour before\n                  </p>\n                </div>\n                <Switch defaultChecked data-testid=\"switch-whatsapp-reminders\" />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg flex items-center gap-2\">\n                <CreditCard className=\"h-5 w-5\" />\n                Commission Settings\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"p-3 bg-muted rounded-md\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm\">Platform Commission</span>\n                  <Badge variant=\"secondary\">5%</Badge>\n                </div>\n                <p className=\"text-xs text-muted-foreground mt-1\">\n                  Applied on cash payments only\n                </p>\n              </div>\n              <p className=\"text-xs text-muted-foreground\">\n                Online payments are processed directly with no additional commission.\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n\n      <CourtDialog\n        court={editingCourt}\n        open={courtDialogOpen}\n        onClose={() => {\n          setCourtDialogOpen(false);\n          setEditingCourt(null);\n        }}\n      />\n    </div>\n  );\n}\n","path":null,"size_bytes":18342,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":261,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic } from \"./static\";\nimport { createServer } from \"http\";\nimport { setupAuth, registerAuthRoutes } from \"./replit_integrations/auth\";\n\nconst app = express();\nconst httpServer = createServer(app);\n\ndeclare module \"http\" {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\n\napp.use(\n  express.json({\n    verify: (req, _res, buf) => {\n      req.rawBody = buf;\n    },\n  }),\n);\n\napp.use(express.urlencoded({ extended: false }));\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  // Setup auth BEFORE other routes\n  await setupAuth(app);\n  registerAuthRoutes(app);\n  \n  await registerRoutes(httpServer, app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (process.env.NODE_ENV === \"production\") {\n    serveStatic(app);\n  } else {\n    const { setupVite } = await import(\"./vite\");\n    await setupVite(httpServer, app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  httpServer.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      reusePort: true,\n    },\n    () => {\n      log(`serving on port ${port}`);\n    },\n  );\n})();\n","path":null,"size_bytes":2726,"size_tokens":null},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, integer, boolean, timestamp, decimal, jsonb } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\nimport { relations } from \"drizzle-orm\";\n\n// Re-export auth schema (includes users table)\nexport * from \"./models/auth\";\nimport { users, type User } from \"./models/auth\";\n\n// Courts/Turfs table\nexport const courts = pgTable(\"courts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  sport: text(\"sport\").notNull(), // cricket, football, badminton, tennis\n  description: text(\"description\"),\n  hourlyRate: decimal(\"hourly_rate\", { precision: 10, scale: 2 }).notNull(),\n  peakHourlyRate: decimal(\"peak_hourly_rate\", { precision: 10, scale: 2 }),\n  isActive: boolean(\"is_active\").notNull().default(true),\n  imageUrl: text(\"image_url\"),\n});\n\n// Customers table (CRM)\nexport const customers = pgTable(\"customers\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  phone: text(\"phone\").notNull().unique(),\n  email: text(\"email\"),\n  totalSpend: decimal(\"total_spend\", { precision: 10, scale: 2 }).notNull().default(\"0\"),\n  totalBookings: integer(\"total_bookings\").notNull().default(0),\n  noShowCount: integer(\"no_show_count\").notNull().default(0),\n  tags: text(\"tags\").array().notNull().default(sql`ARRAY[]::text[]`), // VIP, HIGH_RISK, REGULAR\n  notes: text(\"notes\"),\n  isBlacklisted: boolean(\"is_blacklisted\").notNull().default(false),\n  source: text(\"source\").notNull().default(\"walkin\"), // app, walkin, website\n});\n\n// Bookings table\nexport const bookings = pgTable(\"bookings\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  courtId: varchar(\"court_id\").notNull().references(() => courts.id),\n  customerId: varchar(\"customer_id\").notNull().references(() => customers.id),\n  bookedById: varchar(\"booked_by_id\").references(() => users.id), // staff who made the booking\n  date: text(\"date\").notNull(), // YYYY-MM-DD\n  startTime: text(\"start_time\").notNull(), // HH:MM\n  endTime: text(\"end_time\").notNull(), // HH:MM\n  duration: integer(\"duration\").notNull(), // in minutes\n  totalAmount: decimal(\"total_amount\", { precision: 10, scale: 2 }).notNull(),\n  paidAmount: decimal(\"paid_amount\", { precision: 10, scale: 2 }).notNull().default(\"0\"),\n  paymentStatus: text(\"payment_status\").notNull().default(\"pending\"), // pending, partial, paid\n  paymentMethod: text(\"payment_method\"), // cash, upi, card, online\n  status: text(\"status\").notNull().default(\"confirmed\"), // confirmed, checked_in, completed, cancelled, no_show\n  qrCode: text(\"qr_code\"),\n  notes: text(\"notes\"),\n  isTeamBooking: boolean(\"is_team_booking\").notNull().default(false),\n  teamName: text(\"team_name\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\n// Transactions table\nexport const transactions = pgTable(\"transactions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  bookingId: varchar(\"booking_id\").references(() => bookings.id),\n  customerId: varchar(\"customer_id\").references(() => customers.id),\n  type: text(\"type\").notNull(), // booking_payment, refund, settlement\n  amount: decimal(\"amount\", { precision: 10, scale: 2 }).notNull(),\n  paymentMethod: text(\"payment_method\").notNull(), // cash, upi, card, online\n  status: text(\"status\").notNull().default(\"completed\"), // pending, completed, failed\n  notes: text(\"notes\"),\n  processedById: varchar(\"processed_by_id\").references(() => users.id),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\n// Settlements table (commission payments to platform)\nexport const settlements = pgTable(\"settlements\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  amount: decimal(\"amount\", { precision: 10, scale: 2 }).notNull(),\n  commissionRate: decimal(\"commission_rate\", { precision: 5, scale: 2 }).notNull().default(\"5.00\"),\n  status: text(\"status\").notNull().default(\"pending\"), // pending, paid\n  periodStart: text(\"period_start\").notNull(),\n  periodEnd: text(\"period_end\").notNull(),\n  totalBookings: integer(\"total_bookings\").notNull().default(0),\n  totalCashReceived: decimal(\"total_cash_received\", { precision: 10, scale: 2 }).notNull().default(\"0\"),\n  paidAt: timestamp(\"paid_at\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\n// Waitlist table\nexport const waitlist = pgTable(\"waitlist\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  courtId: varchar(\"court_id\").notNull().references(() => courts.id),\n  customerId: varchar(\"customer_id\").notNull().references(() => customers.id),\n  date: text(\"date\").notNull(),\n  preferredStartTime: text(\"preferred_start_time\").notNull(),\n  preferredEndTime: text(\"preferred_end_time\").notNull(),\n  status: text(\"status\").notNull().default(\"waiting\"), // waiting, notified, booked, expired\n  notifiedAt: timestamp(\"notified_at\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\n// Blocked slots table (maintenance, private events)\nexport const blockedSlots = pgTable(\"blocked_slots\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  courtId: varchar(\"court_id\").notNull().references(() => courts.id),\n  date: text(\"date\").notNull(),\n  startTime: text(\"start_time\").notNull(),\n  endTime: text(\"end_time\").notNull(),\n  reason: text(\"reason\").notNull(),\n  blockedById: varchar(\"blocked_by_id\").references(() => users.id),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\n// Tournaments table\nexport const tournaments = pgTable(\"tournaments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  sport: text(\"sport\").notNull(),\n  entryFee: decimal(\"entry_fee\", { precision: 10, scale: 2 }).notNull().default(\"0\"),\n  maxTeams: integer(\"max_teams\").notNull(),\n  startDate: text(\"start_date\").notNull(),\n  endDate: text(\"end_date\").notNull(),\n  status: text(\"status\").notNull().default(\"upcoming\"), // upcoming, ongoing, completed\n  description: text(\"description\"),\n  prizePool: decimal(\"prize_pool\", { precision: 10, scale: 2 }),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\n// Tournament teams table\nexport const tournamentTeams = pgTable(\"tournament_teams\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tournamentId: varchar(\"tournament_id\").notNull().references(() => tournaments.id),\n  name: text(\"name\").notNull(),\n  captainId: varchar(\"captain_id\").references(() => customers.id),\n  players: jsonb(\"players\").notNull().default(sql`'[]'::jsonb`), // array of player names\n  isPaid: boolean(\"is_paid\").notNull().default(false),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\n// Maintenance log table\nexport const maintenanceLogs = pgTable(\"maintenance_logs\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  courtId: varchar(\"court_id\").notNull().references(() => courts.id),\n  issue: text(\"issue\").notNull(),\n  description: text(\"description\"),\n  photoUrl: text(\"photo_url\"),\n  status: text(\"status\").notNull().default(\"reported\"), // reported, in_progress, resolved\n  reportedById: varchar(\"reported_by_id\").references(() => users.id),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  resolvedAt: timestamp(\"resolved_at\"),\n});\n\n// Expenses table\nexport const expenses = pgTable(\"expenses\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  category: text(\"category\").notNull(), // electricity, staff, maintenance, other\n  amount: decimal(\"amount\", { precision: 10, scale: 2 }).notNull(),\n  description: text(\"description\"),\n  date: text(\"date\").notNull(),\n  addedById: varchar(\"added_by_id\").references(() => users.id),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\n// Membership Plans table\nexport const membershipPlans = pgTable(\"membership_plans\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  durationDays: integer(\"duration_days\").notNull(), // 30, 90, 365 etc.\n  price: decimal(\"price\", { precision: 10, scale: 2 }).notNull(),\n  discountPercent: integer(\"discount_percent\").notNull().default(0), // booking discount\n  freeHours: integer(\"free_hours\").notNull().default(0), // free playing hours per month\n  priority: boolean(\"priority\").notNull().default(false), // priority booking\n  isActive: boolean(\"is_active\").notNull().default(true),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\n// Customer Memberships table  \nexport const memberships = pgTable(\"memberships\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  customerId: varchar(\"customer_id\").notNull().references(() => customers.id),\n  planId: varchar(\"plan_id\").notNull().references(() => membershipPlans.id),\n  startDate: text(\"start_date\").notNull(), // YYYY-MM-DD\n  endDate: text(\"end_date\").notNull(), // YYYY-MM-DD\n  status: text(\"status\").notNull().default(\"active\"), // active, expired, cancelled\n  usedFreeHours: integer(\"used_free_hours\").notNull().default(0),\n  paidAmount: decimal(\"paid_amount\", { precision: 10, scale: 2 }).notNull(),\n  paymentMethod: text(\"payment_method\"), // cash, upi, card, online\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\n// Loyalty Points table\nexport const loyaltyPoints = pgTable(\"loyalty_points\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  customerId: varchar(\"customer_id\").notNull().references(() => customers.id),\n  type: text(\"type\").notNull(), // earned, redeemed, expired\n  points: integer(\"points\").notNull(), // positive for earned, negative for redeemed\n  description: text(\"description\").notNull(),\n  bookingId: varchar(\"booking_id\").references(() => bookings.id),\n  expiresAt: timestamp(\"expires_at\"), // loyalty points expiry\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\n// Relations\nexport const courtsRelations = relations(courts, ({ many }) => ({\n  bookings: many(bookings),\n  waitlist: many(waitlist),\n  blockedSlots: many(blockedSlots),\n  maintenanceLogs: many(maintenanceLogs),\n}));\n\nexport const customersRelations = relations(customers, ({ many }) => ({\n  bookings: many(bookings),\n  transactions: many(transactions),\n  waitlist: many(waitlist),\n}));\n\nexport const bookingsRelations = relations(bookings, ({ one, many }) => ({\n  court: one(courts, { fields: [bookings.courtId], references: [courts.id] }),\n  customer: one(customers, { fields: [bookings.customerId], references: [customers.id] }),\n  bookedBy: one(users, { fields: [bookings.bookedById], references: [users.id] }),\n  transactions: many(transactions),\n}));\n\nexport const transactionsRelations = relations(transactions, ({ one }) => ({\n  booking: one(bookings, { fields: [transactions.bookingId], references: [bookings.id] }),\n  customer: one(customers, { fields: [transactions.customerId], references: [customers.id] }),\n  processedBy: one(users, { fields: [transactions.processedById], references: [users.id] }),\n}));\n\nexport const tournamentsRelations = relations(tournaments, ({ many }) => ({\n  teams: many(tournamentTeams),\n}));\n\nexport const tournamentTeamsRelations = relations(tournamentTeams, ({ one }) => ({\n  tournament: one(tournaments, { fields: [tournamentTeams.tournamentId], references: [tournaments.id] }),\n  captain: one(customers, { fields: [tournamentTeams.captainId], references: [customers.id] }),\n}));\n\nexport const membershipPlansRelations = relations(membershipPlans, ({ many }) => ({\n  memberships: many(memberships),\n}));\n\nexport const membershipsRelations = relations(memberships, ({ one }) => ({\n  customer: one(customers, { fields: [memberships.customerId], references: [customers.id] }),\n  plan: one(membershipPlans, { fields: [memberships.planId], references: [membershipPlans.id] }),\n}));\n\nexport const loyaltyPointsRelations = relations(loyaltyPoints, ({ one }) => ({\n  customer: one(customers, { fields: [loyaltyPoints.customerId], references: [customers.id] }),\n  booking: one(bookings, { fields: [loyaltyPoints.bookingId], references: [bookings.id] }),\n}));\n\n// Insert schemas\nexport const insertCourtSchema = createInsertSchema(courts).omit({ id: true });\nexport const insertCustomerSchema = createInsertSchema(customers).omit({ id: true, totalSpend: true, totalBookings: true, noShowCount: true });\nexport const insertBookingSchema = createInsertSchema(bookings).omit({ id: true, createdAt: true });\nexport const insertTransactionSchema = createInsertSchema(transactions).omit({ id: true, createdAt: true });\nexport const insertSettlementSchema = createInsertSchema(settlements).omit({ id: true, createdAt: true, paidAt: true });\nexport const insertWaitlistSchema = createInsertSchema(waitlist).omit({ id: true, createdAt: true, notifiedAt: true });\nexport const insertBlockedSlotSchema = createInsertSchema(blockedSlots).omit({ id: true, createdAt: true });\nexport const insertTournamentSchema = createInsertSchema(tournaments).omit({ id: true, createdAt: true });\nexport const insertTournamentTeamSchema = createInsertSchema(tournamentTeams).omit({ id: true, createdAt: true });\nexport const insertMaintenanceLogSchema = createInsertSchema(maintenanceLogs).omit({ id: true, createdAt: true, resolvedAt: true });\nexport const insertExpenseSchema = createInsertSchema(expenses).omit({ id: true, createdAt: true });\nexport const insertMembershipPlanSchema = createInsertSchema(membershipPlans).omit({ id: true, createdAt: true });\nexport const insertMembershipSchema = createInsertSchema(memberships).omit({ id: true, createdAt: true });\nexport const insertLoyaltyPointsSchema = createInsertSchema(loyaltyPoints).omit({ id: true, createdAt: true });\n\n// Types\nexport type InsertCourt = z.infer<typeof insertCourtSchema>;\nexport type Court = typeof courts.$inferSelect;\nexport type InsertCustomer = z.infer<typeof insertCustomerSchema>;\nexport type Customer = typeof customers.$inferSelect;\nexport type InsertBooking = z.infer<typeof insertBookingSchema>;\nexport type Booking = typeof bookings.$inferSelect;\nexport type InsertTransaction = z.infer<typeof insertTransactionSchema>;\nexport type Transaction = typeof transactions.$inferSelect;\nexport type InsertSettlement = z.infer<typeof insertSettlementSchema>;\nexport type Settlement = typeof settlements.$inferSelect;\nexport type InsertWaitlist = z.infer<typeof insertWaitlistSchema>;\nexport type Waitlist = typeof waitlist.$inferSelect;\nexport type InsertBlockedSlot = z.infer<typeof insertBlockedSlotSchema>;\nexport type BlockedSlot = typeof blockedSlots.$inferSelect;\nexport type InsertTournament = z.infer<typeof insertTournamentSchema>;\nexport type Tournament = typeof tournaments.$inferSelect;\nexport type InsertTournamentTeam = z.infer<typeof insertTournamentTeamSchema>;\nexport type TournamentTeam = typeof tournamentTeams.$inferSelect;\nexport type InsertMaintenanceLog = z.infer<typeof insertMaintenanceLogSchema>;\nexport type MaintenanceLog = typeof maintenanceLogs.$inferSelect;\nexport type InsertExpense = z.infer<typeof insertExpenseSchema>;\nexport type Expense = typeof expenses.$inferSelect;\nexport type InsertMembershipPlan = z.infer<typeof insertMembershipPlanSchema>;\nexport type MembershipPlan = typeof membershipPlans.$inferSelect;\nexport type InsertMembership = z.infer<typeof insertMembershipSchema>;\nexport type Membership = typeof memberships.$inferSelect;\nexport type InsertLoyaltyPoints = z.infer<typeof insertLoyaltyPointsSchema>;\nexport type LoyaltyPoints = typeof loyaltyPoints.$inferSelect;\n\n// Extended types for frontend\nexport type BookingWithDetails = Booking & {\n  court?: Court;\n  customer?: Customer;\n  bookedBy?: User;\n};\n\nexport type CustomerWithStats = Customer & {\n  reliabilityScore: number;\n  isVip: boolean;\n  isHighRisk: boolean;\n};\n\nexport type MembershipWithPlan = Membership & {\n  plan?: MembershipPlan;\n  customer?: Customer;\n};\n\nexport type CustomerLoyalty = {\n  customerId: string;\n  totalPoints: number;\n  availablePoints: number;\n  pendingPoints: number;\n  lifetimeEarned: number;\n  lifetimeRedeemed: number;\n};\n\n// Dashboard stats type\nexport type DashboardStats = {\n  totalBookingsToday: number;\n  totalRevenueToday: number;\n  occupiedCourts: number;\n  totalCourts: number;\n  pendingCheckIns: number;\n  pendingPayments: number;\n  weeklyRevenue: { day: string; revenue: number }[];\n  peakHours: { hour: string; bookings: number }[];\n};\n\n// Settlement summary type\nexport type SettlementSummary = {\n  totalEarnings: number;\n  totalSettled: number;\n  amountDue: number;\n  commissionRate: number;\n  pendingSettlements: Settlement[];\n};\n","path":null,"size_bytes":16643,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Link } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Home, ArrowLeft } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen flex items-center justify-center p-6 bg-background\">\n      <Card className=\"max-w-md w-full\">\n        <CardContent className=\"py-12 text-center\">\n          <h1 className=\"text-6xl font-bold text-primary mb-4\">404</h1>\n          <h2 className=\"text-xl font-semibold mb-2\">Page Not Found</h2>\n          <p className=\"text-muted-foreground mb-6\">\n            The page you're looking for doesn't exist or has been moved.\n          </p>\n          <div className=\"flex justify-center gap-3\">\n            <Link href=\"/\">\n              <Button data-testid=\"link-go-home\">\n                <Home className=\"h-4 w-4 mr-2\" />\n                Go Home\n              </Button>\n            </Link>\n            <Button\n              variant=\"outline\"\n              onClick={() => window.history.back()}\n              data-testid=\"button-go-back\"\n            >\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Go Back\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":1280,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8605,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"client/src/pages/tournaments.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Trophy,\n  Plus,\n  Users,\n  Calendar,\n  DollarSign,\n  Play,\n  CheckCircle,\n  Clock,\n  Target,\n} from \"lucide-react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { format } from \"date-fns\";\nimport type { Tournament, TournamentTeam } from \"@shared/schema\";\nimport { insertTournamentSchema } from \"@shared/schema\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { SPORTS } from \"@/lib/constants\";\n\nconst tournamentFormSchema = insertTournamentSchema.extend({\n  name: z.string().min(2, \"Name must be at least 2 characters\"),\n  sport: z.string().min(1, \"Please select a sport\"),\n  maxTeams: z.coerce.number().min(2, \"Minimum 2 teams required\"),\n  entryFee: z.coerce.number().min(0).optional(),\n  prizePool: z.coerce.number().min(0).optional(),\n  startDate: z.string().min(1, \"Please select a start date\"),\n  endDate: z.string().min(1, \"Please select an end date\"),\n});\n\ntype TournamentFormValues = z.infer<typeof tournamentFormSchema>;\n\nfunction TournamentStatusBadge({ status }: { status: string }) {\n  const variants: Record<string, { icon: React.ElementType; className: string; label: string }> = {\n    upcoming: {\n      icon: Clock,\n      className: \"bg-blue-500/20 text-blue-700 dark:text-blue-400 border-blue-500/30\",\n      label: \"Upcoming\",\n    },\n    ongoing: {\n      icon: Play,\n      className: \"bg-green-500/20 text-green-700 dark:text-green-400 border-green-500/30\",\n      label: \"Ongoing\",\n    },\n    completed: {\n      icon: CheckCircle,\n      className: \"bg-gray-500/20 text-gray-700 dark:text-gray-400 border-gray-500/30\",\n      label: \"Completed\",\n    },\n  };\n\n  const variant = variants[status] || variants.upcoming;\n  const Icon = variant.icon;\n\n  return (\n    <Badge variant=\"outline\" className={`${variant.className} text-xs`}>\n      <Icon className=\"h-3 w-3 mr-1\" />\n      {variant.label}\n    </Badge>\n  );\n}\n\nfunction TournamentCard({ tournament }: { tournament: Tournament }) {\n  const { data: teams } = useQuery<TournamentTeam[]>({\n    queryKey: [\"/api/tournaments\", tournament.id, \"teams\"],\n  });\n\n  const registeredTeams = teams?.length || 0;\n  const spotsLeft = tournament.maxTeams - registeredTeams;\n\n  return (\n    <Card className=\"hover-elevate cursor-pointer\" data-testid={`tournament-card-${tournament.id}`}>\n      <CardContent className=\"p-6\">\n        <div className=\"flex items-start justify-between mb-4\">\n          <div>\n            <h3 className=\"font-semibold text-lg\">{tournament.name}</h3>\n            <p className=\"text-sm text-muted-foreground\">{tournament.sport}</p>\n          </div>\n          <TournamentStatusBadge status={tournament.status} />\n        </div>\n\n        <div className=\"grid grid-cols-2 gap-4 mb-4\">\n          <div className=\"flex items-center gap-2 text-sm\">\n            <Calendar className=\"h-4 w-4 text-muted-foreground\" />\n            <span>{tournament.startDate}</span>\n          </div>\n          <div className=\"flex items-center gap-2 text-sm\">\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\n            <span>\n              {registeredTeams}/{tournament.maxTeams} teams\n            </span>\n          </div>\n          {tournament.entryFee && Number(tournament.entryFee) > 0 && (\n            <div className=\"flex items-center gap-2 text-sm\">\n              <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\n              <span>₹{tournament.entryFee} entry</span>\n            </div>\n          )}\n          {tournament.prizePool && Number(tournament.prizePool) > 0 && (\n            <div className=\"flex items-center gap-2 text-sm\">\n              <Trophy className=\"h-4 w-4 text-muted-foreground\" />\n              <span>₹{tournament.prizePool} prize</span>\n            </div>\n          )}\n        </div>\n\n        {tournament.status === \"upcoming\" && spotsLeft > 0 && (\n          <div className=\"flex items-center justify-between p-3 bg-muted rounded-md\">\n            <span className=\"text-sm\">\n              {spotsLeft} spot{spotsLeft !== 1 ? \"s\" : \"\"} remaining\n            </span>\n            <Button size=\"sm\" data-testid=\"button-view-tournament\">\n              View Details\n            </Button>\n          </div>\n        )}\n\n        {tournament.status === \"ongoing\" && (\n          <Button className=\"w-full\" variant=\"outline\" data-testid=\"button-update-scores\">\n            <Target className=\"h-4 w-4 mr-2\" />\n            Update Scores\n          </Button>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction CreateTournamentDialog({\n  open,\n  onClose,\n}: {\n  open: boolean;\n  onClose: () => void;\n}) {\n  const { toast } = useToast();\n\n  const form = useForm<TournamentFormValues>({\n    resolver: zodResolver(tournamentFormSchema),\n    defaultValues: {\n      name: \"\",\n      sport: \"\",\n      maxTeams: 8,\n      entryFee: 0,\n      prizePool: 0,\n      startDate: format(new Date(), \"yyyy-MM-dd\"),\n      endDate: format(new Date(), \"yyyy-MM-dd\"),\n      description: \"\",\n      status: \"upcoming\",\n    },\n  });\n\n  const createTournament = useMutation({\n    mutationFn: async (data: TournamentFormValues) => {\n      const response = await apiRequest(\"POST\", \"/api/tournaments\", {\n        ...data,\n        entryFee: (data.entryFee || 0).toString(),\n        prizePool: (data.prizePool || 0).toString(),\n      });\n      return response;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\"] });\n      toast({ title: \"Tournament created successfully\" });\n      form.reset();\n      onClose();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to create tournament\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: TournamentFormValues) => {\n    createTournament.mutate(data);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-md\">\n        <DialogHeader>\n          <DialogTitle>Create Tournament</DialogTitle>\n          <DialogDescription>Set up a new tournament or league</DialogDescription>\n        </DialogHeader>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"name\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Tournament Name</FormLabel>\n                  <FormControl>\n                    <Input placeholder=\"e.g., Weekend Football Cup\" {...field} data-testid=\"input-tournament-name\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"sport\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Sport</FormLabel>\n                  <Select onValueChange={field.onChange} value={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-tournament-sport\">\n                        <SelectValue placeholder=\"Select sport\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      {SPORTS.map((sport) => (\n                        <SelectItem key={sport.value} value={sport.value}>\n                          {sport.label}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"startDate\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Start Date</FormLabel>\n                    <FormControl>\n                      <Input type=\"date\" {...field} data-testid=\"input-tournament-start\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"endDate\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>End Date</FormLabel>\n                    <FormControl>\n                      <Input type=\"date\" {...field} data-testid=\"input-tournament-end\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <FormField\n              control={form.control}\n              name=\"maxTeams\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Maximum Teams</FormLabel>\n                  <FormControl>\n                    <Input type=\"number\" {...field} data-testid=\"input-max-teams\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"entryFee\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Entry Fee (₹)</FormLabel>\n                    <FormControl>\n                      <Input type=\"number\" placeholder=\"0\" {...field} data-testid=\"input-entry-fee\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"prizePool\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Prize Pool (₹)</FormLabel>\n                    <FormControl>\n                      <Input type=\"number\" placeholder=\"0\" {...field} data-testid=\"input-prize-pool\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <FormField\n              control={form.control}\n              name=\"description\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Description (Optional)</FormLabel>\n                  <FormControl>\n                    <Input\n                      placeholder=\"Tournament details...\"\n                      {...field}\n                      value={field.value || \"\"}\n                      data-testid=\"input-tournament-description\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"flex justify-end gap-2\">\n              <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={createTournament.isPending} data-testid=\"button-create-tournament\">\n                {createTournament.isPending ? \"Creating...\" : \"Create Tournament\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nexport default function Tournaments() {\n  const [createDialogOpen, setCreateDialogOpen] = useState(false);\n\n  const { data: tournaments, isLoading } = useQuery<Tournament[]>({\n    queryKey: [\"/api/tournaments\"],\n  });\n\n  const upcomingTournaments = tournaments?.filter((t) => t.status === \"upcoming\") || [];\n  const ongoingTournaments = tournaments?.filter((t) => t.status === \"ongoing\") || [];\n  const completedTournaments = tournaments?.filter((t) => t.status === \"completed\") || [];\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n        <div>\n          <h1 className=\"text-2xl font-semibold\">Tournaments</h1>\n          <p className=\"text-muted-foreground text-sm\">\n            Manage tournaments, leagues, and team registrations\n          </p>\n        </div>\n        <Button onClick={() => setCreateDialogOpen(true)} data-testid=\"button-create-tournament\">\n          <Plus className=\"h-4 w-4 mr-2\" />\n          Create Tournament\n        </Button>\n      </div>\n\n      {isLoading ? (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {[1, 2, 3].map((i) => (\n            <Skeleton key={i} className=\"h-64\" />\n          ))}\n        </div>\n      ) : (\n        <>\n          {ongoingTournaments.length > 0 && (\n            <div>\n              <h2 className=\"text-lg font-semibold mb-4 flex items-center gap-2\">\n                <Play className=\"h-5 w-5 text-green-500\" />\n                Ongoing Tournaments\n              </h2>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {ongoingTournaments.map((tournament) => (\n                  <TournamentCard key={tournament.id} tournament={tournament} />\n                ))}\n              </div>\n            </div>\n          )}\n\n          {upcomingTournaments.length > 0 && (\n            <div>\n              <h2 className=\"text-lg font-semibold mb-4 flex items-center gap-2\">\n                <Clock className=\"h-5 w-5 text-blue-500\" />\n                Upcoming Tournaments\n              </h2>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {upcomingTournaments.map((tournament) => (\n                  <TournamentCard key={tournament.id} tournament={tournament} />\n                ))}\n              </div>\n            </div>\n          )}\n\n          {completedTournaments.length > 0 && (\n            <div>\n              <h2 className=\"text-lg font-semibold mb-4 flex items-center gap-2\">\n                <CheckCircle className=\"h-5 w-5 text-gray-500\" />\n                Completed Tournaments\n              </h2>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {completedTournaments.map((tournament) => (\n                  <TournamentCard key={tournament.id} tournament={tournament} />\n                ))}\n              </div>\n            </div>\n          )}\n\n          {(!tournaments || tournaments.length === 0) && (\n            <Card>\n              <CardContent className=\"py-12 text-center\">\n                <Trophy className=\"h-12 w-12 mx-auto mb-4 text-muted-foreground opacity-50\" />\n                <h3 className=\"text-lg font-semibold mb-2\">No Tournaments Yet</h3>\n                <p className=\"text-muted-foreground text-sm mb-4\">\n                  Create your first tournament to get started\n                </p>\n                <Button onClick={() => setCreateDialogOpen(true)} data-testid=\"button-create-first-tournament\">\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  Create Tournament\n                </Button>\n              </CardContent>\n            </Card>\n          )}\n        </>\n      )}\n\n      <CreateTournamentDialog\n        open={createDialogOpen}\n        onClose={() => setCreateDialogOpen(false)}\n      />\n    </div>\n  );\n}\n","path":null,"size_bytes":16028,"size_tokens":null},"client/src/pages/memberships.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { \n  Plus, Crown, Gift, CreditCard, Calendar, Users, \n  Loader2, Star, Percent, Clock, TrendingUp,\n  Award, Coins, Sparkles\n} from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { format } from \"date-fns\";\nimport type { MembershipPlan, Customer, MembershipWithPlan } from \"@shared/schema\";\n\nexport default function Memberships() {\n  const { toast } = useToast();\n  const { user } = useAuth();\n  const isOwner = user?.role === \"owner\";\n  const [activeTab, setActiveTab] = useState(\"memberships\");\n  const [isAddPlanOpen, setIsAddPlanOpen] = useState(false);\n  const [isAddMembershipOpen, setIsAddMembershipOpen] = useState(false);\n\n  const { data: plans = [], isLoading: plansLoading } = useQuery<MembershipPlan[]>({\n    queryKey: [\"/api/membership-plans\"],\n  });\n\n  const { data: memberships = [], isLoading: membershipsLoading } = useQuery<MembershipWithPlan[]>({\n    queryKey: [\"/api/memberships\"],\n  });\n\n  const { data: customers = [] } = useQuery<Customer[]>({\n    queryKey: [\"/api/customers\"],\n  });\n\n  const createPlanMutation = useMutation({\n    mutationFn: async (plan: Partial<MembershipPlan>) => {\n      return apiRequest(\"POST\", \"/api/membership-plans\", plan);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/membership-plans\"] });\n      setIsAddPlanOpen(false);\n      toast({ title: \"Success\", description: \"Membership plan created.\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to create plan.\", variant: \"destructive\" });\n    },\n  });\n\n  const createMembershipMutation = useMutation({\n    mutationFn: async (membership: any) => {\n      return apiRequest(\"POST\", \"/api/memberships\", membership);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/memberships\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/customers\"] });\n      setIsAddMembershipOpen(false);\n      toast({ title: \"Success\", description: \"Membership activated for customer.\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to create membership.\", variant: \"destructive\" });\n    },\n  });\n\n  const activeMemberships = memberships.filter(m => m.status === \"active\");\n  const expiredMemberships = memberships.filter(m => m.status === \"expired\" || m.status === \"cancelled\");\n\n  const totalRevenue = memberships.reduce((sum, m) => sum + Number(m.paidAmount), 0);\n\n  if (plansLoading || membershipsLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6 p-6\">\n      <div className=\"flex items-center justify-between gap-4 flex-wrap\">\n        <div>\n          <h1 className=\"text-2xl font-bold flex items-center gap-2\">\n            <Crown className=\"w-6 h-6 text-yellow-500\" />\n            Memberships & Loyalty\n          </h1>\n          <p className=\"text-muted-foreground\">Manage membership plans and customer loyalty points</p>\n        </div>\n        <div className=\"flex gap-2\">\n          {isOwner && (\n            <Dialog open={isAddPlanOpen} onOpenChange={setIsAddPlanOpen}>\n              <DialogTrigger asChild>\n                <Button variant=\"outline\" data-testid=\"button-add-plan\">\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Add Plan\n                </Button>\n              </DialogTrigger>\n              <DialogContent>\n                <AddPlanForm \n                  onSubmit={(plan) => createPlanMutation.mutate(plan)} \n                  isLoading={createPlanMutation.isPending}\n                />\n              </DialogContent>\n            </Dialog>\n          )}\n          <Dialog open={isAddMembershipOpen} onOpenChange={setIsAddMembershipOpen}>\n            <DialogTrigger asChild>\n              <Button data-testid=\"button-add-membership\">\n                <Plus className=\"w-4 h-4 mr-2\" />\n                Assign Membership\n              </Button>\n            </DialogTrigger>\n            <DialogContent>\n              <AssignMembershipForm \n                plans={plans}\n                customers={customers}\n                onSubmit={(m) => createMembershipMutation.mutate(m)}\n                isLoading={createMembershipMutation.isPending}\n              />\n            </DialogContent>\n          </Dialog>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-3 bg-yellow-500/10 rounded-lg\">\n                <Crown className=\"w-6 h-6 text-yellow-500\" />\n              </div>\n              <div>\n                <p className=\"text-2xl font-bold\" data-testid=\"text-active-count\">{activeMemberships.length}</p>\n                <p className=\"text-sm text-muted-foreground\">Active Members</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-3 bg-blue-500/10 rounded-lg\">\n                <CreditCard className=\"w-6 h-6 text-blue-500\" />\n              </div>\n              <div>\n                <p className=\"text-2xl font-bold\" data-testid=\"text-revenue\">\n                  Rs. {totalRevenue.toLocaleString()}\n                </p>\n                <p className=\"text-sm text-muted-foreground\">Total Revenue</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-3 bg-purple-500/10 rounded-lg\">\n                <Gift className=\"w-6 h-6 text-purple-500\" />\n              </div>\n              <div>\n                <p className=\"text-2xl font-bold\" data-testid=\"text-plans-count\">{plans.length}</p>\n                <p className=\"text-sm text-muted-foreground\">Available Plans</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-3 bg-green-500/10 rounded-lg\">\n                <TrendingUp className=\"w-6 h-6 text-green-500\" />\n              </div>\n              <div>\n                <p className=\"text-2xl font-bold\" data-testid=\"text-retention\">\n                  {activeMemberships.length > 0 \n                    ? Math.round((activeMemberships.length / memberships.length) * 100)\n                    : 0}%\n                </p>\n                <p className=\"text-sm text-muted-foreground\">Retention Rate</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Tabs value={activeTab} onValueChange={setActiveTab}>\n        <TabsList>\n          <TabsTrigger value=\"memberships\" data-testid=\"tab-memberships\">\n            <Users className=\"w-4 h-4 mr-2\" />\n            Memberships\n          </TabsTrigger>\n          <TabsTrigger value=\"plans\" data-testid=\"tab-plans\">\n            <Crown className=\"w-4 h-4 mr-2\" />\n            Plans\n          </TabsTrigger>\n          <TabsTrigger value=\"loyalty\" data-testid=\"tab-loyalty\">\n            <Coins className=\"w-4 h-4 mr-2\" />\n            Loyalty Program\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"memberships\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Active Memberships</CardTitle>\n              <CardDescription>Current members with active subscriptions</CardDescription>\n            </CardHeader>\n            <CardContent>\n              {activeMemberships.length === 0 ? (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  <Crown className=\"w-12 h-12 mx-auto mb-2 opacity-50\" />\n                  <p>No active memberships yet</p>\n                </div>\n              ) : (\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>Customer</TableHead>\n                      <TableHead>Plan</TableHead>\n                      <TableHead>Start Date</TableHead>\n                      <TableHead>End Date</TableHead>\n                      <TableHead>Status</TableHead>\n                      <TableHead>Free Hours</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {activeMemberships.map((m) => {\n                      const customer = customers.find(c => c.id === m.customerId);\n                      return (\n                        <TableRow key={m.id} data-testid={`row-membership-${m.id}`}>\n                          <TableCell className=\"font-medium\">{customer?.name || \"Unknown\"}</TableCell>\n                          <TableCell>\n                            <Badge variant=\"secondary\">{m.plan?.name}</Badge>\n                          </TableCell>\n                          <TableCell>{m.startDate}</TableCell>\n                          <TableCell>{m.endDate}</TableCell>\n                          <TableCell>\n                            <Badge variant=\"default\" className=\"bg-green-500\">Active</Badge>\n                          </TableCell>\n                          <TableCell>\n                            {m.usedFreeHours || 0} / {m.plan?.freeHours || 0} hrs\n                          </TableCell>\n                        </TableRow>\n                      );\n                    })}\n                  </TableBody>\n                </Table>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"plans\" className=\"space-y-4\">\n          {plans.length === 0 ? (\n            <Card>\n              <CardContent className=\"py-12 text-center\">\n                <Gift className=\"w-12 h-12 mx-auto mb-2 text-muted-foreground opacity-50\" />\n                <p className=\"text-muted-foreground\">No membership plans created yet</p>\n                {isOwner && (\n                  <Button className=\"mt-4\" onClick={() => setIsAddPlanOpen(true)}>\n                    Create First Plan\n                  </Button>\n                )}\n              </CardContent>\n            </Card>\n          ) : (\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n              {plans.map((plan) => (\n                <PlanCard key={plan.id} plan={plan} />\n              ))}\n            </div>\n          )}\n        </TabsContent>\n\n        <TabsContent value=\"loyalty\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Sparkles className=\"w-5 h-5 text-yellow-500\" />\n                Loyalty Program\n              </CardTitle>\n              <CardDescription>\n                Customers earn points for every booking and can redeem them for discounts\n              </CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <Card className=\"bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-950/20 dark:to-orange-950/20 border-yellow-200 dark:border-yellow-800\">\n                  <CardContent className=\"pt-6\">\n                    <Award className=\"w-10 h-10 text-yellow-500 mb-4\" />\n                    <h3 className=\"font-semibold text-lg\">Earn Points</h3>\n                    <ul className=\"mt-2 space-y-2 text-sm text-muted-foreground\">\n                      <li className=\"flex items-center gap-2\">\n                        <Star className=\"w-4 h-4 text-yellow-500\" />\n                        10 points per Rs. 100 spent on bookings\n                      </li>\n                      <li className=\"flex items-center gap-2\">\n                        <Star className=\"w-4 h-4 text-yellow-500\" />\n                        10 points per Rs. 100 on membership purchase\n                      </li>\n                      <li className=\"flex items-center gap-2\">\n                        <Star className=\"w-4 h-4 text-yellow-500\" />\n                        Bonus points on tournament participation\n                      </li>\n                    </ul>\n                  </CardContent>\n                </Card>\n\n                <Card className=\"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950/20 dark:to-emerald-950/20 border-green-200 dark:border-green-800\">\n                  <CardContent className=\"pt-6\">\n                    <Gift className=\"w-10 h-10 text-green-500 mb-4\" />\n                    <h3 className=\"font-semibold text-lg\">Redeem Rewards</h3>\n                    <ul className=\"mt-2 space-y-2 text-sm text-muted-foreground\">\n                      <li className=\"flex items-center gap-2\">\n                        <Star className=\"w-4 h-4 text-green-500\" />\n                        100 points = Rs. 50 discount\n                      </li>\n                      <li className=\"flex items-center gap-2\">\n                        <Star className=\"w-4 h-4 text-green-500\" />\n                        500 points = 1 free hour\n                      </li>\n                      <li className=\"flex items-center gap-2\">\n                        <Star className=\"w-4 h-4 text-green-500\" />\n                        1000 points = Free session\n                      </li>\n                    </ul>\n                  </CardContent>\n                </Card>\n              </div>\n\n              <div className=\"p-4 bg-muted rounded-lg\">\n                <p className=\"text-sm text-muted-foreground\">\n                  View customer loyalty points from the Customer details page. \n                  Points are automatically earned on completed bookings and can be redeemed at checkout.\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}\n\nfunction PlanCard({ plan }: { plan: MembershipPlan }) {\n  return (\n    <Card className=\"relative overflow-visible\" data-testid={`card-plan-${plan.id}`}>\n      {plan.priority && (\n        <div className=\"absolute -top-2 -right-2\">\n          <Badge className=\"bg-yellow-500\">Popular</Badge>\n        </div>\n      )}\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <Crown className=\"w-5 h-5 text-yellow-500\" />\n          {plan.name}\n        </CardTitle>\n        <CardDescription>{plan.description || \"Membership plan\"}</CardDescription>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <div className=\"text-3xl font-bold\">\n          Rs. {Number(plan.price).toLocaleString()}\n          <span className=\"text-sm font-normal text-muted-foreground\">\n            /{plan.durationDays} days\n          </span>\n        </div>\n        \n        <div className=\"space-y-2\">\n          {plan.discountPercent > 0 && (\n            <div className=\"flex items-center gap-2 text-sm\">\n              <Percent className=\"w-4 h-4 text-green-500\" />\n              <span>{plan.discountPercent}% discount on bookings</span>\n            </div>\n          )}\n          {plan.freeHours > 0 && (\n            <div className=\"flex items-center gap-2 text-sm\">\n              <Clock className=\"w-4 h-4 text-blue-500\" />\n              <span>{plan.freeHours} free hours/month</span>\n            </div>\n          )}\n          {plan.priority && (\n            <div className=\"flex items-center gap-2 text-sm\">\n              <Star className=\"w-4 h-4 text-yellow-500\" />\n              <span>Priority booking access</span>\n            </div>\n          )}\n          <div className=\"flex items-center gap-2 text-sm\">\n            <Calendar className=\"w-4 h-4 text-muted-foreground\" />\n            <span>{plan.durationDays} days validity</span>\n          </div>\n        </div>\n\n        <Badge variant={plan.isActive ? \"default\" : \"secondary\"}>\n          {plan.isActive ? \"Active\" : \"Inactive\"}\n        </Badge>\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction AddPlanForm({ \n  onSubmit, \n  isLoading \n}: { \n  onSubmit: (plan: any) => void;\n  isLoading: boolean;\n}) {\n  const [formData, setFormData] = useState({\n    name: \"\",\n    description: \"\",\n    durationDays: 30,\n    price: \"\",\n    discountPercent: 0,\n    freeHours: 0,\n    priority: false,\n    isActive: true,\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    onSubmit(formData);\n  };\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <DialogHeader>\n        <DialogTitle>Create Membership Plan</DialogTitle>\n        <DialogDescription>Define a new membership tier for your customers</DialogDescription>\n      </DialogHeader>\n      <div className=\"space-y-4 py-4\">\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"name\">Plan Name</Label>\n          <Input\n            id=\"name\"\n            value={formData.name}\n            onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n            placeholder=\"e.g., Silver, Gold, Platinum\"\n            required\n            data-testid=\"input-plan-name\"\n          />\n        </div>\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"description\">Description</Label>\n          <Textarea\n            id=\"description\"\n            value={formData.description}\n            onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n            placeholder=\"Brief description of benefits\"\n            data-testid=\"input-plan-description\"\n          />\n        </div>\n        <div className=\"grid grid-cols-2 gap-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"price\">Price (Rs.)</Label>\n            <Input\n              id=\"price\"\n              type=\"number\"\n              value={formData.price}\n              onChange={(e) => setFormData({ ...formData, price: e.target.value })}\n              placeholder=\"1000\"\n              required\n              data-testid=\"input-plan-price\"\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"duration\">Duration (days)</Label>\n            <Select\n              value={String(formData.durationDays)}\n              onValueChange={(v) => setFormData({ ...formData, durationDays: Number(v) })}\n            >\n              <SelectTrigger data-testid=\"select-plan-duration\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"30\">30 days (1 month)</SelectItem>\n                <SelectItem value=\"90\">90 days (3 months)</SelectItem>\n                <SelectItem value=\"180\">180 days (6 months)</SelectItem>\n                <SelectItem value=\"365\">365 days (1 year)</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n        </div>\n        <div className=\"grid grid-cols-2 gap-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"discount\">Discount %</Label>\n            <Input\n              id=\"discount\"\n              type=\"number\"\n              value={formData.discountPercent}\n              onChange={(e) => setFormData({ ...formData, discountPercent: Number(e.target.value) })}\n              placeholder=\"10\"\n              min={0}\n              max={100}\n              data-testid=\"input-plan-discount\"\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"freeHours\">Free Hours/Month</Label>\n            <Input\n              id=\"freeHours\"\n              type=\"number\"\n              value={formData.freeHours}\n              onChange={(e) => setFormData({ ...formData, freeHours: Number(e.target.value) })}\n              placeholder=\"2\"\n              min={0}\n              data-testid=\"input-plan-free-hours\"\n            />\n          </div>\n        </div>\n        <div className=\"flex items-center justify-between\">\n          <Label htmlFor=\"priority\">Priority Booking Access</Label>\n          <Switch\n            id=\"priority\"\n            checked={formData.priority}\n            onCheckedChange={(checked) => setFormData({ ...formData, priority: checked })}\n            data-testid=\"switch-plan-priority\"\n          />\n        </div>\n      </div>\n      <DialogFooter>\n        <Button type=\"submit\" disabled={isLoading} data-testid=\"button-submit-plan\">\n          {isLoading && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n          Create Plan\n        </Button>\n      </DialogFooter>\n    </form>\n  );\n}\n\nfunction AssignMembershipForm({\n  plans,\n  customers,\n  onSubmit,\n  isLoading,\n}: {\n  plans: MembershipPlan[];\n  customers: Customer[];\n  onSubmit: (data: any) => void;\n  isLoading: boolean;\n}) {\n  const [formData, setFormData] = useState({\n    customerId: \"\",\n    planId: \"\",\n    paidAmount: \"\",\n    paymentMethod: \"cash\",\n  });\n\n  const selectedPlan = plans.find(p => p.id === formData.planId);\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    const today = new Date();\n    const endDate = new Date(today);\n    endDate.setDate(endDate.getDate() + (selectedPlan?.durationDays || 30));\n    \n    onSubmit({\n      ...formData,\n      startDate: today.toISOString().split(\"T\")[0],\n      endDate: endDate.toISOString().split(\"T\")[0],\n      status: \"active\",\n    });\n  };\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <DialogHeader>\n        <DialogTitle>Assign Membership</DialogTitle>\n        <DialogDescription>Activate a membership for a customer</DialogDescription>\n      </DialogHeader>\n      <div className=\"space-y-4 py-4\">\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"customer\">Customer</Label>\n          <Select\n            value={formData.customerId}\n            onValueChange={(v) => setFormData({ ...formData, customerId: v })}\n          >\n            <SelectTrigger data-testid=\"select-customer\">\n              <SelectValue placeholder=\"Select customer\" />\n            </SelectTrigger>\n            <SelectContent>\n              {customers.map((c) => (\n                <SelectItem key={c.id} value={c.id}>\n                  {c.name} - {c.phone}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"plan\">Membership Plan</Label>\n          <Select\n            value={formData.planId}\n            onValueChange={(v) => {\n              const plan = plans.find(p => p.id === v);\n              setFormData({ \n                ...formData, \n                planId: v,\n                paidAmount: plan ? String(plan.price) : \"\",\n              });\n            }}\n          >\n            <SelectTrigger data-testid=\"select-plan\">\n              <SelectValue placeholder=\"Select plan\" />\n            </SelectTrigger>\n            <SelectContent>\n              {plans.filter(p => p.isActive).map((p) => (\n                <SelectItem key={p.id} value={p.id}>\n                  {p.name} - Rs. {Number(p.price).toLocaleString()} ({p.durationDays} days)\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n        <div className=\"grid grid-cols-2 gap-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"amount\">Amount Paid (Rs.)</Label>\n            <Input\n              id=\"amount\"\n              type=\"number\"\n              value={formData.paidAmount}\n              onChange={(e) => setFormData({ ...formData, paidAmount: e.target.value })}\n              required\n              data-testid=\"input-paid-amount\"\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"method\">Payment Method</Label>\n            <Select\n              value={formData.paymentMethod}\n              onValueChange={(v) => setFormData({ ...formData, paymentMethod: v })}\n            >\n              <SelectTrigger data-testid=\"select-payment-method\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"cash\">Cash</SelectItem>\n                <SelectItem value=\"upi\">UPI</SelectItem>\n                <SelectItem value=\"card\">Card</SelectItem>\n                <SelectItem value=\"online\">Online</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n        </div>\n        {selectedPlan && (\n          <div className=\"p-3 bg-muted rounded-lg text-sm space-y-1\">\n            <p className=\"font-medium\">{selectedPlan.name} Benefits:</p>\n            {selectedPlan.discountPercent > 0 && (\n              <p>{selectedPlan.discountPercent}% booking discount</p>\n            )}\n            {selectedPlan.freeHours > 0 && (\n              <p>{selectedPlan.freeHours} free hours/month</p>\n            )}\n            {selectedPlan.priority && (\n              <p>Priority booking access</p>\n            )}\n          </div>\n        )}\n      </div>\n      <DialogFooter>\n        <Button \n          type=\"submit\" \n          disabled={isLoading || !formData.customerId || !formData.planId}\n          data-testid=\"button-submit-membership\"\n        >\n          {isLoading && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n          Activate Membership\n        </Button>\n      </DialogFooter>\n    </form>\n  );\n}\n","path":null,"size_bytes":26300,"size_tokens":null}},"version":2}